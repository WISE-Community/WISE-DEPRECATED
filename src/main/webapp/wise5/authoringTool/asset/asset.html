<style>
  md-dialog {
    display: initial;
    width: 80%;
  }
  .drop-box {
    background: #F8F8F8;
    border: 5px dashed #DDD;
    width: 90%;
    height: 100px;
    text-align: center;
    padding-top: 50px;
    margin: 10px;
    bottom: 0px;
  }
  .drop-box:hover {
    cursor: pointer;
  }
  ul {
    list-style-type: none;
    padding: 0px;
    margin: 0px;
  }
  li {
    padding-left: 20px;
  }
  li:hover {
    cursor: pointer;
  }
  #uploadSuccessMessage {
    background-color: lightgreen;
  }
  #errorMessage {
    background-color: lightpink;
  }
</style>

<div ngf-drop ngf-select
    ngf-change="projectAssetController.uploadAssetItems($files)" class="drop-box"
    ngf-resize="{quality: .8, width: 1000, height: 1000, pattern:'image/*', restoreExif: true}"
    ngf-resize-if="$width > 1000 || $height > 1000"
    drag-over-class="dragover" ngf-multiple="true" allow-dir="false"
    accept="image/*,application/pdf,text/csv,text/javascript" translate="dropAssetMessage"></div>
<span translate="assetUsageMessage"
    translate-value-usage="{{projectAssetController.totalFileSize | appropriateSizeText }}"
    translate-value-max="{{projectAssetController.projectAssetTotalSizeMax | appropriateSizeText }}"
    translate-value-percentage="{{projectAssetController.projectAssetUsagePercentage | roundToDecimal:0 }}"></span>
<span ng-if="projectAssetController.totalUnusedFilesSize != null && projectAssetController.totalUnusedFilesSize != 0"
    style="color:red">({{ ::'unusedFiles' | translate }} {{projectAssetController.totalUnusedFilesSize | appropriateSizeText}} ({{projectAssetController.unusedFilesPercentage | roundToDecimal:0}}%))
  </span>
<div id="uploadSuccessMessage">
  {{projectAssetController.uploadSuccessMessage}}
  <div ng-repeat='successFile in projectAssetController.successFiles'>
    <b>{{::successFile.filename}}</b>
  </div>
</div>
<div id="errorMessage">
  {{projectAssetController.uploadErrorMessage}}
  <div ng-repeat='errorFile in projectAssetController.errorFiles'>
    <b>{{::errorFile.filename}}</b> {{::errorFile.message}}
  </div>
</div>
<span translate="sortAssets"></span>: <select ng-model="projectAssetController.assetSortBy"
    ng-change="projectAssetController.assetSortByChanged()">
  <option value="aToZ" translate="fileNameAToZ"></option>
  <option value="zToA" translate="fileNameZToA"></option>
  <option value="smallToLarge" translate="fileSizeSmallToLarge"></option>
  <option value="largeToSmall" translate="fileSizeLargeToSmall"></option>
</select>
<div style='display:flex'>
  <div style='flex:1; height:500px; overflow-y:scroll;'>
    <ul>
      <li ng-repeat='assetItem in projectAssetController.projectAssets.files'
        class='assetItem'
        ng-click='projectAssetController.assetClicked($event, assetItem)'
        ng-mouseover='projectAssetController.previewAsset($event, assetItem)'
        ng-style="projectAssetController.selectedAssetItem === assetItem ? { 'backgroundColor': 'yellow'} : { 'backgroundColor': '' }"
        ng-if='(projectAssetController.allowedFileTypes.includes("any") || projectAssetController.allowedFileTypes.includes(assetItem.fileType))'>
        <span>{{::assetItem.fileName}} ({{::assetItem.fileSize | appropriateSizeText}})</span>
        <button ng-click='projectAssetController.chooseAsset(assetItem)'
            ng-show='projectAssetController.isPopup'>Choose</button>
        <span>
          <md-tooltip md-direction="top"><span translate="download"></span></md-tooltip>
          <md-icon ng-click="projectAssetController.downloadAsset(assetItem)">file_download</md-icon>
        </span>
        <md-icon ng-click='projectAssetController.deleteAsset(assetItem)'>delete</md-icon>
        <span ng-if="!assetItem.used">
          <span style="color:red">({{ ::'notUsed' | translate }})</span>
        </span>
      </li>
    </ul>
  </div>
  <div style='flex:1;'>
    <div>
      <img ng-src='{{projectAssetController.previewAssetURL}}'
         ng-show='projectAssetController.assetIsImage'
         style='max-width: 400px'/>
      <video ng-show='projectAssetController.assetIsVideo'
           style='max-width: 400px'
           controls>
        <source ng-src='{{projectAssetController.previewAssetURL}}' type='video/mp4'>
      </video>
    </div>
  </div>
</div>
