{"version":3,"sources":["htmlController.es6"],"names":["HTMLController","$rootScope","$scope","$state","$stateParams","$sce","$filter","$mdDialog","AnnotationService","ConfigService","NodeService","NotebookService","ProjectService","StudentAssetService","StudentDataService","UtilService","mode","componentContent","html","$parent","registerComponentController","$on","event","args","nodeId","componentId","imageObjects","getImageObjects","$emit","$broadcast","imageElements","angular","element","i","length","imageElement","imageObject","getImageObjectFromImageElement","push","$inject"],"mappings":"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","file":"htmlController.js","sourcesContent":["'use strict';\n\nimport ComponentController from '../componentController';\n\nclass HTMLController extends ComponentController {\n  constructor($rootScope,\n      $scope,\n      $state,\n      $stateParams,\n      $sce,\n      $filter,\n      $mdDialog,\n      AnnotationService,\n      ConfigService,\n      NodeService,\n      NotebookService,\n      ProjectService,\n      StudentAssetService,\n      StudentDataService,\n      UtilService) {\n    super($filter, $mdDialog, $rootScope, $scope,\n        AnnotationService, ConfigService, NodeService,\n        NotebookService, ProjectService, StudentAssetService,\n        StudentDataService, UtilService);\n    this.$state = $state;\n    this.$stateParams = $stateParams;\n    this.$sce = $sce;\n\n    if (this.mode === 'authoring') {\n\n    } else if (this.mode === 'grading') {\n\n    } else if (this.mode === 'student') {\n      if (this.componentContent != null) {\n        this.html = this.componentContent.html;\n      }\n\n      if ($scope.$parent.registerComponentController != null) {\n        // register this component with the parent node\n        $scope.$parent.registerComponentController($scope, this.componentContent);\n      }\n    }\n\n    /*\n     * Listen for the requestImage event which is fired when something needs\n     * an image representation of the student data from a specific\n     * component.\n     */\n    this.$scope.$on('requestImage', (event, args) => {\n      // get the node id and component id from the args\n      let nodeId = args.nodeId;\n      let componentId = args.componentId;\n\n      // check if the image is being requested from this component\n      if (this.nodeId === nodeId && this.componentId === componentId) {\n\n        // obtain the image objects\n        let imageObjects = this.getImageObjects();\n\n        if (imageObjects != null) {\n          let args = {};\n          args.nodeId = nodeId;\n          args.componentId = componentId;\n          args.imageObjects = imageObjects;\n\n          // fire an event that contains the image objects\n          this.$scope.$emit('requestImageCallback', args);\n        }\n      }\n    });\n\n    this.$rootScope.$broadcast('doneRenderingComponent', { nodeId: this.nodeId, componentId: this.componentId });\n  }\n\n  /**\n   * Get the image object representation of the student data\n   * @returns an image object\n   */\n  getImageObjects() {\n    let imageObjects = [];\n\n    // get the image elements in the scope\n    let componentId = this.componentId;\n    let imageElements = angular.element('#' + componentId + ' img');\n\n    if (imageElements != null) {\n\n      // loop through all the image elements\n      for (let i = 0; i < imageElements.length; i++) {\n        let imageElement = imageElements[i];\n\n        if (imageElement != null) {\n\n          // create an image object\n          let imageObject = this.UtilService.getImageObjectFromImageElement(imageElement);\n          imageObjects.push(imageObject);\n        }\n      }\n    }\n\n    return imageObjects;\n  }\n}\n\nHTMLController.$inject = [\n  '$rootScope',\n  '$scope',\n  '$state',\n  '$stateParams',\n  '$sce',\n  '$filter',\n  '$mdDialog',\n  'AnnotationService',\n  'ConfigService',\n  'NodeService',\n  'NotebookService',\n  'ProjectService',\n  'StudentAssetService',\n  'StudentDataService',\n  'UtilService'\n];\n\nexport default HTMLController;\n"]}