(function(){var e="undefined"===typeof window?global:window;if("function"!==typeof e.require2){var b={},d={},a={}.hasOwnProperty,c={},g=function(){var f=/^\.\.?(\/|$)/;return function(c,a){var g=[],k,b;k=(f.test(a)?c+"/"+a:a).split("/");for(var d=0,l=k.length;d<l;d++)b=k[d],".."===b?g.pop():"."!==b&&""!==b&&g.push(b);return g.join("/")}}(),f=function(f){return function(c){c=g(f.split("/").slice(0,-1).join("/"),c);return e.require2(c,f)}},k=function(c,a){var g={id:c,exports:{}};d[c]=g;a(g.exports,
f(c),g);return g.exports},l=function(f,l){var e=g(f,".");null==l&&(l="/");var e=l,x=0;e&&(e.indexOf("components/"===0)&&(x=11),0<e.indexOf("/",x)&&(e=e.substring(x,e.indexOf("/",x))));e=(e=c[f+"/index.js"]||c[e+"/deps/"+f+"/index.js"])?"components/"+e.substring(0,e.length-3):f;if(a.call(d,e))return d[e].exports;if(a.call(b,e))return k(e,b[e]);e=g(e,"./index");if(a.call(d,e))return d[e].exports;if(a.call(b,e))return k(e,b[e]);throw Error('Cannot find module "'+f+'" from "'+l+'"');};l.alias=function(f,
a){c[a]=f};l.register=l.define=function(f,c){if("object"===typeof f)for(var g in f)a.call(f,g)&&(b[g]=f[g]);else b[f]=c};l.list=function(){var f=[],c;for(c in b)a.call(b,c)&&f.push(c);return f};l.brunch=!0;e.require2=l}})();
!function(e){function b(){this._events={};this._conf&&d.call(this,this._conf)}function d(f){f&&(this._conf=f,f.delimiter&&(this.delimiter=f.delimiter),f.maxListeners&&(this._events.maxListeners=f.maxListeners),f.wildcard&&(this.wildcard=f.wildcard),f.newListener&&(this.newListener=f.newListener),this.wildcard&&(this.listenerTree={}))}function a(f){this._events={};this.newListener=!1;d.call(this,f)}function c(f,a,g,b){if(!g)return[];var d=[],e,x,y,E;y=a.length;E=a[b];var u=a[b+1];if(b===y&&g._listeners){if("function"===
typeof g._listeners)f&&f.push(g._listeners);else for(a=0,b=g._listeners.length;a<b;a++)f&&f.push(g._listeners[a]);return[g]}if("*"===E||"**"===E||g[E]){if("*"===E){for(e in g)"_listeners"!==e&&g.hasOwnProperty(e)&&(d=d.concat(c(f,a,g[e],b+1)));return d}if("**"===E){(E=b+1===y||b+2===y&&"*"===u)&&g._listeners&&(d=d.concat(c(f,a,g,y)));for(e in g)"_listeners"!==e&&g.hasOwnProperty(e)&&("*"===e||"**"===e?(g[e]._listeners&&!E&&(d=d.concat(c(f,a,g[e],y))),d=d.concat(c(f,a,g[e],b))):d=e===u?d.concat(c(f,
a,g[e],b+2)):d.concat(c(f,a,g[e],b)));return d}d=d.concat(c(f,a,g[E],b+1))}(x=g["*"])&&c(f,a,x,b+1);if(g=g["**"])if(b<y)for(e in g._listeners&&c(f,a,g,y),g)"_listeners"!==e&&g.hasOwnProperty(e)&&(e===u?c(f,a,g[e],b+2):e===E?c(f,a,g[e],b+1):(y={},y[e]=g[e],c(f,a,{"**":y},b+1)));else g._listeners?c(f,a,g,y):g["*"]&&g["*"]._listeners&&c(f,a,g["*"],y);return d}var g=Array.isArray?Array.isArray:function(f){return"[object Array]"===Object.prototype.toString.call(f)};a.prototype.delimiter=".";a.prototype.setMaxListeners=
function(f){this._events||b.call(this);this._events.maxListeners=f;this._conf||(this._conf={});this._conf.maxListeners=f};a.prototype.event="";a.prototype.once=function(f,c){this.many(f,1,c);return this};a.prototype.many=function(f,c,g){function a(){0===--c&&b.off(f,a);g.apply(this,arguments)}var b=this;if("function"!==typeof g)throw Error("many only accepts instances of Function");a._origin=g;this.on(f,a);return b};a.prototype.emit=function(){this._events||b.call(this);var f=arguments[0];if("newListener"===
f&&!this.newListener&&!this._events.newListener)return!1;if(this._all){for(var g=arguments.length,a=Array(g-1),d=1;d<g;d++)a[d-1]=arguments[d];d=0;for(g=this._all.length;d<g;d++)this.event=f,this._all[d].apply(this,a)}if("error"===f&&!(this._all||this._events.error||this.wildcard&&this.listenerTree.error)){if(arguments[1]instanceof Error)throw arguments[1];throw Error("Uncaught, unspecified 'error' event.");}var e;this.wildcard?(e=[],g="string"===typeof f?f.split(this.delimiter):f.slice(),c.call(this,
e,g,this.listenerTree,0)):e=this._events[f];if("function"===typeof e){this.event=f;if(1===arguments.length)e.call(this);else if(1<arguments.length)switch(arguments.length){case 2:e.call(this,arguments[1]);break;case 3:e.call(this,arguments[1],arguments[2]);break;default:g=arguments.length;a=Array(g-1);for(d=1;d<g;d++)a[d-1]=arguments[d];e.apply(this,a)}return!0}if(e){g=arguments.length;a=Array(g-1);for(d=1;d<g;d++)a[d-1]=arguments[d];e=e.slice();d=0;for(g=e.length;d<g;d++)this.event=f,e[d].apply(this,
a);return 0<e.length||!!this._all}return!!this._all};a.prototype.on=function(f,c){if("function"===typeof f)return this.onAny(f),this;if("function"!==typeof c)throw Error("on only accepts instances of Function");this._events||b.call(this);this.emit("newListener",f,c);if(this.wildcard){a:{for(var a=f,a="string"===typeof a?a.split(this.delimiter):a.slice(),d=0,e=a.length;d+1<e;d++)if("**"===a[d]&&"**"===a[d+1])break a;d=this.listenerTree;for(e=a.shift();e;){d[e]||(d[e]={});d=d[e];if(0===a.length){d._listeners?
"function"===typeof d._listeners?d._listeners=[d._listeners,c]:g(d._listeners)&&(d._listeners.push(c),d._listeners.warned||(a=10,"undefined"!==typeof this._events.maxListeners&&(a=this._events.maxListeners),0<a&&d._listeners.length>a&&(d._listeners.warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",d._listeners.length),console.trace()))):d._listeners=c;break a}e=a.shift()}}return this}this._events[f]?
"function"===typeof this._events[f]?this._events[f]=[this._events[f],c]:g(this._events[f])&&(this._events[f].push(c),this._events[f].warned||(a=10,"undefined"!==typeof this._events.maxListeners&&(a=this._events.maxListeners),0<a&&this._events[f].length>a&&(this._events[f].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[f].length),console.trace()))):this._events[f]=c;return this};
a.prototype.onAny=function(f){if("function"!==typeof f)throw Error("onAny only accepts instances of Function");this._all||(this._all=[]);this._all.push(f);return this};a.prototype.addListener=a.prototype.on;a.prototype.off=function(f,a){if("function"!==typeof a)throw Error("removeListener only takes instances of Function");var b,d=[];if(this.wildcard)b="string"===typeof f?f.split(this.delimiter):f.slice(),d=c.call(this,null,b,this.listenerTree,0);else{if(!this._events[f])return this;b=this._events[f];
d.push({_listeners:b})}for(var e=0;e<d.length;e++){var n=d[e];b=n._listeners;if(g(b)){for(var x=-1,y=0,E=b.length;y<E;y++)if(b[y]===a||b[y].listener&&b[y].listener===a||b[y]._origin&&b[y]._origin===a){x=y;break}if(!(0>x)){this.wildcard?n._listeners.splice(x,1):this._events[f].splice(x,1);0===b.length&&(this.wildcard?delete n._listeners:delete this._events[f]);break}}else if(b===a||b.listener&&b.listener===a||b._origin&&b._origin===a)this.wildcard?delete n._listeners:delete this._events[f]}return this};
a.prototype.offAny=function(f){var c=0,a=0,g;if(f&&this._all&&0<this._all.length)for(g=this._all,c=0,a=g.length;c<a;c++){if(f===g[c]){g.splice(c,1);break}}else this._all=[];return this};a.prototype.removeListener=a.prototype.off;a.prototype.removeAllListeners=function(f){if(0===arguments.length)return!this._events||b.call(this),this;if(this.wildcard)for(var a="string"===typeof f?f.split(this.delimiter):f.slice(),a=c.call(this,null,a,this.listenerTree,0),g=0;g<a.length;g++)a[g]._listeners=null;else{if(!this._events[f])return this;
this._events[f]=null}return this};a.prototype.listeners=function(f){if(this.wildcard){var a=[];f="string"===typeof f?f.split(this.delimiter):f.slice();c.call(this,a,f,this.listenerTree,0);return a}this._events||b.call(this);this._events[f]||(this._events[f]=[]);g(this._events[f])||(this._events[f]=[this._events[f]]);return this._events[f]};a.prototype.listenersAny=function(){return this._all?this._all:[]};"object"===typeof exports?exports.EventEmitter2=a:window.EventEmitter2=a}();
var fabric=fabric||{version:"1.5.0"};"undefined"!==typeof exports&&(exports.fabric=fabric);"undefined"!==typeof document&&"undefined"!==typeof window?(fabric.document=document,fabric.window=window):(fabric.document=require2("jsdom").jsdom("<!DOCTYPE html><html><head></head><body></body></html>"),fabric.window=fabric.document.createWindow?fabric.document.createWindow():fabric.document.parentWindow);fabric.isTouchSupported="ontouchstart"in fabric.document.documentElement;
fabric.isLikelyNode="undefined"!==typeof Buffer&&"undefined"===typeof window;fabric.SHARED_ATTRIBUTES="display transform fill fill-opacity fill-rule opacity stroke stroke-dasharray stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width".split(" ");fabric.DPI=96;fabric.reNum="(?:[-+]?(?:\\d+|\\d*\\.\\d+)(?:e[-+]?\\d+)?)";
(function(){function e(c,a){this.__eventListeners[c]&&(a?fabric.util.removeFromArray(this.__eventListeners[c],a):this.__eventListeners[c].length=0)}function b(c,a){this.__eventListeners||(this.__eventListeners={});if(1===arguments.length)for(var f in c)this.on(f,c[f]);else this.__eventListeners[c]||(this.__eventListeners[c]=[]),this.__eventListeners[c].push(a);return this}function d(c,a){if(this.__eventListeners){if(0===arguments.length)this.__eventListeners={};else if(1===arguments.length&&"object"===
typeof arguments[0])for(var f in c)e.call(this,f,c[f]);else e.call(this,c,a);return this}}function a(c,a){if(this.__eventListeners){var f=this.__eventListeners[c];if(f){for(var b=0,d=f.length;b<d;b++)f[b].call(this,a||{});return this}}}fabric.Observable={observe:b,stopObserving:d,fire:a,on:b,off:d,trigger:a}})();
fabric.Collection={add:function(){this._objects.push.apply(this._objects,arguments);for(var e=0,b=arguments.length;e<b;e++)this._onObjectAdded(arguments[e]);this.renderOnAddRemove&&this.renderAll();return this},insertAt:function(e,b,d){var a=this.getObjects();d?a[b]=e:a.splice(b,0,e);this._onObjectAdded(e);this.renderOnAddRemove&&this.renderAll();return this},remove:function(){for(var e=this.getObjects(),b,d=0,a=arguments.length;d<a;d++)b=e.indexOf(arguments[d]),-1!==b&&(e.splice(b,1),this._onObjectRemoved(arguments[d]));
this.renderOnAddRemove&&this.renderAll();return this},forEachObject:function(e,b){for(var d=this.getObjects(),a=d.length;a--;)e.call(b,d[a],a,d);return this},getObjects:function(e){return"undefined"===typeof e?this._objects:this._objects.filter(function(b){return b.type===e})},item:function(e){return this.getObjects()[e]},isEmpty:function(){return 0===this.getObjects().length},size:function(){return this.getObjects().length},contains:function(e){return-1<this.getObjects().indexOf(e)},complexity:function(){return this.getObjects().reduce(function(e,
b){return e+=b.complexity?b.complexity():0},0)}};
(function(e){var b=Math.sqrt,d=Math.atan2,a=Math.PI/180;fabric.util={removeFromArray:function(c,a){var f=c.indexOf(a);-1!==f&&c.splice(f,1);return c},getRandomInt:function(c,a){return Math.floor(Math.random()*(a-c+1))+c},degreesToRadians:function(c){return c*a},radiansToDegrees:function(c){return c/a},rotatePoint:function(c,a,f){var b=Math.sin(f);f=Math.cos(f);c.subtractEquals(a);return(new fabric.Point(c.x*f-c.y*b,c.x*b+c.y*f)).addEquals(a)},transformPoint:function(c,a,f){return f?new fabric.Point(a[0]*
c.x+a[2]*c.y,a[1]*c.x+a[3]*c.y):new fabric.Point(a[0]*c.x+a[2]*c.y+a[4],a[1]*c.x+a[3]*c.y+a[5])},invertTransform:function(c){var a=c.slice(),a=1/(c[0]*c[3]-c[1]*c[2]),a=[a*c[3],-a*c[1],-a*c[2],a*c[0],0,0];c=fabric.util.transformPoint({x:c[4],y:c[5]},a);a[4]=-c.x;a[5]=-c.y;return a},toFixed:function(c,a){return parseFloat(Number(c).toFixed(a))},parseUnit:function(c,a){var f=/\D{0,2}$/.exec(c),b=parseFloat(c);a||(a=fabric.Text.DEFAULT_SVG_FONT_SIZE);switch(f[0]){case "mm":return b*fabric.DPI/25.4;case "cm":return b*
fabric.DPI/2.54;case "in":return b*fabric.DPI;case "pt":return b*fabric.DPI/72;case "pc":return b*fabric.DPI/72*12;case "em":return b*a;default:return b}},falseFunction:function(){return!1},getKlass:function(c,a){c=fabric.util.string.camelize(c.charAt(0).toUpperCase()+c.slice(1));return fabric.util.resolveNamespace(a)[c]},resolveNamespace:function(c){if(!c)return fabric;c=c.split(".");for(var a=c.length,f=e||fabric.window,b=0;b<a;++b)f=f[c[b]];return f},loadImage:function(c,a,f,b){if(c){var d=fabric.util.createImage();
d.onload=function(){a&&a.call(f,d);d=d.onload=d.onerror=null};d.onerror=function(){fabric.log("Error loading "+d.src);a&&a.call(f,null,!0);d=d.onload=d.onerror=null};0!==c.indexOf("data")&&"undefined"!==typeof b&&(d.crossOrigin=b);d.src=c}else a&&a.call(f,c)},enlivenObjects:function(c,a,f,b){function d(){++p===n&&a&&a(e)}c=c||[];var e=[],p=0,n=c.length;n?c.forEach(function(c,a){if(c&&c.type){var g=fabric.util.getKlass(c.type,f);g.async?g.fromObject(c,function(f,g){g||(e[a]=f,b&&b(c,e[a]));d()}):(e[a]=
g.fromObject(c),b&&b(c,e[a]),d())}else d()}):a&&a(e)},groupSVGElements:function(c,a,f){c=new fabric.PathGroup(c,a);"undefined"!==typeof f&&c.setSourcePath(f);return c},populateWithProperties:function(c,a,f){if(f&&"[object Array]"===Object.prototype.toString.call(f))for(var b=0,d=f.length;b<d;b++)f[b]in c&&(a[f[b]]=c[f[b]])},drawDashedLine:function(c,a,f,k,e,m){k-=a;var p=e-f;e=b(k*k+p*p);k=d(p,k);var p=m.length,n=0,x=!0;c.save();c.translate(a,f);c.moveTo(0,0);c.rotate(k);for(a=0;e>a;)a+=m[n++%p],
a>e&&(a=e),c[x?"lineTo":"moveTo"](a,0),x=!x;c.restore()},createCanvasElement:function(c){c||(c=fabric.document.createElement("canvas"));c.getContext||"undefined"===typeof G_vmlCanvasManager||G_vmlCanvasManager.initElement(c);return c},createImage:function(){return fabric.isLikelyNode?new (require2("canvas").Image):fabric.document.createElement("img")},createAccessors:function(c){c=c.prototype;for(var a=c.stateProperties.length;a--;){var f=c.stateProperties[a],b=f.charAt(0).toUpperCase()+f.slice(1),
d="set"+b,b="get"+b;c[b]||(c[b]=new Function('return this.get("'+f+'")'));c[d]||(c[d]=new Function("value",'return this.set("'+f+'", value)'))}},clipContext:function(c,a){a.save();a.beginPath();c.clipTo(a);a.clip()},multiplyTransformMatrices:function(c,a){return[c[0]*a[0]+c[2]*a[1],c[1]*a[0]+c[3]*a[1],c[0]*a[2]+c[2]*a[3],c[1]*a[2]+c[3]*a[3],c[0]*a[4]+c[2]*a[5]+c[4],c[1]*a[4]+c[3]*a[5]+c[5]]},getFunctionBody:function(c){return(String(c).match(/function[^{]*\{([\s\S]*)\}/)||{})[1]},isTransparent:function(c,
a,f,b){0<b&&(a=a>b?a-b:0,f=f>b?f-b:0);var d=!0;c=c.getImageData(a,f,2*b||1,2*b||1);a=3;for(f=c.data.length;a<f&&(d=0>=c.data[a],!1!==d);a+=4);return d}}})("undefined"!==typeof exports?exports:this);
(function(){function e(f,a,g,e,x,y,E){var u=k.call(arguments);if(c[u])return c[u];var z=Math.PI,q=E*z/180,t=Math.sin(q),q=Math.cos(q),r=0,v=0;g=Math.abs(g);e=Math.abs(e);var w=-q*f*.5-t*a*.5,D=-q*a*.5+t*f*.5,A=g*g,C=e*e,H=D*D,F=w*w,I=A*C-A*H-C*F,N=0;0>I?(A=Math.sqrt(1-I/(A*C)),g*=A,e*=A):N=(x===y?-1:1)*Math.sqrt(I/(A*H+C*F));H=N*g*D/e;F=-N*e*w/g;N=q*H-t*F+.5*f;A=t*H+q*F+.5*a;C=d(1,0,(w-H)/g,(D-F)/e);D=d((w-H)/g,(D-F)/e,(-w-H)/g,(-D-F)/e);0===y&&0<D?D-=2*z:1===y&&0>D&&(D+=2*z);z=Math.ceil(Math.abs(D/
z*2));w=[];D/=z;H=8/3*Math.sin(D/4)*Math.sin(D/4)/Math.sin(D/2);F=C+D;for(I=0;I<z;I++)w[I]=b(C,F,q,t,g,e,N,A,H,r,v),r=w[I][4],v=w[I][5],C=F,F+=D;return c[u]=w}function b(f,c,a,b,d,e,E,u,z,q,t){var r=k.call(arguments);if(g[r])return g[r];var v=Math.cos(f),w=Math.sin(f),D=Math.cos(c),A=Math.sin(c),C=a*d*D-b*e*A+E,H=b*d*D+a*e*A+u;g[r]=[q+z*(-a*d*w-b*e*v),t+z*(-b*d*w+a*e*v),C+z*(a*d*A+b*e*D),H+z*(b*d*A-a*e*D),C,H];return g[r]}function d(f,c,a,b){f=Math.atan2(c,f);a=Math.atan2(b,a);return a>=f?a-f:2*Math.PI-
(f-a)}function a(c,a,b,g,d,e,E,u){var z=k.call(arguments);if(f[z])return f[z];var q=Math.sqrt,t=Math.min,r=Math.max,v=Math.abs,w=[],D=[[],[]],A,C,H,F,I;C=6*c-12*b+6*d;A=-3*c+9*b-9*d+3*E;H=3*b-3*c;for(var N=0;2>N;++N)0<N&&(C=6*a-12*g+6*e,A=-3*a+9*g-9*e+3*u,H=3*g-3*a),1E-12>v(A)?1E-12>v(C)||(F=-H/C,0<F&&1>F&&w.push(F)):(F=C*C-4*H*A,0>F||(I=q(F),F=(-C+I)/(2*A),0<F&&1>F&&w.push(F),F=(-C-I)/(2*A),0<F&&1>F&&w.push(F)));for(v=q=w.length;q--;)F=w[q],C=1-F,A=C*C*C*c+3*C*C*F*b+3*C*F*F*d+F*F*F*E,D[0][q]=A,A=
C*C*C*a+3*C*C*F*g+3*C*F*F*e+F*F*F*u,D[1][q]=A;D[0][v]=c;D[1][v]=a;D[0][v+1]=E;D[1][v+1]=u;t=[{x:t.apply(null,D[0]),y:t.apply(null,D[1])},{x:r.apply(null,D[0]),y:r.apply(null,D[1])}];return f[z]=t}var c={},g={},f={},k=Array.prototype.join;fabric.util.drawArc=function(f,c,a,b){var g=[[],[],[],[]];b=e(b[5]-c,b[6]-a,b[0],b[1],b[3],b[4],b[2]);for(var d=0,k=b.length;d<k;d++)g[d][0]=b[d][0]+c,g[d][1]=b[d][1]+a,g[d][2]=b[d][2]+c,g[d][3]=b[d][3]+a,g[d][4]=b[d][4]+c,g[d][5]=b[d][5]+a,f.bezierCurveTo.apply(f,
g[d])};fabric.util.getBoundsOfArc=function(f,c,b,g,d,k,E,u,z){var q=0,t=0,r=[],v=[];b=e(u-f,z-c,b,g,k,E,d);g=[[],[]];d=0;for(k=b.length;d<k;d++)r=a(q,t,b[d][0],b[d][1],b[d][2],b[d][3],b[d][4],b[d][5]),g[0].x=r[0].x+f,g[0].y=r[0].y+c,g[1].x=r[1].x+f,g[1].y=r[1].y+c,v.push(g[0]),v.push(g[1]),q=b[d][4],t=b[d][5];return v};fabric.util.getBoundsOfCurve=a})();
(function(){function e(b,a,c){if(b&&0!==b.length){var g=b.length-1,f=a?b[g][a]:b[g];if(a)for(;g--;)c(b[g][a],f)&&(f=b[g][a]);else for(;g--;)c(b[g],f)&&(f=b[g]);return f}}var b=Array.prototype.slice;Array.prototype.indexOf||(Array.prototype.indexOf=function(b){if(void 0===this||null===this)throw new TypeError;var a=Object(this),c=a.length>>>0;if(0===c)return-1;var g=0;0<arguments.length&&(g=Number(arguments[1]),g!==g?g=0:0!==g&&g!==Number.POSITIVE_INFINITY&&g!==Number.NEGATIVE_INFINITY&&(g=(0<g||-1)*
Math.floor(Math.abs(g))));if(g>=c)return-1;for(g=0<=g?g:Math.max(c-Math.abs(g),0);g<c;g++)if(g in a&&a[g]===b)return g;return-1});Array.prototype.forEach||(Array.prototype.forEach=function(b,a){for(var c=0,g=this.length>>>0;c<g;c++)c in this&&b.call(a,this[c],c,this)});Array.prototype.map||(Array.prototype.map=function(b,a){for(var c=[],g=0,f=this.length>>>0;g<f;g++)g in this&&(c[g]=b.call(a,this[g],g,this));return c});Array.prototype.every||(Array.prototype.every=function(b,a){for(var c=0,g=this.length>>>
0;c<g;c++)if(c in this&&!b.call(a,this[c],c,this))return!1;return!0});Array.prototype.some||(Array.prototype.some=function(b,a){for(var c=0,g=this.length>>>0;c<g;c++)if(c in this&&b.call(a,this[c],c,this))return!0;return!1});Array.prototype.filter||(Array.prototype.filter=function(b,a){for(var c=[],g,f=0,k=this.length>>>0;f<k;f++)f in this&&(g=this[f],b.call(a,g,f,this)&&c.push(g));return c});Array.prototype.reduce||(Array.prototype.reduce=function(b){var a=this.length>>>0,c=0,g;if(1<arguments.length)g=
arguments[1];else{do{if(c in this){g=this[c++];break}if(++c>=a)throw new TypeError;}while(1)}for(;c<a;c++)c in this&&(g=b.call(null,g,this[c],c,this));return g});fabric.util.array={invoke:function(d,a){for(var c=b.call(arguments,2),g=[],f=0,k=d.length;f<k;f++)g[f]=c.length?d[f][a].apply(d[f],c):d[f][a].call(d[f]);return g},min:function(b,a){return e(b,a,function(c,a){return c<a})},max:function(b,a){return e(b,a,function(c,a){return c>=a})}}})();
(function(){function e(b,d){for(var a in d)b[a]=d[a];return b}fabric.util.object={extend:e,clone:function(b){return e({},b)}}})();
(function(){String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^[\s\xA0]+/,"").replace(/[\s\xA0]+$/,"")});fabric.util.string={camelize:function(e){return e.replace(/-+(.)?/g,function(b,d){return d?d.toUpperCase():""})},capitalize:function(e,b){return e.charAt(0).toUpperCase()+(b?e.slice(1):e.slice(1).toLowerCase())},escapeXml:function(e){return e.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&apos;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}}})();
(function(){var e=Array.prototype.slice,b=Function.prototype.apply,d=function(){};Function.prototype.bind||(Function.prototype.bind=function(a){var c=this,g=e.call(arguments,1),f;f=g.length?function(){return b.call(c,this instanceof d?this:a,g.concat(e.call(arguments)))}:function(){return b.call(c,this instanceof d?this:a,arguments)};d.prototype=this.prototype;f.prototype=new d;return f})})();
(function(){function e(){}function b(f){var c=this.constructor.superclass.prototype[f];return 1<arguments.length?c.apply(this,d.call(arguments,1)):c.call(this)}var d=Array.prototype.slice,a=function(){},c=function(){for(var f in{toString:1})if("toString"===f)return!1;return!0}(),g=function(f,a,b){for(var g in a)g in f.prototype&&"function"===typeof f.prototype[g]&&-1<(a[g]+"").indexOf("callSuper")?f.prototype[g]=function(f){return function(){var c=this.constructor.superclass;this.constructor.superclass=
b;var g=a[f].apply(this,arguments);this.constructor.superclass=c;if("initialize"!==f)return g}}(g):f.prototype[g]=a[g],c&&(a.toString!==Object.prototype.toString&&(f.prototype.toString=a.toString),a.valueOf!==Object.prototype.valueOf&&(f.prototype.valueOf=a.valueOf))};fabric.util.createClass=function(){function f(){this.initialize.apply(this,arguments)}var c=null,l=d.call(arguments,0);"function"===typeof l[0]&&(c=l.shift());f.superclass=c;f.subclasses=[];c&&(e.prototype=c.prototype,f.prototype=new e,
c.subclasses.push(f));for(var m=0,p=l.length;m<p;m++)g(f,l[m],c);f.prototype.initialize||(f.prototype.initialize=a);f.prototype.constructor=f;f.prototype.callSuper=b;return f}})();
(function(){function e(f){var c=Array.prototype.slice.call(arguments,1),a,b,g=c.length;for(b=0;b<g;b++)if(a=typeof f[c[b]],!/^(?:function|object|unknown)$/.test(a))return!1;return!0}function b(f,a){return function(b){a.call(c(f),b||fabric.window.event)}}function d(f,c){return function(a){if(p[f]&&p[f][c])for(var b=p[f][c],g=0,d=b.length;g<d;g++)b[g].call(this,a||fabric.window.event)}}function a(f,c,a){var b="touchend"===f.type?"changedTouches":"touches";return f[b]&&f[b][0]?f[b][0][c]-(f[b][0][c]-
f[b][0][a])||f[a]:f[a]}var c,g,f=function(){var f=0;return function(c){return c.__uniqueID||(c.__uniqueID="uniqueID__"+f++)}}();(function(){var f={};c=function(c){return f[c]};g=function(c,a){f[c]=a}})();var k=e(fabric.document.documentElement,"addEventListener","removeEventListener")&&e(fabric.window,"addEventListener","removeEventListener"),l=e(fabric.document.documentElement,"attachEvent","detachEvent")&&e(fabric.window,"attachEvent","detachEvent"),m={},p={};k?(k=function(f,c,a){f.addEventListener(c,
a,!1)},l=function(f,c,a){f.removeEventListener(c,a,!1)}):l?(k=function(c,a,d){var k=f(c);g(k,c);m[k]||(m[k]={});m[k][a]||(m[k][a]=[]);d={handler:d,wrappedHandler:b(k,d)};m[k][a].push(d);c.attachEvent("on"+a,d.wrappedHandler)},l=function(c,a,b){var g=f(c),d;if(m[g]&&m[g][a])for(var k=0,e=m[g][a].length;k<e;k++)(d=m[g][a][k])&&d.handler===b&&(c.detachEvent("on"+a,d.wrappedHandler),m[g][a][k]=null)}):(k=function(c,a,b){var g=f(c);p[g]||(p[g]={});if(!p[g][a]){p[g][a]=[];var k=c["on"+a];k&&p[g][a].push(k);
c["on"+a]=d(g,a)}p[g][a].push(b)},l=function(c,a,b){c=f(c);if(p[c]&&p[c][a]){a=p[c][a];c=0;for(var g=a.length;c<g;c++)a[c]===b&&a.splice(c,1)}});fabric.util.addListener=k;fabric.util.removeListener=l;var n=function(c){return"unknown"!==typeof c.clientX?c.clientX:0},x=function(c){return"unknown"!==typeof c.clientY?c.clientY:0};fabric.isTouchSupported&&(n=function(c){return a(c,"pageX","clientX")},x=function(c){return a(c,"pageY","clientY")});fabric.util.getPointer=function(c,f){c||(c=fabric.window.event);
var a=fabric.util.getScrollLeftTop(c.target||("unknown"!==typeof c.srcElement?c.srcElement:null),f);return{x:n(c)+a.left,y:x(c)+a.top}};fabric.util.object.extend(fabric.util,fabric.Observable)})();
(function(){var e=fabric.document.createElement("div"),b="string"===typeof e.style.filter,d=/alpha\s*\(\s*opacity\s*=\s*([^\)]+)\)/,a=function(c){return c};"string"===typeof e.style.opacity?a=function(c,a){c.style.opacity=a;return c}:b&&(a=function(c,a){var f=c.style;c.currentStyle&&!c.currentStyle.hasLayout&&(f.zoom=1);d.test(f.filter)?f.filter=f.filter.replace(d,.9999<=a?"":"alpha(opacity="+100*a+")"):f.filter+=" alpha(opacity="+100*a+")";return c});fabric.util.setStyle=function(c,b){var f=c.style;
if(!f)return c;if("string"===typeof b)return c.style.cssText+=";"+b,-1<b.indexOf("opacity")?a(c,b.match(/opacity:\s*(\d?\.?\d*)/)[1]):c;for(var d in b)"opacity"===d?a(c,b[d]):f["float"===d||"cssFloat"===d?"undefined"===typeof f.styleFloat?"cssFloat":"styleFloat":d]=b[d];return c}})();
(function(){function e(c,f){var a=fabric.document.createElement(c),b;for(b in f)"class"===b?a.className=f[b]:"for"===b?a.htmlFor=f[b]:a.setAttribute(b,f[b]);return a}var b=Array.prototype.slice,d,a=function(c){return b.call(c,0)};try{d=a(fabric.document.childNodes)instanceof Array}catch(g){}d||(a=function(c){for(var f=Array(c.length),a=c.length;a--;)f[a]=c[a];return f});var c;c=fabric.document.defaultView&&fabric.document.defaultView.getComputedStyle?function(c,f){var a=fabric.document.defaultView.getComputedStyle(c,
null);return a?a[f]:void 0}:function(c,f){var a=c.style[f];!a&&c.currentStyle&&(a=c.currentStyle[f]);return a};(function(){var c=fabric.document.documentElement.style,f="userSelect"in c?"userSelect":"MozUserSelect"in c?"MozUserSelect":"WebkitUserSelect"in c?"WebkitUserSelect":"KhtmlUserSelect"in c?"KhtmlUserSelect":"";fabric.util.makeElementUnselectable=function(c){"undefined"!==typeof c.onselectstart&&(c.onselectstart=fabric.util.falseFunction);f?c.style[f]="none":"string"===typeof c.unselectable&&
(c.unselectable="on");return c};fabric.util.makeElementSelectable=function(c){"undefined"!==typeof c.onselectstart&&(c.onselectstart=null);f?c.style[f]="":"string"===typeof c.unselectable&&(c.unselectable="");return c}})();(function(){fabric.util.getScript=function(c,f){var a=fabric.document.getElementsByTagName("head")[0],b=fabric.document.createElement("script"),d=!0;b.onload=b.onreadystatechange=function(c){!d||"string"===typeof this.readyState&&"loaded"!==this.readyState&&"complete"!==this.readyState||
(d=!1,f(c||fabric.window.event),b=b.onload=b.onreadystatechange=null)};b.src=c;a.appendChild(b)}})();fabric.util.getById=function(c){return"string"===typeof c?fabric.document.getElementById(c):c};fabric.util.toArray=a;fabric.util.makeElement=e;fabric.util.addClass=function(c,f){c&&-1===(" "+c.className+" ").indexOf(" "+f+" ")&&(c.className+=(c.className?" ":"")+f)};fabric.util.wrapElement=function(c,f,a){"string"===typeof f&&(f=e(f,a));c.parentNode&&c.parentNode.replaceChild(f,c);f.appendChild(c);
return f};fabric.util.getScrollLeftTop=function(c,f){var a,b,d=0,e=0,n=fabric.document.documentElement,x=fabric.document.body||{scrollLeft:0,scrollTop:0};for(b=c;c&&c.parentNode&&!a;)c=c.parentNode,1===c.nodeType&&"fixed"===fabric.util.getElementStyle(c,"position")&&(a=c),1===c.nodeType&&b!==f&&"absolute"===fabric.util.getElementStyle(c,"position")?e=d=0:c===fabric.document?(d=x.scrollLeft||n.scrollLeft||0,e=x.scrollTop||n.scrollTop||0):(d+=c.scrollLeft||0,e+=c.scrollTop||0);return{left:d,top:e}};
fabric.util.getElementOffset=function(a){var f;f=a&&a.ownerDocument;var b={left:0,top:0},d={left:0,top:0},e={borderLeftWidth:"left",borderTopWidth:"top",paddingLeft:"left",paddingTop:"top"};if(!f)return{left:0,top:0};for(var p in e)d[e[p]]+=parseInt(c(a,p),10)||0;f=f.documentElement;"undefined"!==typeof a.getBoundingClientRect&&(b=a.getBoundingClientRect());a=fabric.util.getScrollLeftTop(a,null);return{left:b.left+a.left-(f.clientLeft||0)+d.left,top:b.top+a.top-(f.clientTop||0)+d.top}};fabric.util.getElementStyle=
c})();
(function(){function e(a,c){return a+(/\?/.test(a)?"&":"?")+c}function b(){}var d=function(){for(var a=[function(){return new ActiveXObject("Microsoft.XMLHTTP")},function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Msxml2.XMLHTTP.3.0")},function(){return new XMLHttpRequest}],c=a.length;c--;)try{if(a[c]())return a[c]}catch(b){}}();fabric.util.request=function(a,c){c||(c={});var g=c.method?c.method.toUpperCase():"GET",f=c.onComplete||function(){},k=d(),l;k.onreadystatechange=
function(){4===k.readyState&&(f(k),k.onreadystatechange=b)};"GET"===g&&(l=null,"string"===typeof c.parameters&&(a=e(a,c.parameters)));k.open(g,a,!0);"POST"!==g&&"PUT"!==g||k.setRequestHeader("Content-Type","application/x-www-form-urlencoded");k.send(l);return k}})();fabric.log=function(){};fabric.warn=function(){};
"undefined"!==typeof console&&["log","warn"].forEach(function(e){"undefined"!==typeof console[e]&&"function"===typeof console[e].apply&&(fabric[e]=function(){return console[e].apply(console,arguments)})});
(function(){function e(){return b.apply(fabric.window,arguments)}var b=fabric.window.requestAnimationFrame||fabric.window.webkitRequestAnimationFrame||fabric.window.mozRequestAnimationFrame||fabric.window.oRequestAnimationFrame||fabric.window.msRequestAnimationFrame||function(b){fabric.window.setTimeout(b,1E3/60)};fabric.util.animate=function(b){e(function(a){b||(b={});var c=a||+new Date,g=b.duration||500,f=c+g,k,l=b.onChange||function(){},m=b.abort||function(){return!1},p=b.easing||function(c,f,
a,b){return-a*Math.cos(c/b*(Math.PI/2))+a+f},n="startValue"in b?b.startValue:0;a="endValue"in b?b.endValue:100;var x=b.byValue||a-n;b.onStart&&b.onStart();(function E(a){k=a||+new Date;a=k>f?g:k-c;m()?b.onComplete&&b.onComplete():(l(p(a,n,x,g)),k>f?b.onComplete&&b.onComplete():e(E))})(c)})};fabric.util.requestAnimFrame=e})();
(function(){function e(c,a,f,b){c<Math.abs(a)?(c=a,b=f/4):b=f/(2*Math.PI)*Math.asin(a/c);return{a:c,c:a,p:f,s:b}}function b(c,a,f){return c.a*Math.pow(2,10*--a)*Math.sin(2*(a*f-c.s)*Math.PI/c.p)}function d(c,b,f,d){return f-a(d-c,0,f,d)+b}function a(c,a,f,b){return(c/=b)<1/2.75?7.5625*f*c*c+a:c<2/2.75?f*(7.5625*(c-=1.5/2.75)*c+.75)+a:c<2.5/2.75?f*(7.5625*(c-=2.25/2.75)*c+.9375)+a:f*(7.5625*(c-=2.625/2.75)*c+.984375)+a}fabric.util.ease={easeInQuad:function(c,a,f,b){return f*(c/=b)*c+a},easeOutQuad:function(c,
a,f,b){return-f*(c/=b)*(c-2)+a},easeInOutQuad:function(c,a,f,b){c/=b/2;return 1>c?f/2*c*c+a:-f/2*(--c*(c-2)-1)+a},easeInCubic:function(c,a,f,b){return f*(c/=b)*c*c+a},easeOutCubic:function(c,a,f,b){return f*((c=c/b-1)*c*c+1)+a},easeInOutCubic:function(c,a,f,b){c/=b/2;return 1>c?f/2*c*c*c+a:f/2*((c-=2)*c*c+2)+a},easeInQuart:function(c,a,f,b){return f*(c/=b)*c*c*c+a},easeOutQuart:function(c,a,f,b){return-f*((c=c/b-1)*c*c*c-1)+a},easeInOutQuart:function(c,a,f,b){c/=b/2;return 1>c?f/2*c*c*c*c+a:-f/2*
((c-=2)*c*c*c-2)+a},easeInQuint:function(c,a,f,b){return f*(c/=b)*c*c*c*c+a},easeOutQuint:function(c,a,f,b){return f*((c=c/b-1)*c*c*c*c+1)+a},easeInOutQuint:function(c,a,f,b){c/=b/2;return 1>c?f/2*c*c*c*c*c+a:f/2*((c-=2)*c*c*c*c+2)+a},easeInSine:function(c,a,f,b){return-f*Math.cos(c/b*(Math.PI/2))+f+a},easeOutSine:function(c,a,f,b){return f*Math.sin(c/b*(Math.PI/2))+a},easeInOutSine:function(c,a,f,b){return-f/2*(Math.cos(Math.PI*c/b)-1)+a},easeInExpo:function(c,a,f,b){return 0===c?a:f*Math.pow(2,
10*(c/b-1))+a},easeOutExpo:function(c,a,f,b){return c===b?a+f:f*(-Math.pow(2,-10*c/b)+1)+a},easeInOutExpo:function(c,a,f,b){if(0===c)return a;if(c===b)return a+f;c/=b/2;return 1>c?f/2*Math.pow(2,10*(c-1))+a:f/2*(-Math.pow(2,-10*--c)+2)+a},easeInCirc:function(c,a,f,b){return-f*(Math.sqrt(1-(c/=b)*c)-1)+a},easeOutCirc:function(c,a,f,b){return f*Math.sqrt(1-(c=c/b-1)*c)+a},easeInOutCirc:function(c,a,f,b){c/=b/2;return 1>c?-f/2*(Math.sqrt(1-c*c)-1)+a:f/2*(Math.sqrt(1-(c-=2)*c)+1)+a},easeInElastic:function(c,
a,f,d){var l=0;if(0===c)return a;c/=d;if(1===c)return a+f;l||(l=.3*d);f=e(f,f,l,1.70158);return-b(f,c,d)+a},easeOutElastic:function(c,a,f,b){var d=0;if(0===c)return a;c/=b;if(1===c)return a+f;d||(d=.3*b);f=e(f,f,d,1.70158);return f.a*Math.pow(2,-10*c)*Math.sin(2*(c*b-f.s)*Math.PI/f.p)+f.c+a},easeInOutElastic:function(c,a,f,d){var l=0;if(0===c)return a;c/=d/2;if(2===c)return a+f;l||(l=.3*d*1.5);f=e(f,f,l,1.70158);return 1>c?-.5*b(f,c,d)+a:f.a*Math.pow(2,-10*--c)*Math.sin(2*(c*d-f.s)*Math.PI/f.p)*.5+
f.c+a},easeInBack:function(c,a,f,b,d){void 0===d&&(d=1.70158);return f*(c/=b)*c*((d+1)*c-d)+a},easeOutBack:function(c,a,f,b,d){void 0===d&&(d=1.70158);return f*((c=c/b-1)*c*((d+1)*c+d)+1)+a},easeInOutBack:function(c,a,f,b,d){void 0===d&&(d=1.70158);c/=b/2;return 1>c?f/2*c*c*(((d*=1.525)+1)*c-d)+a:f/2*((c-=2)*c*(((d*=1.525)+1)*c+d)+2)+a},easeInBounce:d,easeOutBounce:a,easeInOutBounce:function(c,b,f,k){return c<k/2?.5*d(2*c,0,f,k)+b:.5*a(2*c-k,0,f,k)+.5*f+b}}})();
(function(e){function b(c){return c in t?t[c]:c}function d(c,f,a,b){var d="[object Array]"===Object.prototype.toString.call(f),g;"fill"!==c&&"stroke"!==c||"none"!==f?"strokeDashArray"===c?f=f.replace(/,/g," ").split(/\s+/).map(function(c){return parseFloat(c)}):"transformMatrix"===c?f=a&&a.transformMatrix?q(a.transformMatrix,n.parseTransformAttribute(f)):n.parseTransformAttribute(f):"visible"===c?(f="none"===f||"hidden"===f?!1:!0,a&&!1===a.visible&&(f=!1)):"originX"===c?f="start"===f?"left":"end"===
f?"right":"center":g=d?f.map(z):z(f,b):f="";return!d&&isNaN(g)?f:g}function a(c){for(var f in r)if(c[f]&&"undefined"!==typeof c[r[f]]&&0!==c[f].indexOf("url(")){var a=new n.Color(c[f]);c[f]=a.setAlpha(u(a.getAlpha()*c[r[f]],2)).toRgba()}return c}function c(c,f){var a,g;c.replace(/;$/,"").split(";").forEach(function(c){c=c.split(":");a=b(c[0].trim().toLowerCase());g=d(a,c[1].trim());f[a]=g})}function g(c,a){var b={},d;for(d in n.cssRules[a]){var g=c,k=d.split(" "),e=void 0,l=!0;if((e=f(g,k.pop()))&&
k.length){for(var l=k,m=void 0,p=!0;g.parentNode&&1===g.parentNode.nodeType&&l.length;)p&&(m=l.pop()),g=g.parentNode,p=f(g,m);l=0===l.length}if(e&&l&&0===k.length)for(var x in n.cssRules[a][d])b[x]=n.cssRules[a][d][x]}return b}function f(c,f){var a=c.nodeName,b=c.getAttribute("class"),d=c.getAttribute("id"),a=new RegExp("^"+a,"i");f=f.replace(a,"");d&&f.length&&(a=new RegExp("#"+d+"(?![a-zA-Z\\-]+)","i"),f=f.replace(a,""));if(b&&f.length)for(b=b.split(" "),d=b.length;d--;)a=new RegExp("\\."+b[d]+
"(?![a-zA-Z\\-]+)","i"),f=f.replace(a,"");return 0===f.length}function k(c){for(var f=c.getElementsByTagName("use");f.length;){for(var a=f[0],b=a.getAttribute("xlink:href").substr(1),d=a.getAttribute("x")||0,g=a.getAttribute("y")||0,b=c.getElementById(b).cloneNode(!0),d=(b.getAttribute("transform")||"")+" translate("+d+", "+g+")",g=0,k=a.attributes,e=k.length;g<e;g++){var l=k.item(g);"x"!==l.nodeName&&"y"!==l.nodeName&&"xlink:href"!==l.nodeName&&("transform"===l.nodeName?d=l.nodeValue+" "+d:b.setAttribute(l.nodeName,
l.nodeValue))}b.setAttribute("transform",d);b.setAttribute("instantiated_by_use","1");b.removeAttribute("id");a.parentNode.replaceChild(b,a)}}function l(c,f,a){var b=c.getAttribute("viewBox"),d=1,g=1,k=0,e=0,l;if(b&&(b=b.match(v))&&(k=-parseFloat(b[1]),e=-parseFloat(b[2]),l=parseFloat(b[3]),b=parseFloat(b[4]),f&&f!==l&&(d=f/l),a&&a!==b&&(g=a/b),g=d=d>g?g:d,1!==d||1!==g||0!==k||0!==e)){f=" matrix("+d+" 0 0 "+g+" "+k*d+" "+e*g+") ";if("svg"===c.tagName){for(a=c.ownerDocument.createElement("g");null!=
c.firstChild;)a.appendChild(c.firstChild);c.appendChild(a)}else a=c,f=a.getAttribute("transform")+f;a.setAttribute("transform",f)}}function m(c){var f=c.objects;c=c.options;f=f.map(function(c){return n[y(c.type)].fromObject(c)});return{objects:f,options:c}}function p(c,f,a){f[a]&&f[a].toSVG&&c.push('<pattern x="0" y="0" id="',a,'Pattern" ','width="',f[a].source.width,'" height="',f[a].source.height,'" patternUnits="userSpaceOnUse">','<image x="0" y="0" ','width="',f[a].source.width,'" height="',f[a].source.height,
'" xlink:href="',f[a].source.src,'"></image></pattern>')}var n=e.fabric||(e.fabric={}),x=n.util.object.extend,y=n.util.string.capitalize,E=n.util.object.clone,u=n.util.toFixed,z=n.util.parseUnit,q=n.util.multiplyTransformMatrices,t={cx:"left",x:"left",r:"radius",cy:"top",y:"top",display:"visible",visibility:"visible",transform:"transformMatrix","fill-opacity":"fillOpacity","fill-rule":"fillRule","font-family":"fontFamily","font-size":"fontSize","font-style":"fontStyle","font-weight":"fontWeight",
"stroke-dasharray":"strokeDashArray","stroke-linecap":"strokeLineCap","stroke-linejoin":"strokeLineJoin","stroke-miterlimit":"strokeMiterLimit","stroke-opacity":"strokeOpacity","stroke-width":"strokeWidth","text-decoration":"textDecoration","text-anchor":"originX"},r={stroke:"strokeOpacity",fill:"fillOpacity"};n.cssRules={};n.gradientDefs={};n.parseTransformAttribute=function(){function c(f,a){var b=a[0];f[0]=Math.cos(b);f[1]=Math.sin(b);f[2]=-Math.sin(b);f[3]=Math.cos(b)}function f(c,a){var b=2===
a.length?a[1]:a[0];c[0]=a[0];c[3]=b}function a(c,f){c[4]=f[0];2===f.length&&(c[5]=f[1])}var b=[1,0,0,1,0,0],d=n.reNum,g="(?:"+("(?:(matrix)\\s*\\(\\s*("+d+")(?:\\s+,?\\s*|,\\s*)("+d+")(?:\\s+,?\\s*|,\\s*)("+d+")(?:\\s+,?\\s*|,\\s*)("+d+")(?:\\s+,?\\s*|,\\s*)("+d+")(?:\\s+,?\\s*|,\\s*)("+d+")\\s*\\))")+"|"+("(?:(translate)\\s*\\(\\s*("+d+")(?:(?:\\s+,?\\s*|,\\s*)("+d+"))?\\s*\\))")+"|"+("(?:(scale)\\s*\\(\\s*("+d+")(?:(?:\\s+,?\\s*|,\\s*)("+d+"))?\\s*\\))")+"|"+("(?:(rotate)\\s*\\(\\s*("+d+")(?:(?:\\s+,?\\s*|,\\s*)("+
d+")(?:\\s+,?\\s*|,\\s*)("+d+"))?\\s*\\))")+"|"+("(?:(skewX)\\s*\\(\\s*("+d+")\\s*\\))")+"|"+("(?:(skewY)\\s*\\(\\s*("+d+")\\s*\\))")+")",k=new RegExp("^\\s*(?:"+("(?:"+g+"(?:(?:\\s+,?\\s*|,\\s*)"+g+")*)")+"?)\\s*$"),e=new RegExp(g,"g");return function(d){var l=b.concat(),m=[];if(!d||d&&!k.test(d))return l;d.replace(e,function(d){var k=(new RegExp(g)).exec(d).filter(function(c){return""!==c&&null!=c});d=k[1];k=k.slice(2).map(parseFloat);switch(d){case "translate":a(l,k);break;case "rotate":k[0]=n.util.degreesToRadians(k[0]);
c(l,k);break;case "scale":f(l,k);break;case "skewX":l[2]=Math.tan(n.util.degreesToRadians(k[0]));break;case "skewY":l[1]=Math.tan(n.util.degreesToRadians(k[0]));break;case "matrix":l=k}m.push(l.concat());l=b.concat()});for(d=m[0];1<m.length;)m.shift(),d=n.util.multiplyTransformMatrices(d,m[0]);return d}}();var v=new RegExp("^\\s*("+n.reNum+"+)\\s*,?\\s*("+n.reNum+"+)\\s*,?\\s*("+n.reNum+"+)\\s*,?\\s*("+n.reNum+"+)\\s*$");n.parseSVGDocument=function(){var c=/^(path|circle|polygon|polyline|ellipse|rect|line|image|text)$/,
f=/^(symbol|image|marker|pattern|view)$/;return function(a,b,d){if(a){k(a);var g=new Date,e=n.Object.__uid++,m,p,x=!1;a.getAttribute("width")&&"100%"!==a.getAttribute("width")&&(m=z(a.getAttribute("width")));a.getAttribute("height")&&"100%"!==a.getAttribute("height")&&(p=z(a.getAttribute("height")));if(!m||!p){var u=a.getAttribute("viewBox");u&&(u=u.match(v))?(m=parseFloat(u[3]),p=parseFloat(u[4])):x=!0}l(a,m,p);u=n.util.toArray(a.getElementsByTagName("*"));if(0===u.length&&n.isLikelyNode){for(var u=
a.selectNodes('//*[name(.)!="svg"]'),y=[],q=0,w=u.length;q<w;q++)y[q]=u[q];u=y}u=u.filter(function(a){f.test(a.tagName)&&l(a,0,0);var b;if(b=c.test(a.tagName)){a:{for(b=/^(?:pattern|defs|symbol)$/;a&&(a=a.parentNode);)if(b.test(a.nodeName)&&!a.getAttribute("instantiated_by_use")){a=!0;break a}a=!1}b=!a}return b});if(!u||u&&!u.length)b&&b([],{});else{var t={width:m,height:p,svgUid:e,toBeParsed:x};n.gradientDefs[e]=n.getGradientDefs(a);n.cssRules[e]=n.getCSSRules(a);n.parseElements(u,function(c){n.documentParsingTime=
new Date-g;b&&b(c,t)},E(t),d)}}}}();var w={has:function(c,a){a(!1)},get:function(){},set:function(){}},D=new RegExp("(normal|italic)?\\s*(normal|small-caps)?\\s*(normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900)?\\s*("+n.reNum+"(?:px|cm|mm|em|pt|pc|in)*)(?:\\/(normal|"+n.reNum+"))?\\s+(.*)");x(n,{parseFontDeclaration:function(c,a){var f=c.match(D);if(f){var b=f[1],d=f[3],g=f[4],k=f[5],f=f[6];b&&(a.fontStyle=b);d&&(a.fontWeight=isNaN(parseFloat(d))?d:parseFloat(d));g&&(a.fontSize=z(g));
f&&(a.fontFamily=f);k&&(a.lineHeight="normal"===k?1:k)}},getGradientDefs:function(c){var a=c.getElementsByTagName("linearGradient"),f=c.getElementsByTagName("radialGradient"),b,d=0,g,k=[];c={};var e={};k.length=a.length+f.length;for(b=a.length;b--;)k[d++]=a[b];for(b=f.length;b--;)k[d++]=f[b];for(;d--;)a=k[d],f=a.getAttribute("xlink:href"),g=a.getAttribute("id"),f&&(e[g]=f.substr(1)),c[g]=a;for(g in e)for(d=c[e[g]].cloneNode(!0),a=c[g];d.firstChild;)a.appendChild(d.firstChild);return c},parseAttributes:function(c,
f,k){if(c){var e,l={},m;"undefined"===typeof k&&(k=c.getAttribute("svgUid"));c.parentNode&&/^symbol|[g|a]$/i.test(c.parentNode.nodeName)&&(l=n.parseAttributes(c.parentNode,f,k));m=l&&l.fontSize||c.getAttribute("font-size")||n.Text.DEFAULT_SVG_FONT_SIZE;f=f.reduce(function(f,a){if(e=c.getAttribute(a))a=b(a),e=d(a,e,l,m),f[a]=e;return f},{});f=x(f,x(g(c,k),n.parseStyleAttribute(c)));f.font&&n.parseFontDeclaration(f.font,f);return a(x(l,f))}},parseElements:function(c,a,f,b){(new n.ElementsParser(c,a,
f,b)).parse()},parseStyleAttribute:function(a){var f={};a=a.getAttribute("style");if(!a)return f;if("string"===typeof a)c(a,f);else{var g,k,e;for(e in a)"undefined"!==typeof a[e]&&(g=b(e.toLowerCase()),k=d(g,a[e]),f[g]=k)}return f},parsePointsAttribute:function(c){if(!c)return null;c=c.replace(/,/g," ").trim();c=c.split(/\s+/);var a=[],f,b;f=0;for(b=c.length;f<b;f+=2)a.push({x:parseFloat(c[f]),y:parseFloat(c[f+1])});return a},getCSSRules:function(c){c=c.getElementsByTagName("style");for(var a={},
f,g=0,k=c.length;g<k;g++)f=c[g].textContent,f=f.replace(/\/\*[\s\S]*?\*\//g,""),""!==f.trim()&&(f=f.match(/[^{]*\{[\s\S]*?\}/g),f=f.map(function(c){return c.trim()}),f.forEach(function(c){c=c.match(/([\s\S]*?)\s*\{([^}]*)\}/);for(var f={},g=c[2].trim().replace(/;$/,"").split(/\s*;\s*/),k=0,e=g.length;k<e;k++){var l=g[k].split(/\s*:\s*/),m=b(l[0]),l=d(m,l[1],l[0]);f[m]=l}c=c[1];c.split(",").forEach(function(c){c=c.replace(/^svg/i,"").trim();""!==c&&(a[c]=n.util.object.clone(f))})}));return a},loadSVGFromURL:function(c,
f,a){function b(d){var g=d.responseXML;g&&!g.documentElement&&n.window.ActiveXObject&&d.responseText&&(g=new ActiveXObject("Microsoft.XMLDOM"),g.async="false",g.loadXML(d.responseText.replace(/<!DOCTYPE[\s\S]*?(\[[\s\S]*\])*?>/i,"")));g&&g.documentElement&&n.parseSVGDocument(g.documentElement,function(a,b){w.set(c,{objects:n.util.array.invoke(a,"toObject"),options:b});f(a,b)},a)}c=c.replace(/^\n\s*/,"").trim();w.has(c,function(a){a?w.get(c,function(c){c=m(c);f(c.objects,c.options)}):new n.util.request(c,
{method:"get",onComplete:b})})},loadSVGFromString:function(c,f,a){c=c.trim();var b;if("undefined"!==typeof DOMParser){var d=new DOMParser;d&&d.parseFromString&&(b=d.parseFromString(c,"text/xml"))}else n.window.ActiveXObject&&(b=new ActiveXObject("Microsoft.XMLDOM"),b.async="false",b.loadXML(c.replace(/<!DOCTYPE[\s\S]*?(\[[\s\S]*\])*?>/i,"")));n.parseSVGDocument(b.documentElement,function(c,a){f(c,a)},a)},createSVGFontFacesMarkup:function(c){for(var f="",a=0,b=c.length;a<b;a++)"text"===c[a].type&&
c[a].path&&(f+=["@font-face {font-family: ",c[a].fontFamily,"; src: url('",c[a].path,"')}"].join(""));f&&(f=['<style type="text/css"><![CDATA[',f,"]]\x3e</style>"].join(""));return f},createSVGRefElementsMarkup:function(c){var f=[];p(f,c,"backgroundColor");p(f,c,"overlayColor");return f.join("")}})})("undefined"!==typeof exports?exports:this);fabric.ElementsParser=function(e,b,d,a){this.elements=e;this.callback=b;this.options=d;this.reviver=a;this.svgUid=d&&d.svgUid||0};
fabric.ElementsParser.prototype.parse=function(){this.instances=Array(this.elements.length);this.numElements=this.elements.length;this.createObjects()};fabric.ElementsParser.prototype.createObjects=function(){for(var e=0,b=this.elements.length;e<b;e++)this.elements[e].setAttribute("svgUid",this.svgUid),function(b,a){setTimeout(function(){b.createObject(b.elements[a],a)},0)}(this,e)};
fabric.ElementsParser.prototype.createObject=function(e,b){var d=fabric[fabric.util.string.capitalize(e.tagName)];if(d&&d.fromElement)try{this._createObject(d,e,b)}catch(a){fabric.log(a)}else this.checkIfDone()};fabric.ElementsParser.prototype._createObject=function(e,b,d){e.async?e.fromElement(b,this.createCallback(d,b),this.options):(e=e.fromElement(b,this.options),this.resolveGradient(e,"fill"),this.resolveGradient(e,"stroke"),this.reviver&&this.reviver(b,e),this.instances[d]=e,this.checkIfDone())};
fabric.ElementsParser.prototype.createCallback=function(e,b){var d=this;return function(a){d.resolveGradient(a,"fill");d.resolveGradient(a,"stroke");d.reviver&&d.reviver(b,a);d.instances[e]=a;d.checkIfDone()}};fabric.ElementsParser.prototype.resolveGradient=function(e,b){var d=e.get(b);/^url\(/.test(d)&&(d=d.slice(5,d.length-1),fabric.gradientDefs[this.svgUid][d]&&e.set(b,fabric.Gradient.fromElement(fabric.gradientDefs[this.svgUid][d],e)))};
fabric.ElementsParser.prototype.checkIfDone=function(){0===--this.numElements&&(this.instances=this.instances.filter(function(e){return null!=e}),this.callback(this.instances))};
(function(e){function b(b,a){this.x=b;this.y=a}e=e.fabric||(e.fabric={});e.Point?e.warn("fabric.Point is already defined"):(e.Point=b,b.prototype={constructor:b,add:function(d){return new b(this.x+d.x,this.y+d.y)},addEquals:function(b){this.x+=b.x;this.y+=b.y;return this},scalarAdd:function(d){return new b(this.x+d,this.y+d)},scalarAddEquals:function(b){this.x+=b;this.y+=b;return this},subtract:function(d){return new b(this.x-d.x,this.y-d.y)},subtractEquals:function(b){this.x-=b.x;this.y-=b.y;return this},
scalarSubtract:function(d){return new b(this.x-d,this.y-d)},scalarSubtractEquals:function(b){this.x-=b;this.y-=b;return this},multiply:function(d){return new b(this.x*d,this.y*d)},multiplyEquals:function(b){this.x*=b;this.y*=b;return this},divide:function(d){return new b(this.x/d,this.y/d)},divideEquals:function(b){this.x/=b;this.y/=b;return this},eq:function(b){return this.x===b.x&&this.y===b.y},lt:function(b){return this.x<b.x&&this.y<b.y},lte:function(b){return this.x<=b.x&&this.y<=b.y},gt:function(b){return this.x>
b.x&&this.y>b.y},gte:function(b){return this.x>=b.x&&this.y>=b.y},lerp:function(d,a){return new b(this.x+(d.x-this.x)*a,this.y+(d.y-this.y)*a)},distanceFrom:function(b){var a=this.x-b.x;b=this.y-b.y;return Math.sqrt(a*a+b*b)},midPointFrom:function(d){return new b(this.x+(d.x-this.x)/2,this.y+(d.y-this.y)/2)},min:function(d){return new b(Math.min(this.x,d.x),Math.min(this.y,d.y))},max:function(d){return new b(Math.max(this.x,d.x),Math.max(this.y,d.y))},toString:function(){return this.x+","+this.y},
setXY:function(b,a){this.x=b;this.y=a},setFromPoint:function(b){this.x=b.x;this.y=b.y},swap:function(b){var a=this.x,c=this.y;this.x=b.x;this.y=b.y;b.x=a;b.y=c}})})("undefined"!==typeof exports?exports:this);
(function(e){function b(a){this.status=a;this.points=[]}var d=e.fabric||(e.fabric={});d.Intersection?d.warn("fabric.Intersection is already defined"):(d.Intersection=b,d.Intersection.prototype={appendPoint:function(a){this.points.push(a)},appendPoints:function(a){this.points=this.points.concat(a)}},d.Intersection.intersectLineLine=function(a,c,g,f){var k,e=(f.x-g.x)*(a.y-g.y)-(f.y-g.y)*(a.x-g.x);k=(c.x-a.x)*(a.y-g.y)-(c.y-a.y)*(a.x-g.x);g=(f.y-g.y)*(c.x-a.x)-(f.x-g.x)*(c.y-a.y);0!==g?(e/=g,k/=g,0<=
e&&1>=e&&0<=k&&1>=k?(k=new b("Intersection"),k.points.push(new d.Point(a.x+e*(c.x-a.x),a.y+e*(c.y-a.y)))):k=new b):k=0===e||0===k?new b("Coincident"):new b("Parallel");return k},d.Intersection.intersectLinePolygon=function(a,c,d){for(var f=new b,k=d.length,e=0;e<k;e++){var m=b.intersectLineLine(a,c,d[e],d[(e+1)%k]);f.appendPoints(m.points)}0<f.points.length&&(f.status="Intersection");return f},d.Intersection.intersectPolygonPolygon=function(a,c){for(var d=new b,f=a.length,k=0;k<f;k++){var e=b.intersectLinePolygon(a[k],
a[(k+1)%f],c);d.appendPoints(e.points)}0<d.points.length&&(d.status="Intersection");return d},d.Intersection.intersectPolygonRectangle=function(a,c,g){var f=c.min(g),k=c.max(g);g=new d.Point(k.x,f.y);var e=new d.Point(f.x,k.y);c=b.intersectLinePolygon(f,g,a);g=b.intersectLinePolygon(g,k,a);k=b.intersectLinePolygon(k,e,a);a=b.intersectLinePolygon(e,f,a);f=new b;f.appendPoints(c.points);f.appendPoints(g.points);f.appendPoints(k.points);f.appendPoints(a.points);0<f.points.length&&(f.status="Intersection");
return f})})("undefined"!==typeof exports?exports:this);
(function(e){function b(c){c?this._tryParsingColor(c):this.setSource([0,0,0,1])}function d(c,a,f){0>f&&(f+=1);1<f&&--f;return f<1/6?c+6*(a-c)*f:.5>f?a:f<2/3?c+(a-c)*(2/3-f)*6:c}var a=e.fabric||(e.fabric={});a.Color?a.warn("fabric.Color is already defined."):(a.Color=b,a.Color.prototype={_tryParsingColor:function(c){var a;c in b.colorNameMap&&(c=b.colorNameMap[c]);"transparent"===c?this.setSource([255,255,255,0]):((a=b.sourceFromHex(c))||(a=b.sourceFromRgb(c)),a||(a=b.sourceFromHsl(c)),a&&this.setSource(a))},
_rgbToHsl:function(c,b,f){c/=255;b/=255;f/=255;var d,e,m,p=a.util.array.max([c,b,f]);e=a.util.array.min([c,b,f]);m=(p+e)/2;if(p===e)d=e=0;else{var n=p-e;e=.5<m?n/(2-p-e):n/(p+e);switch(p){case c:d=(b-f)/n+(b<f?6:0);break;case b:d=(f-c)/n+2;break;case f:d=(c-b)/n+4}d/=6}return[Math.round(360*d),Math.round(100*e),Math.round(100*m)]},getSource:function(){return this._source},setSource:function(c){this._source=c},toRgb:function(){var c=this.getSource();return"rgb("+c[0]+","+c[1]+","+c[2]+")"},toRgba:function(){var c=
this.getSource();return"rgba("+c[0]+","+c[1]+","+c[2]+","+c[3]+")"},toHsl:function(){var c=this.getSource(),c=this._rgbToHsl(c[0],c[1],c[2]);return"hsl("+c[0]+","+c[1]+"%,"+c[2]+"%)"},toHsla:function(){var c=this.getSource(),a=this._rgbToHsl(c[0],c[1],c[2]);return"hsla("+a[0]+","+a[1]+"%,"+a[2]+"%,"+c[3]+")"},toHex:function(){var c=this.getSource(),a,f;a=c[0].toString(16);a=1===a.length?"0"+a:a;f=c[1].toString(16);f=1===f.length?"0"+f:f;c=c[2].toString(16);c=1===c.length?"0"+c:c;return a.toUpperCase()+
f.toUpperCase()+c.toUpperCase()},getAlpha:function(){return this.getSource()[3]},setAlpha:function(c){var a=this.getSource();a[3]=c;this.setSource(a);return this},toGrayscale:function(){var c=this.getSource(),a=parseInt((.3*c[0]+.59*c[1]+.11*c[2]).toFixed(0),10);this.setSource([a,a,a,c[3]]);return this},toBlackWhite:function(c){var a=this.getSource(),f=(.3*a[0]+.59*a[1]+.11*a[2]).toFixed(0),a=a[3],f=Number(f)<Number(c||127)?0:255;this.setSource([f,f,f,a]);return this},overlayWith:function(c){c instanceof
b||(c=new b(c));var a=[],f=this.getAlpha(),d=this.getSource();c=c.getSource();for(var e=0;3>e;e++)a.push(Math.round(.5*d[e]+.5*c[e]));a[3]=f;this.setSource(a);return this}},a.Color.reRGBa=/^rgba?\(\s*(\d{1,3}(?:\.\d+)?\%?)\s*,\s*(\d{1,3}(?:\.\d+)?\%?)\s*,\s*(\d{1,3}(?:\.\d+)?\%?)\s*(?:\s*,\s*(\d+(?:\.\d+)?)\s*)?\)$/,a.Color.reHSLa=/^hsla?\(\s*(\d{1,3})\s*,\s*(\d{1,3}\%)\s*,\s*(\d{1,3}\%)\s*(?:\s*,\s*(\d+(?:\.\d+)?)\s*)?\)$/,a.Color.reHex=/^#?([0-9a-f]{6}|[0-9a-f]{3})$/i,a.Color.colorNameMap={aqua:"#00FFFF",
black:"#000000",blue:"#0000FF",fuchsia:"#FF00FF",gray:"#808080",green:"#008000",lime:"#00FF00",maroon:"#800000",navy:"#000080",olive:"#808000",orange:"#FFA500",purple:"#800080",red:"#FF0000",silver:"#C0C0C0",teal:"#008080",white:"#FFFFFF",yellow:"#FFFF00"},a.Color.fromRgb=function(c){return b.fromSource(b.sourceFromRgb(c))},a.Color.sourceFromRgb=function(c){if(c=c.match(b.reRGBa)){var a=parseInt(c[1],10)/(/%$/.test(c[1])?100:1)*(/%$/.test(c[1])?255:1),f=parseInt(c[2],10)/(/%$/.test(c[2])?100:1)*(/%$/.test(c[2])?
255:1),d=parseInt(c[3],10)/(/%$/.test(c[3])?100:1)*(/%$/.test(c[3])?255:1);return[parseInt(a,10),parseInt(f,10),parseInt(d,10),c[4]?parseFloat(c[4]):1]}},a.Color.fromRgba=b.fromRgb,a.Color.fromHsl=function(c){return b.fromSource(b.sourceFromHsl(c))},a.Color.sourceFromHsl=function(c){if(c=c.match(b.reHSLa)){var a=(parseFloat(c[1])%360+360)%360/360,f=parseFloat(c[2])/(/%$/.test(c[2])?100:1),k=parseFloat(c[3])/(/%$/.test(c[3])?100:1);if(0===f)k=f=a=k;else var e=.5>=k?k*(f+1):k+f-k*f,m=2*k-e,k=d(m,e,
a+1/3),f=d(m,e,a),a=d(m,e,a-1/3);return[Math.round(255*k),Math.round(255*f),Math.round(255*a),c[4]?parseFloat(c[4]):1]}},a.Color.fromHsla=b.fromHsl,a.Color.fromHex=function(c){return b.fromSource(b.sourceFromHex(c))},a.Color.sourceFromHex=function(c){if(c.match(b.reHex)){var a=c.slice(c.indexOf("#")+1),f=3===a.length;c=f?a.charAt(0)+a.charAt(0):a.substring(0,2);var d=f?a.charAt(1)+a.charAt(1):a.substring(2,4),a=f?a.charAt(2)+a.charAt(2):a.substring(4,6);return[parseInt(c,16),parseInt(d,16),parseInt(a,
16),1]}},a.Color.fromSource=function(c){var a=new b;a.setSource(c);return a})})("undefined"!==typeof exports?exports:this);
(function(){function e(b){var a=b.getAttribute("style"),c=b.getAttribute("offset"),g,f,c=parseFloat(c)/(/%$/.test(c)?100:1),c=0>c?0:1<c?1:c;if(a){a=a.split(/\s*;\s*/);""===a[a.length-1]&&a.pop();for(var k=a.length;k--;){var e=a[k].split(/\s*:\s*/),m=e[0].trim(),e=e[1].trim();"stop-color"===m?g=e:"stop-opacity"===m&&(f=e)}}g||(g=b.getAttribute("stop-color")||"rgb(0,0,0)");f||(f=b.getAttribute("stop-opacity"));g=new fabric.Color(g);b=g.getAlpha();f=isNaN(parseFloat(f))?1:parseFloat(f);f*=b;return{offset:c,
color:g.toRgb(),opacity:f}}function b(b,a,c){var g,f=0,k=1,e="",m;for(m in a){g=parseFloat(a[m],10);k="string"===typeof a[m]&&/^\d+%$/.test(a[m])?.01:1;if("x1"===m||"x2"===m||"r2"===m)k*="objectBoundingBox"===c?b.width:1,f="objectBoundingBox"===c?b.left||0:0;else if("y1"===m||"y2"===m)k*="objectBoundingBox"===c?b.height:1,f="objectBoundingBox"===c?b.top||0:0;a[m]=g*k+f}"ellipse"===b.type&&null!==a.r2&&"objectBoundingBox"===c&&b.rx!==b.ry&&(b=b.ry/b.rx,e=" scale(1, "+b+")",a.y1&&(a.y1/=b),a.y2&&(a.y2/=
b));return e}fabric.Gradient=fabric.util.createClass({offsetX:0,offsetY:0,initialize:function(b){b||(b={});var a={};this.id=fabric.Object.__uid++;this.type=b.type||"linear";a={x1:b.coords.x1||0,y1:b.coords.y1||0,x2:b.coords.x2||0,y2:b.coords.y2||0};"radial"===this.type&&(a.r1=b.coords.r1||0,a.r2=b.coords.r2||0);this.coords=a;this.colorStops=b.colorStops.slice();b.gradientTransform&&(this.gradientTransform=b.gradientTransform);this.offsetX=b.offsetX||this.offsetX;this.offsetY=b.offsetY||this.offsetY},
addColorStop:function(b){for(var a in b){var c=new fabric.Color(b[a]);this.colorStops.push({offset:a,color:c.toRgb(),opacity:c.getAlpha()})}return this},toObject:function(){return{type:this.type,coords:this.coords,colorStops:this.colorStops,offsetX:this.offsetX,offsetY:this.offsetY}},toSVG:function(b){var a=fabric.util.object.clone(this.coords),c;this.colorStops.sort(function(c,a){return c.offset-a.offset});if(!b.group||"path-group"!==b.group.type)for(var g in a)if("x1"===g||"x2"===g||"r2"===g)a[g]+=
this.offsetX-b.width/2;else if("y1"===g||"y2"===g)a[g]+=this.offsetY-b.height/2;b='id="SVGID_'+this.id+'" gradientUnits="userSpaceOnUse"';this.gradientTransform&&(b+=' gradientTransform="matrix('+this.gradientTransform.join(" ")+')" ');"linear"===this.type?c=["<linearGradient ",b,' x1="',a.x1,'" y1="',a.y1,'" x2="',a.x2,'" y2="',a.y2,'">\n']:"radial"===this.type&&(c=["<radialGradient ",b,' cx="',a.x2,'" cy="',a.y2,'" r="',a.r2,'" fx="',a.x1,'" fy="',a.y1,'">\n']);for(a=0;a<this.colorStops.length;a++)c.push("<stop ",
'offset="',100*this.colorStops[a].offset+"%",'" style="stop-color:',this.colorStops[a].color,null!=this.colorStops[a].opacity?";stop-opacity: "+this.colorStops[a].opacity:";",'"/>\n');c.push("linear"===this.type?"</linearGradient>\n":"</radialGradient>\n");return c.join("")},toLive:function(b,a){var c,g,f=fabric.util.object.clone(this.coords);if(this.type){if(a.group&&"path-group"===a.group.type)for(g in f)if("x1"===g||"x2"===g)f[g]+=-this.offsetX+a.width/2;else if("y1"===g||"y2"===g)f[g]+=-this.offsetY+
a.height/2;if("text"===a.type||"i-text"===a.type)for(g in f)if("x1"===g||"x2"===g)f[g]-=a.width/2;else if("y1"===g||"y2"===g)f[g]-=a.height/2;"linear"===this.type?c=b.createLinearGradient(f.x1,f.y1,f.x2,f.y2):"radial"===this.type&&(c=b.createRadialGradient(f.x1,f.y1,f.r1,f.x2,f.y2,f.r2));g=0;for(f=this.colorStops.length;g<f;g++){var k=this.colorStops[g].color,e=this.colorStops[g].opacity,m=this.colorStops[g].offset;"undefined"!==typeof e&&(k=(new fabric.Color(k)).setAlpha(e).toRgba());c.addColorStop(parseFloat(m),
k)}return c}}});fabric.util.object.extend(fabric.Gradient,{fromElement:function(d,a){var c=d.getElementsByTagName("stop"),g="linearGradient"===d.nodeName?"linear":"radial",f=d.getAttribute("gradientUnits")||"objectBoundingBox",k=d.getAttribute("gradientTransform"),l=[],m={};"linear"===g?m={x1:d.getAttribute("x1")||0,y1:d.getAttribute("y1")||0,x2:d.getAttribute("x2")||"100%",y2:d.getAttribute("y2")||0}:"radial"===g&&(m={x1:d.getAttribute("fx")||d.getAttribute("cx")||"50%",y1:d.getAttribute("fy")||
d.getAttribute("cy")||"50%",r1:0,x2:d.getAttribute("cx")||"50%",y2:d.getAttribute("cy")||"50%",r2:d.getAttribute("r")||"50%"});for(var p=c.length;p--;)l.push(e(c[p]));c=b(a,m,f);g=new fabric.Gradient({type:g,coords:m,colorStops:l,offsetX:-a.left,offsetY:-a.top});if(k||""!==c)g.gradientTransform=fabric.parseTransformAttribute((k||"")+c);return g},forObject:function(d,a){a||(a={});b(d,a.coords,"userSpaceOnUse");return new fabric.Gradient(a)}})})();
fabric.Pattern=fabric.util.createClass({repeat:"repeat",offsetX:0,offsetY:0,initialize:function(e){e||(e={});this.id=fabric.Object.__uid++;if(e.source)if("string"===typeof e.source)if("undefined"!==typeof fabric.util.getFunctionBody(e.source))this.source=new Function(fabric.util.getFunctionBody(e.source));else{var b=this;this.source=fabric.util.createImage();fabric.util.loadImage(e.source,function(d){b.source=d})}else this.source=e.source;e.repeat&&(this.repeat=e.repeat);e.offsetX&&(this.offsetX=
e.offsetX);e.offsetY&&(this.offsetY=e.offsetY)},toObject:function(){var e;"function"===typeof this.source?e=String(this.source):"string"===typeof this.source.src&&(e=this.source.src);return{source:e,repeat:this.repeat,offsetX:this.offsetX,offsetY:this.offsetY}},toSVG:function(e){var b="function"===typeof this.source?this.source():this.source,d=b.width/e.getWidth(),a=b.height/e.getHeight(),c=this.offsetX/e.getWidth();e=this.offsetY/e.getHeight();var g="";if("repeat-x"===this.repeat||"no-repeat"===
this.repeat)a=1;if("repeat-y"===this.repeat||"no-repeat"===this.repeat)d=1;b.src?g=b.src:b.toDataURL&&(g=b.toDataURL());return'<pattern id="SVGID_'+this.id+'" x="'+c+'" y="'+e+'" width="'+d+'" height="'+a+'">\n<image x="0" y="0" width="'+b.width+'" height="'+b.height+'" xlink:href="'+g+'"></image>\n</pattern>\n'},toLive:function(e){var b="function"===typeof this.source?this.source():this.source;return b&&("undefined"===typeof b.src||b.complete&&0!==b.naturalWidth&&0!==b.naturalHeight)?e.createPattern(b,
this.repeat):""}});
(function(e){var b=e.fabric||(e.fabric={}),d=b.util.toFixed;b.Shadow?b.warn("fabric.Shadow is already defined."):(b.Shadow=b.util.createClass({color:"rgb(0,0,0)",blur:0,offsetX:0,offsetY:0,affectStroke:!1,includeDefaultValues:!0,initialize:function(a){"string"===typeof a&&(a=this._parseShadow(a));for(var c in a)this[c]=a[c];this.id=b.Object.__uid++},_parseShadow:function(a){a=a.trim();var c=b.Shadow.reOffsetsAndBlur.exec(a)||[];return{color:(a.replace(b.Shadow.reOffsetsAndBlur,"")||"rgb(0,0,0)").trim(),
offsetX:parseInt(c[1],10)||0,offsetY:parseInt(c[2],10)||0,blur:parseInt(c[3],10)||0}},toString:function(){return[this.offsetX,this.offsetY,this.blur,this.color].join("px ")},toSVG:function(a){var c="SourceAlpha",b=40,f=40;!a||a.fill!==this.color&&a.stroke!==this.color||(c="SourceGraphic");a.width&&a.height&&(b=100*d(Math.abs(this.offsetX/a.getWidth()),2)+20,f=100*d(Math.abs(this.offsetY/a.getHeight()),2)+20);return'<filter id="SVGID_'+this.id+'" y="-'+f+'%" height="'+(100+2*f)+'%" x="-'+b+'%" width="'+
(100+2*b)+'%" >\n\t<feGaussianBlur in="'+c+'" stdDeviation="'+d(this.blur?this.blur/2:0,3)+'" result="blurOut"></feGaussianBlur>\n\t<feColorMatrix result="matrixOut" in="blurOut" type="matrix" values="1 0 0 0 0 0 1 0 0 0 0 0 1 0 0 0 0 0 0.30 0" ></feColorMatrix >\n\t<feOffset dx="'+this.offsetX+'" dy="'+this.offsetY+'"></feOffset>\n\t<feMerge>\n\t\t<feMergeNode></feMergeNode>\n\t\t<feMergeNode in="SourceGraphic"></feMergeNode>\n\t</feMerge>\n</filter>\n'},toObject:function(){if(this.includeDefaultValues)return{color:this.color,
blur:this.blur,offsetX:this.offsetX,offsetY:this.offsetY};var a={},c=b.Shadow.prototype;this.color!==c.color&&(a.color=this.color);this.blur!==c.blur&&(a.blur=this.blur);this.offsetX!==c.offsetX&&(a.offsetX=this.offsetX);this.offsetY!==c.offsetY&&(a.offsetY=this.offsetY);return a}}),b.Shadow.reOffsetsAndBlur=/(?:\s|^)(-?\d+(?:px)?(?:\s?|$))?(-?\d+(?:px)?(?:\s?|$))?(\d+(?:px)?)?(?:\s?|$)(?:$|\s)/)})("undefined"!==typeof exports?exports:this);
(function(){if(fabric.StaticCanvas)fabric.warn("fabric.StaticCanvas is already defined.");else{var e=fabric.util.object.extend,b=fabric.util.getElementOffset,d=fabric.util.removeFromArray,a=Error("Could not initialize `canvas` element");fabric.StaticCanvas=fabric.util.createClass({initialize:function(c,a){a||(a={});this._initStatic(c,a);fabric.StaticCanvas.activeInstance=this},backgroundColor:"",backgroundImage:null,overlayColor:"",overlayImage:null,includeDefaultValues:!0,stateful:!0,renderOnAddRemove:!0,
clipTo:null,controlsAboveOverlay:!1,allowTouchScrolling:!1,imageSmoothingEnabled:!0,preserveObjectStacking:!1,viewportTransform:[1,0,0,1,0,0],onBeforeScaleRotate:function(){},_initStatic:function(c,a){this._objects=[];this._createLowerCanvas(c);this._initOptions(a);this._setImageSmoothing();a.overlayImage&&this.setOverlayImage(a.overlayImage,this.renderAll.bind(this));a.backgroundImage&&this.setBackgroundImage(a.backgroundImage,this.renderAll.bind(this));a.backgroundColor&&this.setBackgroundColor(a.backgroundColor,
this.renderAll.bind(this));a.overlayColor&&this.setOverlayColor(a.overlayColor,this.renderAll.bind(this));this.calcOffset()},calcOffset:function(){this._offset=b(this.lowerCanvasEl);return this},setOverlayImage:function(c,a,f){return this.__setBgOverlayImage("overlayImage",c,a,f)},setBackgroundImage:function(c,a,f){return this.__setBgOverlayImage("backgroundImage",c,a,f)},setOverlayColor:function(c,a){return this.__setBgOverlayColor("overlayColor",c,a)},setBackgroundColor:function(c,a){return this.__setBgOverlayColor("backgroundColor",
c,a)},_setImageSmoothing:function(){var c=this.getContext();c.imageSmoothingEnabled=this.imageSmoothingEnabled;c.webkitImageSmoothingEnabled=this.imageSmoothingEnabled;c.mozImageSmoothingEnabled=this.imageSmoothingEnabled;c.msImageSmoothingEnabled=this.imageSmoothingEnabled;c.oImageSmoothingEnabled=this.imageSmoothingEnabled},__setBgOverlayImage:function(c,a,f,b){"string"===typeof a?fabric.util.loadImage(a,function(a){this[c]=new fabric.Image(a,b);f&&f()},this,b&&b.crossOrigin):(b&&a.setOptions(b),
this[c]=a,f&&f());return this},__setBgOverlayColor:function(c,a,f){if(a&&a.source){var b=this;fabric.util.loadImage(a.source,function(d){b[c]=new fabric.Pattern({source:d,repeat:a.repeat,offsetX:a.offsetX,offsetY:a.offsetY});f&&f()})}else this[c]=a,f&&f();return this},_createCanvasElement:function(){var c=fabric.document.createElement("canvas");c.style||(c.style={});if(!c)throw a;this._initCanvasElement(c);return c},_initCanvasElement:function(c){fabric.util.createCanvasElement(c);if("undefined"===
typeof c.getContext)throw a;},_initOptions:function(a){for(var b in a)this[b]=a[b];this.width=this.width||parseInt(this.lowerCanvasEl.width,10)||0;this.height=this.height||parseInt(this.lowerCanvasEl.height,10)||0;this.lowerCanvasEl.style&&(this.lowerCanvasEl.width=this.width,this.lowerCanvasEl.height=this.height,this.lowerCanvasEl.style.width=this.width+"px",this.lowerCanvasEl.style.height=this.height+"px",this.viewportTransform=this.viewportTransform.slice())},_createLowerCanvas:function(a){this.lowerCanvasEl=
fabric.util.getById(a)||this._createCanvasElement();this._initCanvasElement(this.lowerCanvasEl);fabric.util.addClass(this.lowerCanvasEl,"lower-canvas");this.interactive&&this._applyCanvasStyle(this.lowerCanvasEl);this.contextContainer=this.lowerCanvasEl.getContext("2d")},getWidth:function(){return this.width},getHeight:function(){return this.height},setWidth:function(a,b){return this.setDimensions({width:a},b)},setHeight:function(a,b){return this.setDimensions({height:a},b)},setDimensions:function(a,
b){var f;b=b||{};for(var d in a)f=a[d],b.cssOnly||(this._setBackstoreDimension(d,a[d]),f+="px"),b.backstoreOnly||this._setCssDimension(d,f);b.cssOnly||this.renderAll();this.calcOffset();return this},_setBackstoreDimension:function(a,b){this.lowerCanvasEl[a]=b;this.upperCanvasEl&&(this.upperCanvasEl[a]=b);this.cacheCanvasEl&&(this.cacheCanvasEl[a]=b);this[a]=b;return this},_setCssDimension:function(a,b){this.lowerCanvasEl.style[a]=b;this.upperCanvasEl&&(this.upperCanvasEl.style[a]=b);this.wrapperEl&&
(this.wrapperEl.style[a]=b);return this},getZoom:function(){return Math.sqrt(this.viewportTransform[0]*this.viewportTransform[3])},setViewportTransform:function(a){var b=this.getActiveGroup();this.viewportTransform=a;this.renderAll();a=0;for(var f=this._objects.length;a<f;a++)this._objects[a].setCoords();b&&b.setCoords();return this},zoomToPoint:function(a,b){var f=a;a=fabric.util.transformPoint(a,fabric.util.invertTransform(this.viewportTransform));this.viewportTransform[0]=b;this.viewportTransform[3]=
b;var d=fabric.util.transformPoint(a,this.viewportTransform);this.viewportTransform[4]+=f.x-d.x;this.viewportTransform[5]+=f.y-d.y;this.renderAll();f=0;for(d=this._objects.length;f<d;f++)this._objects[f].setCoords();return this},setZoom:function(a){this.zoomToPoint(new fabric.Point(0,0),a);return this},absolutePan:function(a){this.viewportTransform[4]=-a.x;this.viewportTransform[5]=-a.y;this.renderAll();a=0;for(var b=this._objects.length;a<b;a++)this._objects[a].setCoords();return this},relativePan:function(a){return this.absolutePan(new fabric.Point(-a.x-
this.viewportTransform[4],-a.y-this.viewportTransform[5]))},getElement:function(){return this.lowerCanvasEl},getActiveObject:function(){return null},getActiveGroup:function(){return null},_draw:function(a,b){if(b){a.save();var f=this.viewportTransform;a.transform(f[0],f[1],f[2],f[3],f[4],f[5]);this._shouldRenderObject(b)&&b.render(a);a.restore();this.controlsAboveOverlay||b._renderControls(a)}},_shouldRenderObject:function(a){return a?a!==this.getActiveGroup()||!this.preserveObjectStacking:!1},_onObjectAdded:function(a){this.stateful&&
a.setupState();a.canvas=this;a.setCoords();this.fire("object:added",{target:a});a.fire("added")},_onObjectRemoved:function(a){this.getActiveObject()===a&&(this.fire("before:selection:cleared",{target:a}),this._discardActiveObject(),this.fire("selection:cleared"));this.fire("object:removed",{target:a});a.fire("removed")},clearContext:function(a){a.clearRect(0,0,this.width,this.height);return this},getContext:function(){return this.contextContainer},clear:function(){this._objects.length=0;this.discardActiveGroup&&
this.discardActiveGroup();this.discardActiveObject&&this.discardActiveObject();this.clearContext(this.contextContainer);this.contextTop&&this.clearContext(this.contextTop);this.fire("canvas:cleared");this.renderAll();return this},renderAll:function(a){var b=this[!0===a&&this.interactive?"contextTop":"contextContainer"],f=this.getActiveGroup();this.contextTop&&this.selection&&!this._groupSelector&&this.clearContext(this.contextTop);a||this.clearContext(b);this.fire("before:render");this.clipTo&&fabric.util.clipContext(this,
b);this._renderBackground(b);this._renderObjects(b,f);this._renderActiveGroup(b,f);this.clipTo&&b.restore();this._renderOverlay(b);this.controlsAboveOverlay&&this.interactive&&this.drawControls(b);this.fire("after:render");return this},_renderObjects:function(a,b){var f,d;if(!b||this.preserveObjectStacking)for(f=0,d=this._objects.length;f<d;++f)this._draw(a,this._objects[f]);else for(f=0,d=this._objects.length;f<d;++f)this._objects[f]&&!b.contains(this._objects[f])&&this._draw(a,this._objects[f])},
_renderActiveGroup:function(a,b){if(b){var f=[];this.forEachObject(function(a){b.contains(a)&&f.push(a)});b._set("objects",f);this._draw(a,b)}},_renderBackground:function(a){this.backgroundColor&&(a.fillStyle=this.backgroundColor.toLive?this.backgroundColor.toLive(a):this.backgroundColor,a.fillRect(this.backgroundColor.offsetX||0,this.backgroundColor.offsetY||0,this.width,this.height));this.backgroundImage&&this._draw(a,this.backgroundImage)},_renderOverlay:function(a){this.overlayColor&&(a.fillStyle=
this.overlayColor.toLive?this.overlayColor.toLive(a):this.overlayColor,a.fillRect(this.overlayColor.offsetX||0,this.overlayColor.offsetY||0,this.width,this.height));this.overlayImage&&this._draw(a,this.overlayImage)},renderTop:function(){var a=this.contextTop||this.contextContainer;this.clearContext(a);this.selection&&this._groupSelector&&this._drawSelection();var b=this.getActiveGroup();b&&b.render(a);this._renderOverlay(a);this.fire("after:render");return this},getCenter:function(){return{top:this.getHeight()/
2,left:this.getWidth()/2}},centerObjectH:function(a){this._centerObject(a,new fabric.Point(this.getCenter().left,a.getCenterPoint().y));this.renderAll();return this},centerObjectV:function(a){this._centerObject(a,new fabric.Point(a.getCenterPoint().x,this.getCenter().top));this.renderAll();return this},centerObject:function(a){var b=this.getCenter();this._centerObject(a,new fabric.Point(b.left,b.top));this.renderAll();return this},_centerObject:function(a,b){a.setPositionByOrigin(b,"center","center");
return this},toDatalessJSON:function(a){return this.toDatalessObject(a)},toObject:function(a){return this._toObjectMethod("toObject",a)},toDatalessObject:function(a){return this._toObjectMethod("toDatalessObject",a)},_toObjectMethod:function(a,b){var f={objects:this._toObjects(a,b)};e(f,this.__serializeBgOverlay());fabric.util.populateWithProperties(this,f,b);return f},_toObjects:function(a,b){return this.getObjects().map(function(f){return this._toObject(f,a,b)},this)},_toObject:function(a,b,f){var d;
this.includeDefaultValues||(d=a.includeDefaultValues,a.includeDefaultValues=!1);var e=this._realizeGroupTransformOnObject(a);b=a[b](f);this.includeDefaultValues||(a.includeDefaultValues=d);this._unwindGroupTransformOnObject(a,e);return b},_realizeGroupTransformOnObject:function(a){var b="angle flipX flipY height left scaleX scaleY top width".split(" ");if(a.group&&a.group===this.getActiveGroup()){var f={};b.forEach(function(b){f[b]=a[b]});this.getActiveGroup().realizeTransform(a);return f}return null},
_unwindGroupTransformOnObject:function(a,b){b&&a.set(b)},__serializeBgOverlay:function(){var a={background:this.backgroundColor&&this.backgroundColor.toObject?this.backgroundColor.toObject():this.backgroundColor};this.overlayColor&&(a.overlay=this.overlayColor.toObject?this.overlayColor.toObject():this.overlayColor);this.backgroundImage&&(a.backgroundImage=this.backgroundImage.toObject());this.overlayImage&&(a.overlayImage=this.overlayImage.toObject());return a},svgViewportTransformation:!0,toSVG:function(a,
b){a||(a={});var f=[];this._setSVGPreamble(f,a);this._setSVGHeader(f,a);this._setSVGBgOverlayColor(f,"backgroundColor");this._setSVGBgOverlayImage(f,"backgroundImage");this._setSVGObjects(f,b);this._setSVGBgOverlayColor(f,"overlayColor");this._setSVGBgOverlayImage(f,"overlayImage");f.push("</svg>");return f.join("")},_setSVGPreamble:function(a,b){b.suppressPreamble||a.push('<?xml version="1.0" encoding="',b.encoding||"UTF-8",'" standalone="no" ?>','<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" ',
'"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">\n')},_setSVGHeader:function(a,b){var f,d,e;b.viewBox?(f=b.viewBox.width,d=b.viewBox.height):(f=this.width,d=this.height,this.svgViewportTransformation||(e=this.viewportTransform,f/=e[0],d/=e[3]));a.push("<svg ",'xmlns="http://www.w3.org/2000/svg" ','xmlns:xlink="http://www.w3.org/1999/xlink" ','version="1.1" ','width="',f,'" ','height="',d,'" ',this.backgroundColor&&!this.backgroundColor.toLive?'style="background-color: '+this.backgroundColor+'" ':
null,b.viewBox?'viewBox="'+b.viewBox.x+" "+b.viewBox.y+" "+b.viewBox.width+" "+b.viewBox.height+'" ':null,'xml:space="preserve">',"<desc>Created with Fabric.js ",fabric.version,"</desc>","<defs>",fabric.createSVGFontFacesMarkup(this.getObjects()),fabric.createSVGRefElementsMarkup(this),"</defs>")},_setSVGObjects:function(a,b){for(var f=0,d=this.getObjects(),e=d.length;f<e;f++){var m=d[f],p=this._realizeGroupTransformOnObject(m);a.push(m.toSVG(b));this._unwindGroupTransformOnObject(m,p)}},_setSVGBgOverlayImage:function(a,
b){this[b]&&this[b].toSVG&&a.push(this[b].toSVG())},_setSVGBgOverlayColor:function(a,b){this[b]&&this[b].source?a.push('<rect x="',this[b].offsetX,'" y="',this[b].offsetY,'" ','width="',"repeat-y"===this[b].repeat||"no-repeat"===this[b].repeat?this[b].source.width:this.width,'" height="',"repeat-x"===this[b].repeat||"no-repeat"===this[b].repeat?this[b].source.height:this.height,'" fill="url(#'+b+'Pattern)"',"></rect>"):this[b]&&"overlayColor"===b&&a.push('<rect x="0" y="0" ','width="',this.width,
'" height="',this.height,'" fill="',this[b],'"',"></rect>")},sendToBack:function(a){d(this._objects,a);this._objects.unshift(a);return this.renderAll&&this.renderAll()},bringToFront:function(a){d(this._objects,a);this._objects.push(a);return this.renderAll&&this.renderAll()},sendBackwards:function(a,b){var f=this._objects.indexOf(a);0!==f&&(f=this._findNewLowerIndex(a,f,b),d(this._objects,a),this._objects.splice(f,0,a),this.renderAll&&this.renderAll());return this},_findNewLowerIndex:function(a,b,
f){if(f)for(f=b,--b;0<=b;--b){if(a.intersectsWithObject(this._objects[b])||a.isContainedWithinObject(this._objects[b])||this._objects[b].isContainedWithinObject(a)){f=b;break}}else f=b-1;return f},bringForward:function(a,b){var f=this._objects.indexOf(a);f!==this._objects.length-1&&(f=this._findNewUpperIndex(a,f,b),d(this._objects,a),this._objects.splice(f,0,a),this.renderAll&&this.renderAll());return this},_findNewUpperIndex:function(a,b,f){if(f)for(f=b,b+=1;b<this._objects.length;++b){if(a.intersectsWithObject(this._objects[b])||
a.isContainedWithinObject(this._objects[b])||this._objects[b].isContainedWithinObject(a)){f=b;break}}else f=b+1;return f},moveTo:function(a,b){d(this._objects,a);this._objects.splice(b,0,a);return this.renderAll&&this.renderAll()},dispose:function(){this.clear();this.interactive&&this.removeListeners();return this},toString:function(){return"#<fabric.Canvas ("+this.complexity()+"): { objects: "+this.getObjects().length+" }>"}});e(fabric.StaticCanvas.prototype,fabric.Observable);e(fabric.StaticCanvas.prototype,
fabric.Collection);e(fabric.StaticCanvas.prototype,fabric.DataURLExporter);e(fabric.StaticCanvas,{EMPTY_JSON:'{"objects": [], "background": "white"}',supports:function(a){var b=fabric.util.createCanvasElement();if(!b||!b.getContext)return null;var f=b.getContext("2d");if(!f)return null;switch(a){case "getImageData":return"undefined"!==typeof f.getImageData;case "setLineDash":return"undefined"!==typeof f.setLineDash;case "toDataURL":return"undefined"!==typeof b.toDataURL;case "toDataURLWithQuality":try{return b.toDataURL("image/jpeg",
0),!0}catch(d){}return!1;default:return null}}});fabric.StaticCanvas.prototype.toJSON=fabric.StaticCanvas.prototype.toObject}})();
fabric.BaseBrush=fabric.util.createClass({color:"rgb(0, 0, 0)",width:1,shadow:null,strokeLineCap:"round",strokeLineJoin:"round",strokeDashArray:null,setShadow:function(e){this.shadow=new fabric.Shadow(e);return this},_setBrushStyles:function(){var e=this.canvas.contextTop;e.strokeStyle=this.color;e.lineWidth=this.width;e.lineCap=this.strokeLineCap;e.lineJoin=this.strokeLineJoin;this.strokeDashArray&&fabric.StaticCanvas.supports("setLineDash")&&e.setLineDash(this.strokeDashArray)},_setShadow:function(){if(this.shadow){var e=
this.canvas.contextTop;e.shadowColor=this.shadow.color;e.shadowBlur=this.shadow.blur;e.shadowOffsetX=this.shadow.offsetX;e.shadowOffsetY=this.shadow.offsetY}},_resetShadow:function(){var e=this.canvas.contextTop;e.shadowColor="";e.shadowBlur=e.shadowOffsetX=e.shadowOffsetY=0}});
(function(){fabric.PencilBrush=fabric.util.createClass(fabric.BaseBrush,{initialize:function(e){this.canvas=e;this._points=[]},onMouseDown:function(e){this._prepareForDrawing(e);this._captureDrawingPath(e);this._render()},onMouseMove:function(e){this._captureDrawingPath(e);this.canvas.clearContext(this.canvas.contextTop);this._render()},onMouseUp:function(){this._finalizeAndAddPath()},_prepareForDrawing:function(e){e=new fabric.Point(e.x,e.y);this._reset();this._addPoint(e);this.canvas.contextTop.moveTo(e.x,
e.y)},_addPoint:function(e){this._points.push(e)},_reset:function(){this._points.length=0;this._setBrushStyles();this._setShadow()},_captureDrawingPath:function(e){e=new fabric.Point(e.x,e.y);this._addPoint(e)},_render:function(){var e=this.canvas.contextTop,b=this.canvas.viewportTransform,d=this._points[0],a=this._points[1];e.save();e.transform(b[0],b[1],b[2],b[3],b[4],b[5]);e.beginPath();2===this._points.length&&d.x===a.x&&d.y===a.y&&(d.x-=.5,a.x+=.5);e.moveTo(d.x,d.y);for(var b=1,c=this._points.length;b<
c;b++)a=d.midPointFrom(a),e.quadraticCurveTo(d.x,d.y,a.x,a.y),d=this._points[b],a=this._points[b+1];e.lineTo(d.x,d.y);e.stroke();e.restore()},convertPointsToSVGPath:function(e){var b=[],d=new fabric.Point(e[0].x,e[0].y),a=new fabric.Point(e[1].x,e[1].y);b.push("M ",e[0].x," ",e[0].y," ");for(var c=1,g=e.length;c<g;c++){var f=d.midPointFrom(a);b.push("Q ",d.x," ",d.y," ",f.x," ",f.y," ");d=new fabric.Point(e[c].x,e[c].y);c+1<e.length&&(a=new fabric.Point(e[c+1].x,e[c+1].y))}b.push("L ",d.x," ",d.y,
" ");return b},createPath:function(e){e=new fabric.Path(e,{fill:null,stroke:this.color,strokeWidth:this.width,strokeLineCap:this.strokeLineCap,strokeLineJoin:this.strokeLineJoin,strokeDashArray:this.strokeDashArray,originX:"center",originY:"center"});this.shadow&&(this.shadow.affectStroke=!0,e.setShadow(this.shadow));return e},_finalizeAndAddPath:function(){this.canvas.contextTop.closePath();var e=this.convertPointsToSVGPath(this._points).join("");"M 0 0 Q 0 0 0 0 L 0 0"===e?this.canvas.renderAll():
(e=this.createPath(e),this.canvas.add(e),e.setCoords(),this.canvas.clearContext(this.canvas.contextTop),this._resetShadow(),this.canvas.renderAll(),this.canvas.fire("path:created",{path:e}))}})})();
fabric.CircleBrush=fabric.util.createClass(fabric.BaseBrush,{width:10,initialize:function(e){this.canvas=e;this.points=[]},drawDot:function(e){e=this.addPoint(e);var b=this.canvas.contextTop,d=this.canvas.viewportTransform;b.save();b.transform(d[0],d[1],d[2],d[3],d[4],d[5]);b.fillStyle=e.fill;b.beginPath();b.arc(e.x,e.y,e.radius,0,2*Math.PI,!1);b.closePath();b.fill();b.restore()},onMouseDown:function(e){this.points.length=0;this.canvas.clearContext(this.canvas.contextTop);this._setShadow();this.drawDot(e)},
onMouseMove:function(e){this.drawDot(e)},onMouseUp:function(){var e=this.canvas.renderOnAddRemove;this.canvas.renderOnAddRemove=!1;for(var b=[],d=0,a=this.points.length;d<a;d++){var c=this.points[d],c=new fabric.Circle({radius:c.radius,left:c.x,top:c.y,originX:"center",originY:"center",fill:c.fill});this.shadow&&c.setShadow(this.shadow);b.push(c)}b=new fabric.Group(b,{originX:"center",originY:"center"});b.canvas=this.canvas;this.canvas.add(b);this.canvas.fire("path:created",{path:b});this.canvas.clearContext(this.canvas.contextTop);
this._resetShadow();this.canvas.renderOnAddRemove=e;this.canvas.renderAll()},addPoint:function(e){e=new fabric.Point(e.x,e.y);var b=fabric.util.getRandomInt(Math.max(0,this.width-20),this.width+20)/2,d=(new fabric.Color(this.color)).setAlpha(fabric.util.getRandomInt(0,100)/100).toRgba();e.radius=b;e.fill=d;this.points.push(e);return e}});
fabric.SprayBrush=fabric.util.createClass(fabric.BaseBrush,{width:10,density:20,dotWidth:1,dotWidthVariance:1,randomOpacity:!1,optimizeOverlapping:!0,initialize:function(e){this.canvas=e;this.sprayChunks=[]},onMouseDown:function(e){this.sprayChunks.length=0;this.canvas.clearContext(this.canvas.contextTop);this._setShadow();this.addSprayChunk(e);this.render()},onMouseMove:function(e){this.addSprayChunk(e);this.render()},onMouseUp:function(){var e=this.canvas.renderOnAddRemove;this.canvas.renderOnAddRemove=
!1;for(var b=[],d=0,a=this.sprayChunks.length;d<a;d++)for(var c=this.sprayChunks[d],g=0,f=c.length;g<f;g++){var k=new fabric.Rect({width:c[g].width,height:c[g].width,left:c[g].x+1,top:c[g].y+1,originX:"center",originY:"center",fill:this.color});this.shadow&&k.setShadow(this.shadow);b.push(k)}this.optimizeOverlapping&&(b=this._getOptimizedRects(b));b=new fabric.Group(b,{originX:"center",originY:"center"});b.canvas=this.canvas;this.canvas.add(b);this.canvas.fire("path:created",{path:b});this.canvas.clearContext(this.canvas.contextTop);
this._resetShadow();this.canvas.renderOnAddRemove=e;this.canvas.renderAll()},_getOptimizedRects:function(e){for(var b={},d,a=0,c=e.length;a<c;a++)d=e[a].left+""+e[a].top,b[d]||(b[d]=e[a]);e=[];for(d in b)e.push(b[d]);return e},render:function(){var e=this.canvas.contextTop;e.fillStyle=this.color;var b=this.canvas.viewportTransform;e.save();e.transform(b[0],b[1],b[2],b[3],b[4],b[5]);for(var b=0,d=this.sprayChunkPoints.length;b<d;b++){var a=this.sprayChunkPoints[b];"undefined"!==typeof a.opacity&&(e.globalAlpha=
a.opacity);e.fillRect(a.x,a.y,a.width,a.width)}e.restore()},addSprayChunk:function(e){this.sprayChunkPoints=[];for(var b,d,a,c=this.width/2,g=0;g<this.density;g++)b=fabric.util.getRandomInt(e.x-c,e.x+c),d=fabric.util.getRandomInt(e.y-c,e.y+c),a=this.dotWidthVariance?fabric.util.getRandomInt(Math.max(1,this.dotWidth-this.dotWidthVariance),this.dotWidth+this.dotWidthVariance):this.dotWidth,b=new fabric.Point(b,d),b.width=a,this.randomOpacity&&(b.opacity=fabric.util.getRandomInt(0,100)/100),this.sprayChunkPoints.push(b);
this.sprayChunks.push(this.sprayChunkPoints)}});
fabric.PatternBrush=fabric.util.createClass(fabric.PencilBrush,{getPatternSrc:function(){var e=fabric.document.createElement("canvas"),b=e.getContext("2d");e.width=e.height=25;b.fillStyle=this.color;b.beginPath();b.arc(10,10,10,0,2*Math.PI,!1);b.closePath();b.fill();return e},getPatternSrcFunction:function(){return String(this.getPatternSrc).replace("this.color",'"'+this.color+'"')},getPattern:function(){return this.canvas.contextTop.createPattern(this.source||this.getPatternSrc(),"repeat")},_setBrushStyles:function(){this.callSuper("_setBrushStyles");
this.canvas.contextTop.strokeStyle=this.getPattern()},createPath:function(e){e=this.callSuper("createPath",e);e.stroke=new fabric.Pattern({source:this.source||this.getPatternSrcFunction()});return e}});
(function(){var e=fabric.util.getPointer,b=fabric.util.degreesToRadians,d=fabric.util.radiansToDegrees,a=Math.atan2,c=Math.abs;fabric.Canvas=fabric.util.createClass(fabric.StaticCanvas,{initialize:function(a,b){b||(b={});this._initStatic(a,b);this._initInteractive();this._createCacheCanvas();fabric.Canvas.activeInstance=this},uniScaleTransform:!1,centeredScaling:!1,centeredRotation:!1,interactive:!0,selection:!0,selectionColor:"rgba(100, 100, 255, 0.3)",selectionDashArray:[],selectionBorderColor:"rgba(255, 255, 255, 0.3)",
selectionLineWidth:1,hoverCursor:"move",moveCursor:"move",defaultCursor:"default",freeDrawingCursor:"crosshair",rotationCursor:"crosshair",containerClass:"canvas-container",perPixelTargetFind:!1,targetFindTolerance:0,skipTargetFind:!1,_initInteractive:function(){this._groupSelector=this._currentTransform=null;this._initWrapperElement();this._createUpperCanvas();this._initEventListeners();this.freeDrawingBrush=fabric.PencilBrush&&new fabric.PencilBrush(this);this.calcOffset()},_resetCurrentTransform:function(a){var b=
this._currentTransform;b.target.set({scaleX:b.original.scaleX,scaleY:b.original.scaleY,left:b.original.left,top:b.original.top});this._shouldCenterTransform(a,b.target)?"rotate"===b.action?this._setOriginToCenter(b.target):("center"!==b.originX&&(b.mouseXSign="right"===b.originX?-1:1),"center"!==b.originY&&(b.mouseYSign="bottom"===b.originY?-1:1),b.originX="center",b.originY="center"):(b.originX=b.original.originX,b.originY=b.original.originY)},containsPoint:function(a,b){var c=this.getPointer(a,
!0),d=this._normalizePointer(b,c);return b.containsPoint(d)||b._findTargetCorner(c)},_normalizePointer:function(a,b){var c=this.getActiveGroup(),d=b.x,e=b.y;c&&"group"!==a.type&&c.contains(a)&&(c=new fabric.Point(c.left,c.top),c=fabric.util.transformPoint(c,this.viewportTransform,!0),d-=c.x,e-=c.y);return{x:d,y:e}},isTargetTransparent:function(a,b,c){var d=a.hasBorders,e=a.transparentCorners;a.hasBorders=a.transparentCorners=!1;this._draw(this.contextCache,a);a.hasBorders=d;a.transparentCorners=e;
a=fabric.util.isTransparent(this.contextCache,b,c,this.targetFindTolerance);this.clearContext(this.contextCache);return a},_shouldClearSelection:function(a,b){var c=this.getActiveGroup(),d=this.getActiveObject();return!b||b&&c&&!c.contains(b)&&c!==b&&!a.shiftKey||b&&!b.evented||b&&!b.selectable&&d&&d!==b},_shouldCenterTransform:function(a,b){if(b){var c=this._currentTransform,d;"scale"===c.action||"scaleX"===c.action||"scaleY"===c.action?d=this.centeredScaling||b.centeredScaling:"rotate"===c.action&&
(d=this.centeredRotation||b.centeredRotation);return d?!a.altKey:a.altKey}},_getOriginFromCorner:function(a,b){var c={x:a.originX,y:a.originY};if("ml"===b||"tl"===b||"bl"===b)c.x="right";else if("mr"===b||"tr"===b||"br"===b)c.x="left";if("tl"===b||"mt"===b||"tr"===b)c.y="bottom";else if("bl"===b||"mb"===b||"br"===b)c.y="top";return c},_getActionFromCorner:function(a,b){var c="drag";b&&(c="ml"===b||"mr"===b?"scaleX":"mt"===b||"mb"===b?"scaleY":"mtr"===b?"rotate":"scale");return c},_setupCurrentTransform:function(a,
c){if(c){var d=this.getPointer(a),e=c._findTargetCorner(this.getPointer(a,!0)),g=this._getActionFromCorner(c,e),e=this._getOriginFromCorner(c,e);this._currentTransform={target:c,action:g,scaleX:c.scaleX,scaleY:c.scaleY,offsetX:d.x-c.left,offsetY:d.y-c.top,originX:e.x,originY:e.y,ex:d.x,ey:d.y,left:c.left,top:c.top,theta:b(c.angle),width:c.width*c.scaleX,mouseXSign:1,mouseYSign:1};this._currentTransform.original={left:c.left,top:c.top,scaleX:c.scaleX,scaleY:c.scaleY,originX:e.x,originY:e.y};this._resetCurrentTransform(a)}},
_translateObject:function(a,b){var c=this._currentTransform.target;c.get("lockMovementX")||c.set("left",a-this._currentTransform.offsetX);c.get("lockMovementY")||c.set("top",b-this._currentTransform.offsetY)},_scaleObject:function(a,b,c){var d=this._currentTransform,e=d.target,g=e.get("lockScalingX"),x=e.get("lockScalingY"),y=e.get("lockScalingFlip");if(!g||!x){var E=e.translateToOriginPoint(e.getCenterPoint(),d.originX,d.originY);a=e.toLocalPoint(new fabric.Point(a,b),d.originX,d.originY);this._setLocalMouse(a,
d);this._setObjectScale(a,d,g,x,c,y);e.setPositionByOrigin(E,d.originX,d.originY)}},_setObjectScale:function(a,b,c,d,e,g){var x=b.target,y=!1,E=!1,u=x.stroke?x.strokeWidth:0;b.newScaleX=a.x/(x.width+u/2);b.newScaleY=a.y/(x.height+u/2);g&&0>=b.newScaleX&&b.newScaleX<x.scaleX&&(y=!0);g&&0>=b.newScaleY&&b.newScaleY<x.scaleY&&(E=!0);"equally"!==e||c||d?e?"x"!==e||x.get("lockUniScaling")?"y"!==e||x.get("lockUniScaling")||E||d||x.set("scaleY",b.newScaleY):y||c||x.set("scaleX",b.newScaleX):(y||c||x.set("scaleX",
b.newScaleX),E||d||x.set("scaleY",b.newScaleY)):y||E||this._scaleObjectEqually(a,x,b);y||E||this._flipObject(b,e)},_scaleObjectEqually:function(a,b,c){a=a.y+a.x;var d=b.stroke?b.strokeWidth:0,d=(b.height+d/2)*c.original.scaleY+(b.width+d/2)*c.original.scaleX;c.newScaleX=c.original.scaleX*a/d;c.newScaleY=c.original.scaleY*a/d;b.set("scaleX",c.newScaleX);b.set("scaleY",c.newScaleY)},_flipObject:function(a,b){0>a.newScaleX&&"y"!==b&&("left"===a.originX?a.originX="right":"right"===a.originX&&(a.originX=
"left"));0>a.newScaleY&&"x"!==b&&("top"===a.originY?a.originY="bottom":"bottom"===a.originY&&(a.originY="top"))},_setLocalMouse:function(a,b){var d=b.target;"right"===b.originX?a.x*=-1:"center"===b.originX&&(a.x=2*a.x*b.mouseXSign,0>a.x&&(b.mouseXSign=-b.mouseXSign));"bottom"===b.originY?a.y*=-1:"center"===b.originY&&(a.y=2*a.y*b.mouseYSign,0>a.y&&(b.mouseYSign=-b.mouseYSign));c(a.x)>d.padding?a.x=0>a.x?a.x+d.padding:a.x-d.padding:a.x=0;c(a.y)>d.padding?a.y=0>a.y?a.y+d.padding:a.y-d.padding:a.y=0},
_rotateObject:function(b,c){var e=this._currentTransform;if(!e.target.get("lockRotation")){var g=a(e.ey-e.top,e.ex-e.left),p=a(c-e.top,b-e.left),g=d(p-g+e.theta);0>g&&(g=360+g);e.target.angle=g%360}},setCursor:function(a){this.upperCanvasEl.style.cursor=a},_resetObjectTransform:function(a){a.scaleX=1;a.scaleY=1;a.setAngle(0)},_drawSelection:function(){var a=this.contextTop,b=this._groupSelector,d=b.left,e=b.top,g=c(d),n=c(e);a.fillStyle=this.selectionColor;a.fillRect(b.ex-(0<d?0:-d),b.ey-(0<e?0:-e),
g,n);a.lineWidth=this.selectionLineWidth;a.strokeStyle=this.selectionBorderColor;1<this.selectionDashArray.length?(d=b.ex+.5-(0<d?0:g),b=b.ey+.5-(0<e?0:n),a.beginPath(),fabric.util.drawDashedLine(a,d,b,d+g,b,this.selectionDashArray),fabric.util.drawDashedLine(a,d,b+n-1,d+g,b+n-1,this.selectionDashArray),fabric.util.drawDashedLine(a,d,b,d,b+n,this.selectionDashArray),fabric.util.drawDashedLine(a,d+g-1,b,d+g-1,b+n,this.selectionDashArray),a.closePath(),a.stroke()):a.strokeRect(b.ex+.5-(0<d?0:g),b.ey+
.5-(0<e?0:n),g,n)},_isLastRenderedObject:function(a){return this.controlsAboveOverlay&&this.lastRenderedObjectWithControlsAboveOverlay&&this.lastRenderedObjectWithControlsAboveOverlay.visible&&this.containsPoint(a,this.lastRenderedObjectWithControlsAboveOverlay)&&this.lastRenderedObjectWithControlsAboveOverlay._findTargetCorner(this.getPointer(a,!0))},findTarget:function(a,b){if(!this.skipTargetFind){if(this._isLastRenderedObject(a))return this.lastRenderedObjectWithControlsAboveOverlay;var c=this.getActiveGroup();
if(c&&!b&&this.containsPoint(a,c))return c;c=this._searchPossibleTargets(a);this._fireOverOutEvents(c);return c}},_fireOverOutEvents:function(a){a?this._hoveredTarget!==a&&(this.fire("mouse:over",{target:a}),a.fire("mouseover"),this._hoveredTarget&&(this.fire("mouse:out",{target:this._hoveredTarget}),this._hoveredTarget.fire("mouseout")),this._hoveredTarget=a):this._hoveredTarget&&(this.fire("mouse:out",{target:this._hoveredTarget}),this._hoveredTarget.fire("mouseout"),this._hoveredTarget=null)},
_checkTarget:function(a,b,c){if(b&&b.visible&&b.evented&&this.containsPoint(a,b)&&(!this.perPixelTargetFind&&!b.perPixelTargetFind||b.isEditing||!this.isTargetTransparent(b,c.x,c.y)))return!0},_searchPossibleTargets:function(a){for(var b,c=this.getPointer(a,!0),d=this._objects.length;d--;)if(!this._objects[d].group&&this._checkTarget(a,this._objects[d],c)){this.relatedTarget=this._objects[d];b=this._objects[d];break}return b},getPointer:function(a,b,c){c||(c=this.upperCanvasEl);a=e(a,c);var d=c.getBoundingClientRect(),
g=d.width||0,n=d.height||0;g&&n||("top"in d&&"bottom"in d&&(n=Math.abs(d.top-d.bottom)),"right"in d&&"left"in d&&(g=Math.abs(d.right-d.left)));this.calcOffset();a.x-=this._offset.left;a.y-=this._offset.top;b||(a=fabric.util.transformPoint(a,fabric.util.invertTransform(this.viewportTransform)));0===g||0===n?c=b=1:(b=c.width/g,c=c.height/n);return{x:a.x*b,y:a.y*c}},_createUpperCanvas:function(){var a=this.lowerCanvasEl.className.replace(/\s*lower-canvas\s*/,"");this.upperCanvasEl=this._createCanvasElement();
fabric.util.addClass(this.upperCanvasEl,"upper-canvas "+a);this.wrapperEl.appendChild(this.upperCanvasEl);this._copyCanvasStyle(this.lowerCanvasEl,this.upperCanvasEl);this._applyCanvasStyle(this.upperCanvasEl);this.contextTop=this.upperCanvasEl.getContext("2d")},_createCacheCanvas:function(){this.cacheCanvasEl=this._createCanvasElement();this.cacheCanvasEl.setAttribute("width",this.width);this.cacheCanvasEl.setAttribute("height",this.height);this.contextCache=this.cacheCanvasEl.getContext("2d")},
_initWrapperElement:function(){this.wrapperEl=fabric.util.wrapElement(this.lowerCanvasEl,"div",{"class":this.containerClass});fabric.util.setStyle(this.wrapperEl,{width:this.getWidth()+"px",height:this.getHeight()+"px",position:"relative"});fabric.util.makeElementUnselectable(this.wrapperEl)},_applyCanvasStyle:function(a){var b=this.getWidth()||a.width,c=this.getHeight()||a.height;fabric.util.setStyle(a,{position:"absolute",width:b+"px",height:c+"px",left:0,top:0});a.width=b;a.height=c;fabric.util.makeElementUnselectable(a)},
_copyCanvasStyle:function(a,b){b.style.cssText=a.style.cssText},getSelectionContext:function(){return this.contextTop},getSelectionElement:function(){return this.upperCanvasEl},_setActiveObject:function(a){this._activeObject&&this._activeObject.set("active",!1);this._activeObject=a;a.set("active",!0)},setActiveObject:function(a,b){this._setActiveObject(a);this.renderAll();this.fire("object:selected",{target:a,e:b});a.fire("selected",{e:b});return this},getActiveObject:function(){return this._activeObject},
_discardActiveObject:function(){this._activeObject&&this._activeObject.set("active",!1);this._activeObject=null},discardActiveObject:function(a){this._discardActiveObject();this.renderAll();this.fire("selection:cleared",{e:a});return this},_setActiveGroup:function(a){(this._activeGroup=a)&&a.set("active",!0)},setActiveGroup:function(a,b){this._setActiveGroup(a);a&&(this.fire("object:selected",{target:a,e:b}),a.fire("selected",{e:b}));return this},getActiveGroup:function(){return this._activeGroup},
_discardActiveGroup:function(){var a=this.getActiveGroup();a&&a.destroy();this.setActiveGroup(null)},discardActiveGroup:function(a){this._discardActiveGroup();this.fire("selection:cleared",{e:a});return this},deactivateAll:function(){for(var a=this.getObjects(),b=0,c=a.length;b<c;b++)a[b].set("active",!1);this._discardActiveGroup();this._discardActiveObject();return this},deactivateAllWithDispatch:function(a){var b=this.getActiveGroup()||this.getActiveObject();b&&this.fire("before:selection:cleared",
{target:b,e:a});this.deactivateAll();b&&this.fire("selection:cleared",{e:a});return this},drawControls:function(a){var b=this.getActiveGroup();b?this._drawGroupControls(a,b):this._drawObjectsControls(a)},_drawGroupControls:function(a,b){b._renderControls(a)},_drawObjectsControls:function(a){for(var b=0,c=this._objects.length;b<c;++b)this._objects[b]&&this._objects[b].active&&(this._objects[b]._renderControls(a),this.lastRenderedObjectWithControlsAboveOverlay=this._objects[b])}});for(var g in fabric.StaticCanvas)"prototype"!==
g&&(fabric.Canvas[g]=fabric.StaticCanvas[g]);fabric.isTouchSupported&&(fabric.Canvas.prototype._setCursorFromEvent=function(){});fabric.Element=fabric.Canvas})();
(function(){var e={mt:0,tr:1,mr:2,br:3,mb:4,bl:5,ml:6,tl:7},b=fabric.util.addListener,d=fabric.util.removeListener;fabric.util.object.extend(fabric.Canvas.prototype,{cursorMap:"n-resize ne-resize e-resize se-resize s-resize sw-resize w-resize nw-resize".split(" "),_initEventListeners:function(){this._bindEvents();b(fabric.window,"resize",this._onResize);b(this.upperCanvasEl,"mousedown",this._onMouseDown);b(this.upperCanvasEl,"mousemove",this._onMouseMove);b(this.upperCanvasEl,"mousewheel",this._onMouseWheel);
b(this.upperCanvasEl,"touchstart",this._onMouseDown);b(this.upperCanvasEl,"touchmove",this._onMouseMove);"undefined"!==typeof eventjs&&"add"in eventjs&&(eventjs.add(this.upperCanvasEl,"gesture",this._onGesture),eventjs.add(this.upperCanvasEl,"drag",this._onDrag),eventjs.add(this.upperCanvasEl,"orientation",this._onOrientationChange),eventjs.add(this.upperCanvasEl,"shake",this._onShake),eventjs.add(this.upperCanvasEl,"longpress",this._onLongPress))},_bindEvents:function(){this._onMouseDown=this._onMouseDown.bind(this);
this._onMouseMove=this._onMouseMove.bind(this);this._onMouseUp=this._onMouseUp.bind(this);this._onResize=this._onResize.bind(this);this._onGesture=this._onGesture.bind(this);this._onDrag=this._onDrag.bind(this);this._onShake=this._onShake.bind(this);this._onLongPress=this._onLongPress.bind(this);this._onOrientationChange=this._onOrientationChange.bind(this);this._onMouseWheel=this._onMouseWheel.bind(this)},removeListeners:function(){d(fabric.window,"resize",this._onResize);d(this.upperCanvasEl,"mousedown",
this._onMouseDown);d(this.upperCanvasEl,"mousemove",this._onMouseMove);d(this.upperCanvasEl,"mousewheel",this._onMouseWheel);d(this.upperCanvasEl,"touchstart",this._onMouseDown);d(this.upperCanvasEl,"touchmove",this._onMouseMove);"undefined"!==typeof eventjs&&"remove"in eventjs&&(eventjs.remove(this.upperCanvasEl,"gesture",this._onGesture),eventjs.remove(this.upperCanvasEl,"drag",this._onDrag),eventjs.remove(this.upperCanvasEl,"orientation",this._onOrientationChange),eventjs.remove(this.upperCanvasEl,
"shake",this._onShake),eventjs.remove(this.upperCanvasEl,"longpress",this._onLongPress))},_onGesture:function(a,b){this.__onTransformGesture&&this.__onTransformGesture(a,b)},_onDrag:function(a,b){this.__onDrag&&this.__onDrag(a,b)},_onMouseWheel:function(a,b){this.__onMouseWheel&&this.__onMouseWheel(a,b)},_onOrientationChange:function(a,b){this.__onOrientationChange&&this.__onOrientationChange(a,b)},_onShake:function(a,b){this.__onShake&&this.__onShake(a,b)},_onLongPress:function(a,b){this.__onLongPress&&
this.__onLongPress(a,b)},_onMouseDown:function(a){this.__onMouseDown(a);b(fabric.document,"touchend",this._onMouseUp);b(fabric.document,"touchmove",this._onMouseMove);d(this.upperCanvasEl,"mousemove",this._onMouseMove);d(this.upperCanvasEl,"touchmove",this._onMouseMove);"touchstart"===a.type?d(this.upperCanvasEl,"mousedown",this._onMouseDown):(b(fabric.document,"mouseup",this._onMouseUp),b(fabric.document,"mousemove",this._onMouseMove))},_onMouseUp:function(a){this.__onMouseUp(a);d(fabric.document,
"mouseup",this._onMouseUp);d(fabric.document,"touchend",this._onMouseUp);d(fabric.document,"mousemove",this._onMouseMove);d(fabric.document,"touchmove",this._onMouseMove);b(this.upperCanvasEl,"mousemove",this._onMouseMove);b(this.upperCanvasEl,"touchmove",this._onMouseMove);if("touchend"===a.type){var c=this;setTimeout(function(){b(c.upperCanvasEl,"mousedown",c._onMouseDown)},400)}},_onMouseMove:function(a){!this.allowTouchScrolling&&a.preventDefault&&a.preventDefault();this.__onMouseMove(a)},_onResize:function(){this.calcOffset()},
_shouldRender:function(a,b){var d=this.getActiveGroup()||this.getActiveObject();return!!(a&&(a.isMoving||a!==d)||!a&&d||!a&&!d&&!this._groupSelector||b&&this._previousPointer&&this.selection&&(b.x!==this._previousPointer.x||b.y!==this._previousPointer.y))},__onMouseUp:function(a){var b;if(this.isDrawingMode&&this._isCurrentlyDrawing)this._onMouseUpInDrawingMode(a);else{this._currentTransform?(this._finalizeCurrentTransform(),b=this._currentTransform.target):b=this.findTarget(a,!0);var d=this._shouldRender(b,
this.getPointer(a));this._maybeGroupObjects(a);b&&(b.isMoving=!1);d&&this.renderAll();this._handleCursorAndEvent(a,b)}},_handleCursorAndEvent:function(a,b){this._setCursorFromEvent(a,b);var d=this;setTimeout(function(){d._setCursorFromEvent(a,b)},50);this.fire("mouse:up",{target:b,e:a});b&&b.fire("mouseup",{e:a})},_finalizeCurrentTransform:function(){var a=this._currentTransform.target;a._scaling&&(a._scaling=!1);a.setCoords();this.stateful&&a.hasStateChanged()&&(this.fire("object:modified",{target:a}),
a.fire("modified"));this._restoreOriginXY(a)},_restoreOriginXY:function(a){if(this._previousOriginX&&this._previousOriginY){var b=a.translateToOriginPoint(a.getCenterPoint(),this._previousOriginX,this._previousOriginY);a.originX=this._previousOriginX;a.originY=this._previousOriginY;a.left=b.x;a.top=b.y;this._previousOriginY=this._previousOriginX=null}},_onMouseDownInDrawingMode:function(a){this._isCurrentlyDrawing=!0;this.discardActiveObject(a).renderAll();this.clipTo&&fabric.util.clipContext(this,
this.contextTop);var b=fabric.util.invertTransform(this.viewportTransform),b=fabric.util.transformPoint(this.getPointer(a,!0),b);this.freeDrawingBrush.onMouseDown(b);this.fire("mouse:down",{e:a});b=this.findTarget(a);"undefined"!==typeof b&&b.fire("mousedown",{e:a,target:b})},_onMouseMoveInDrawingMode:function(a){if(this._isCurrentlyDrawing){var b=fabric.util.invertTransform(this.viewportTransform),b=fabric.util.transformPoint(this.getPointer(a,!0),b);this.freeDrawingBrush.onMouseMove(b)}this.setCursor(this.freeDrawingCursor);
this.fire("mouse:move",{e:a});b=this.findTarget(a);"undefined"!==typeof b&&b.fire("mousemove",{e:a,target:b})},_onMouseUpInDrawingMode:function(a){this._isCurrentlyDrawing=!1;this.clipTo&&this.contextTop.restore();this.freeDrawingBrush.onMouseUp();this.fire("mouse:up",{e:a});var b=this.findTarget(a);"undefined"!==typeof b&&b.fire("mouseup",{e:a,target:b})},__onMouseDown:function(a){if(("which"in a?1===a.which:1===a.button)||fabric.isTouchSupported)if(this.isDrawingMode)this._onMouseDownInDrawingMode(a);
else if(!this._currentTransform){var b=this.findTarget(a),d=this.getPointer(a,!0);this._previousPointer=d;var f=this._shouldRender(b,d),e=this._shouldGroup(a,b);this._shouldClearSelection(a,b)?this._clearSelection(a,b,d):e&&(this._handleGrouping(a,b),b=this.getActiveGroup());b&&b.selectable&&!e&&(this._beforeTransform(a,b),this._setupCurrentTransform(a,b));f&&this.renderAll();this.fire("mouse:down",{target:b,e:a});b&&b.fire("mousedown",{e:a})}},_beforeTransform:function(a,b){this.stateful&&b.saveState();
if(b._findTargetCorner(this.getPointer(a)))this.onBeforeScaleRotate(b);b!==this.getActiveGroup()&&b!==this.getActiveObject()&&(this.deactivateAll(),this.setActiveObject(b,a))},_clearSelection:function(a,b,d){this.deactivateAllWithDispatch(a);b&&b.selectable?this.setActiveObject(b,a):this.selection&&(this._groupSelector={ex:d.x,ey:d.y,top:0,left:0})},_setOriginToCenter:function(a){this._previousOriginX=this._currentTransform.target.originX;this._previousOriginY=this._currentTransform.target.originY;
var b=a.getCenterPoint();a.originX="center";a.originY="center";a.left=b.x;a.top=b.y;this._currentTransform.left=a.left;this._currentTransform.top=a.top},_setCenterToOrigin:function(a){var b=a.translateToOriginPoint(a.getCenterPoint(),this._previousOriginX,this._previousOriginY);a.originX=this._previousOriginX;a.originY=this._previousOriginY;a.left=b.x;a.top=b.y;this._previousOriginY=this._previousOriginX=null},__onMouseMove:function(a){var b,d;if(this.isDrawingMode)this._onMouseMoveInDrawingMode(a);
else if(!("undefined"!==typeof a.touches&&1<a.touches.length)){var f=this._groupSelector;f?(d=this.getPointer(a,!0),f.left=d.x-f.ex,f.top=d.y-f.ey,this.renderTop()):this._currentTransform?this._transformObject(a):(b=this.findTarget(a),!b||b&&!b.selectable?this.setCursor(this.defaultCursor):this._setCursorFromEvent(a,b));this.fire("mouse:move",{target:b,e:a});b&&b.fire("mousemove",{e:a})}},_transformObject:function(a){var b=this.getPointer(a),d=this._currentTransform;d.reset=!1;d.target.isMoving=!0;
this._beforeScaleTransform(a,d);this._performTransformAction(a,d,b);this.renderAll()},_performTransformAction:function(a,b,d){var f=d.x;d=d.y;var e=b.target,l=b.action;"rotate"===l?(this._rotateObject(f,d),this._fire("rotating",e,a)):"scale"===l?(this._onScale(a,b,f,d),this._fire("scaling",e,a)):"scaleX"===l?(this._scaleObject(f,d,"x"),this._fire("scaling",e,a)):"scaleY"===l?(this._scaleObject(f,d,"y"),this._fire("scaling",e,a)):(this._translateObject(f,d),this._fire("moving",e,a),this.setCursor(this.moveCursor))},
_fire:function(a,b,d){this.fire("object:"+a,{target:b,e:d});b.fire(a,{e:d})},_beforeScaleTransform:function(a,b){if("scale"===b.action||"scaleX"===b.action||"scaleY"===b.action){var d=this._shouldCenterTransform(a,b.target);if(d&&("center"!==b.originX||"center"!==b.originY)||!d&&"center"===b.originX&&"center"===b.originY)this._resetCurrentTransform(a),b.reset=!0}},_onScale:function(a,b,d,f){!a.shiftKey&&!this.uniScaleTransform||b.target.get("lockUniScaling")?(b.reset||"scale"!==b.currentAction||this._resetCurrentTransform(a,
b.target),b.currentAction="scaleEqually",this._scaleObject(d,f,"equally")):(b.currentAction="scale",this._scaleObject(d,f))},_setCursorFromEvent:function(a,b){if(b&&b.selectable){var d=this.getActiveGroup();(d=b._findTargetCorner&&(!d||!d.contains(b))&&b._findTargetCorner(this.getPointer(a,!0)))?this._setCornerCursor(d,b):this.setCursor(b.hoverCursor||this.hoverCursor)}else return this.setCursor(this.defaultCursor),!1;return!0},_setCornerCursor:function(a,b){if(a in e)this.setCursor(this._getRotatedCornerCursor(a,
b));else if("mtr"===a&&b.hasRotatingPoint)this.setCursor(this.rotationCursor);else return this.setCursor(this.defaultCursor),!1},_getRotatedCornerCursor:function(a,b){var d=Math.round(b.getAngle()%360/45);0>d&&(d+=8);d+=e[a];return this.cursorMap[d%8]}})})();
(function(){var e=Math.min,b=Math.max;fabric.util.object.extend(fabric.Canvas.prototype,{_shouldGroup:function(b,a){var c=this.getActiveObject();return b.shiftKey&&(this.getActiveGroup()||c&&c!==a)&&this.selection},_handleGrouping:function(b,a){if(a===this.getActiveGroup()&&(a=this.findTarget(b,!0),!a||a.isType("group")))return;this.getActiveGroup()?this._updateActiveGroup(a,b):this._createActiveGroup(a,b);this._activeGroup&&this._activeGroup.saveCoords()},_updateActiveGroup:function(b,a){var c=this.getActiveGroup();
if(c.contains(b)){if(c.removeWithUpdate(b),this._resetObjectTransform(c),b.set("active",!1),1===c.size()){this.discardActiveGroup(a);this.setActiveObject(c.item(0));return}}else c.addWithUpdate(b),this._resetObjectTransform(c);this.fire("selection:created",{target:c,e:a});c.set("active",!0)},_createActiveGroup:function(b,a){if(this._activeObject&&b!==this._activeObject){var c=this._createGroup(b);c.addWithUpdate();this.setActiveGroup(c);this._activeObject=null;this.fire("selection:created",{target:c,
e:a})}b.set("active",!0)},_createGroup:function(b){var a=this.getObjects();b=a.indexOf(this._activeObject)<a.indexOf(b)?[this._activeObject,b]:[b,this._activeObject];return new fabric.Group(b,{canvas:this})},_groupSelectedObjects:function(b){var a=this._collectObjects();1===a.length?this.setActiveObject(a[0],b):1<a.length&&(a=new fabric.Group(a.reverse(),{canvas:this}),a.addWithUpdate(),this.setActiveGroup(a,b),a.saveCoords(),this.fire("selection:created",{target:a}),this.renderAll())},_collectObjects:function(){var d=
[],a;a=this._groupSelector.ex;for(var c=this._groupSelector.ey,g=a+this._groupSelector.left,f=c+this._groupSelector.top,k=new fabric.Point(e(a,g),e(c,f)),l=new fabric.Point(b(a,g),b(c,f)),c=a===g&&c===f,g=this._objects.length;g--&&!((a=this._objects[g])&&a.selectable&&a.visible&&(a.intersectsWithRect(k,l)||a.isContainedWithinRect(k,l)||a.containsPoint(k)||a.containsPoint(l))&&(a.set("active",!0),d.push(a),c)););return d},_maybeGroupObjects:function(b){this.selection&&this._groupSelector&&this._groupSelectedObjects(b);
if(b=this.getActiveGroup())b.setObjectsCoords().setCoords(),b.isMoving=!1,this.setCursor(this.defaultCursor);this._currentTransform=this._groupSelector=null}})})();
fabric.util.object.extend(fabric.StaticCanvas.prototype,{toDataURL:function(e){e||(e={});var b=e.format||"png",d=e.quality||1,a=e.multiplier||1;e={left:e.left,top:e.top,width:e.width,height:e.height};return 1!==a?this.__toDataURLWithMultiplier(b,d,e,a):this.__toDataURL(b,d,e)},__toDataURL:function(e,b,d){this.renderAll(!0);var a=this.upperCanvasEl||this.lowerCanvasEl;d=this.__getCroppedCanvas(a,d);"jpg"===e&&(e="jpeg");e=fabric.StaticCanvas.supports("toDataURLWithQuality")?(d||a).toDataURL("image/"+
e,b):(d||a).toDataURL("image/"+e);this.contextTop&&this.clearContext(this.contextTop);this.renderAll();return e},__getCroppedCanvas:function(e,b){var d,a;if("left"in b||"top"in b||"width"in b||"height"in b)d=fabric.util.createCanvasElement(),a=d.getContext("2d"),d.width=b.width||this.width,d.height=b.height||this.height,a.drawImage(e,-b.left||0,-b.top||0);return d},__toDataURLWithMultiplier:function(e,b,d,a){var c=this.getWidth(),g=this.getHeight(),f=c*a,k=g*a,l=this.getActiveObject(),m=this.getActiveGroup(),
p=this.contextTop||this.contextContainer;1<a&&this.setWidth(f).setHeight(k);p.scale(a,a);d.left&&(d.left*=a);d.top&&(d.top*=a);d.width?d.width*=a:1>a&&(d.width=f);d.height?d.height*=a:1>a&&(d.height=k);m?this._tempRemoveBordersControlsFromGroup(m):l&&this.deactivateAll&&this.deactivateAll();this.renderAll(!0);e=this.__toDataURL(e,b,d);this.width=c;this.height=g;p.scale(1/a,1/a);this.setWidth(c).setHeight(g);m?this._restoreBordersControlsOnGroup(m):l&&this.setActiveObject&&this.setActiveObject(l);
this.contextTop&&this.clearContext(this.contextTop);this.renderAll();return e},toDataURLWithMultiplier:function(e,b,d){return this.toDataURL({format:e,multiplier:b,quality:d})},_tempRemoveBordersControlsFromGroup:function(e){e.origHasControls=e.hasControls;e.origBorderColor=e.borderColor;e.hasControls=!0;e.borderColor="rgba(0,0,0,0)";e.forEachObject(function(b){b.origBorderColor=b.borderColor;b.borderColor="rgba(0,0,0,0)"})},_restoreBordersControlsOnGroup:function(e){e.hideControls=e.origHideControls;
e.borderColor=e.origBorderColor;e.forEachObject(function(b){b.borderColor=b.origBorderColor;delete b.origBorderColor})}});
fabric.util.object.extend(fabric.StaticCanvas.prototype,{loadFromDatalessJSON:function(e,b,d){return this.loadFromJSON(e,b,d)},loadFromJSON:function(e,b,d){if(e){var a="string"===typeof e?JSON.parse(e):e;this.clear();var c=this;this._enlivenObjects(a.objects,function(){c._setBgOverlay(a,b)},d);return this}},_setBgOverlay:function(e,b){var d=this,a={backgroundColor:!1,overlayColor:!1,backgroundImage:!1,overlayImage:!1};if(e.backgroundImage||e.overlayImage||e.background||e.overlay){var c=function(){a.backgroundImage&&
a.overlayImage&&a.backgroundColor&&a.overlayColor&&(d.renderAll(),b&&b())};this.__setBgOverlay("backgroundImage",e.backgroundImage,a,c);this.__setBgOverlay("overlayImage",e.overlayImage,a,c);this.__setBgOverlay("backgroundColor",e.background,a,c);this.__setBgOverlay("overlayColor",e.overlay,a,c);c()}else b&&b()},__setBgOverlay:function(e,b,d,a){var c=this;if(b)if("backgroundImage"===e||"overlayImage"===e)fabric.Image.fromObject(b,function(b){c[e]=b;d[e]=!0;a&&a()});else this["set"+fabric.util.string.capitalize(e,
!0)](b,function(){d[e]=!0;a&&a()});else d[e]=!0},_enlivenObjects:function(e,b,d){var a=this;if(e&&0!==e.length){var c=this.renderOnAddRemove;this.renderOnAddRemove=!1;fabric.util.enlivenObjects(e,function(d){d.forEach(function(b,c){a.insertAt(b,c,!0)});a.renderOnAddRemove=c;b&&b()},null,d)}else b&&b()},_toDataURL:function(e,b){this.clone(function(d){b(d.toDataURL(e))})},_toDataURLWithMultiplier:function(e,b,d){this.clone(function(a){d(a.toDataURLWithMultiplier(e,b))})},clone:function(e,b){var d=JSON.stringify(this.toJSON(b));
this.cloneWithoutData(function(a){a.loadFromJSON(d,function(){e&&e(a)})})},cloneWithoutData:function(e){var b=fabric.document.createElement("canvas");b.width=this.getWidth();b.height=this.getHeight();var d=new fabric.Canvas(b);d.clipTo=this.clipTo;this.backgroundImage?(d.setBackgroundImage(this.backgroundImage.src,function(){d.renderAll();e&&e(d)}),d.backgroundImageOpacity=this.backgroundImageOpacity,d.backgroundImageStretch=this.backgroundImageStretch):e&&e(d)}});
(function(e){var b=e.fabric||(e.fabric={});e=b.util.object.extend;var d=b.util.toFixed,a=b.util.string.capitalize,c=b.util.degreesToRadians,g=b.StaticCanvas.supports("setLineDash");b.Object||(b.Object=b.util.createClass({type:"object",originX:"left",originY:"top",top:0,left:0,width:0,height:0,scaleX:1,scaleY:1,flipX:!1,flipY:!1,opacity:1,angle:0,cornerSize:12,transparentCorners:!0,hoverCursor:null,padding:0,borderColor:"rgba(102,153,255,0.75)",cornerColor:"rgba(102,153,255,0.5)",centeredScaling:!1,
centeredRotation:!0,fill:"rgb(0,0,0)",fillRule:"nonzero",globalCompositeOperation:"source-over",backgroundColor:"",stroke:null,strokeWidth:1,strokeDashArray:null,strokeLineCap:"butt",strokeLineJoin:"miter",strokeMiterLimit:10,shadow:null,borderOpacityWhenMoving:.4,borderScaleFactor:1,transformMatrix:null,minScaleLimit:.01,selectable:!0,evented:!0,visible:!0,hasControls:!0,hasBorders:!0,hasRotatingPoint:!0,rotatingPointOffset:40,perPixelTargetFind:!1,includeDefaultValues:!0,clipTo:null,lockMovementX:!1,
lockMovementY:!1,lockRotation:!1,lockScalingX:!1,lockScalingY:!1,lockUniScaling:!1,lockScalingFlip:!1,stateProperties:"top left width height scaleX scaleY flipX flipY originX originY transformMatrix stroke strokeWidth strokeDashArray strokeLineCap strokeLineJoin strokeMiterLimit angle opacity fill fillRule globalCompositeOperation shadow clipTo visible backgroundColor".split(" "),initialize:function(a){a&&this.setOptions(a)},_initGradient:function(a){!a.fill||!a.fill.colorStops||a.fill instanceof
b.Gradient||this.set("fill",new b.Gradient(a.fill))},_initPattern:function(a){!a.fill||!a.fill.source||a.fill instanceof b.Pattern||this.set("fill",new b.Pattern(a.fill));!a.stroke||!a.stroke.source||a.stroke instanceof b.Pattern||this.set("stroke",new b.Pattern(a.stroke))},_initClipping:function(a){a.clipTo&&"string"===typeof a.clipTo&&(a=b.util.getFunctionBody(a.clipTo),"undefined"!==typeof a&&(this.clipTo=new Function("ctx",a)))},setOptions:function(a){for(var b in a)this.set(b,a[b]);this._initGradient(a);
this._initPattern(a);this._initClipping(a)},transform:function(a,b){var d=b?this._getLeftTopCoords():this.getCenterPoint();a.translate(d.x,d.y);a.rotate(c(this.angle));a.scale(this.scaleX*(this.flipX?-1:1),this.scaleY*(this.flipY?-1:1))},toObject:function(a){var c=b.Object.NUM_FRACTION_DIGITS,c={type:this.type,originX:this.originX,originY:this.originY,left:d(this.left,c),top:d(this.top,c),width:d(this.width,c),height:d(this.height,c),fill:this.fill&&this.fill.toObject?this.fill.toObject():this.fill,
stroke:this.stroke&&this.stroke.toObject?this.stroke.toObject():this.stroke,strokeWidth:d(this.strokeWidth,c),strokeDashArray:this.strokeDashArray,strokeLineCap:this.strokeLineCap,strokeLineJoin:this.strokeLineJoin,strokeMiterLimit:d(this.strokeMiterLimit,c),scaleX:d(this.scaleX,c),scaleY:d(this.scaleY,c),angle:d(this.getAngle(),c),flipX:this.flipX,flipY:this.flipY,opacity:d(this.opacity,c),shadow:this.shadow&&this.shadow.toObject?this.shadow.toObject():this.shadow,visible:this.visible,clipTo:this.clipTo&&
String(this.clipTo),backgroundColor:this.backgroundColor,fillRule:this.fillRule,globalCompositeOperation:this.globalCompositeOperation};this.includeDefaultValues||(c=this._removeDefaultValues(c));b.util.populateWithProperties(this,c,a);return c},toDatalessObject:function(a){return this.toObject(a)},_removeDefaultValues:function(a){var c=b.util.getKlass(a.type).prototype;c.stateProperties.forEach(function(b){a[b]===c[b]&&delete a[b]});return a},toString:function(){return"#<fabric."+a(this.type)+">"},
get:function(a){return this[a]},_setObject:function(a){for(var b in a)this._set(b,a[b])},set:function(a,b){"object"===typeof a?this._setObject(a):"function"===typeof b&&"clipTo"!==a?this._set(a,b(this.get(a))):this._set(a,b);return this},_set:function(a,c){if("scaleX"===a||"scaleY"===a)c=this._constrainScale(c);"scaleX"===a&&0>c?(this.flipX=!this.flipX,c*=-1):"scaleY"===a&&0>c?(this.flipY=!this.flipY,c*=-1):"width"===a||"height"===a?this.minScaleLimit=d(Math.min(.1,1/Math.max(this.width,this.height)),
2):"shadow"!==a||!c||c instanceof b.Shadow||(c=new b.Shadow(c));this[a]=c;return this},toggle:function(a){var b=this.get(a);"boolean"===typeof b&&this.set(a,!b);return this},setSourcePath:function(a){this.sourcePath=a;return this},getViewportTransform:function(){return this.canvas&&this.canvas.viewportTransform?this.canvas.viewportTransform:[1,0,0,1,0,0]},render:function(a,c){0===this.width&&0===this.height||!this.visible||(a.save(),this._setupCompositeOperation(a),c||this.transform(a),this._setStrokeStyles(a),
this._setFillStyles(a),this.transformMatrix&&a.transform.apply(a,this.transformMatrix),this._setOpacity(a),this._setShadow(a),this.clipTo&&b.util.clipContext(this,a),this._render(a,c),this.clipTo&&a.restore(),this._removeShadow(a),this._restoreCompositeOperation(a),a.restore())},_setOpacity:function(a){this.group&&this.group._setOpacity(a);a.globalAlpha*=this.opacity},_setStrokeStyles:function(a){this.stroke&&(a.lineWidth=this.strokeWidth,a.lineCap=this.strokeLineCap,a.lineJoin=this.strokeLineJoin,
a.miterLimit=this.strokeMiterLimit,a.strokeStyle=this.stroke.toLive?this.stroke.toLive(a,this):this.stroke)},_setFillStyles:function(a){this.fill&&(a.fillStyle=this.fill.toLive?this.fill.toLive(a,this):this.fill)},_renderControls:function(a,d){if(this.active&&!d){var e=this.getViewportTransform();a.save();var g;this.group&&(g=b.util.transformPoint(this.group.getCenterPoint(),e),a.translate(g.x,g.y),a.rotate(c(this.group.angle)));g=b.util.transformPoint(this.getCenterPoint(),e,null!=this.group);this.group&&
(g.x*=this.group.scaleX,g.y*=this.group.scaleY);a.translate(g.x,g.y);a.rotate(c(this.angle));this.drawBorders(a);this.drawControls(a);a.restore()}},_setShadow:function(a){if(this.shadow){var b=this.canvas&&this.canvas.viewportTransform[0]||1,c=this.canvas&&this.canvas.viewportTransform[3]||1;a.shadowColor=this.shadow.color;a.shadowBlur=this.shadow.blur*(b+c)*(this.scaleX+this.scaleY)/4;a.shadowOffsetX=this.shadow.offsetX*b*this.scaleX;a.shadowOffsetY=this.shadow.offsetY*c*this.scaleY}},_removeShadow:function(a){this.shadow&&
(a.shadowColor="",a.shadowBlur=a.shadowOffsetX=a.shadowOffsetY=0)},_renderFill:function(a){this.fill&&(a.save(),this.fill.gradientTransform&&a.transform.apply(a,this.fill.gradientTransform),this.fill.toLive&&a.translate(-this.width/2+this.fill.offsetX||0,-this.height/2+this.fill.offsetY||0),"evenodd"===this.fillRule?a.fill("evenodd"):a.fill(),a.restore(),this.shadow&&!this.shadow.affectStroke&&this._removeShadow(a))},_renderStroke:function(a){this.stroke&&0!==this.strokeWidth&&(a.save(),this.strokeDashArray?
(1&this.strokeDashArray.length&&this.strokeDashArray.push.apply(this.strokeDashArray,this.strokeDashArray),g?(a.setLineDash(this.strokeDashArray),this._stroke&&this._stroke(a)):this._renderDashedStroke&&this._renderDashedStroke(a),a.stroke()):(this.stroke.gradientTransform&&a.transform.apply(a,this.stroke.gradientTransform),this._stroke?this._stroke(a):a.stroke()),this._removeShadow(a),a.restore())},clone:function(a,c){return this.constructor.fromObject?this.constructor.fromObject(this.toObject(c),
a):new b.Object(this.toObject(c))},cloneAsImage:function(a){var c=this.toDataURL();b.util.loadImage(c,function(c){a&&a(new b.Image(c))});return this},toDataURL:function(a){a||(a={});var c=b.util.createCanvasElement(),d=this.getBoundingRect();c.width=d.width;c.height=d.height;b.util.wrapElement(c,"div");d=new b.StaticCanvas(c);"jpg"===a.format&&(a.format="jpeg");"jpeg"===a.format&&(d.backgroundColor="#fff");var e={active:this.get("active"),left:this.getLeft(),top:this.getTop()};this.set("active",!1);
this.setPositionByOrigin(new b.Point(c.width/2,c.height/2),"center","center");c=this.canvas;d.add(this);a=d.toDataURL(a);this.set(e).setCoords();this.canvas=c;d.dispose();return a},isType:function(a){return this.type===a},complexity:function(){return 0},toJSON:function(a){return this.toObject(a)},setGradient:function(a,c){c||(c={});var d={colorStops:[]};d.type=c.type||(c.r1||c.r2?"radial":"linear");d.coords={x1:c.x1,y1:c.y1,x2:c.x2,y2:c.y2};if(c.r1||c.r2)d.coords.r1=c.r1,d.coords.r2=c.r2;for(var e in c.colorStops){var g=
new b.Color(c.colorStops[e]);d.colorStops.push({offset:e,color:g.toRgb(),opacity:g.getAlpha()})}return this.set(a,b.Gradient.forObject(this,d))},setPatternFill:function(a){return this.set("fill",new b.Pattern(a))},setShadow:function(a){return this.set("shadow",a?new b.Shadow(a):null)},setColor:function(a){this.set("fill",a);return this},setAngle:function(a){var b=("center"!==this.originX||"center"!==this.originY)&&this.centeredRotation;b&&this._setOriginToCenter();this.set("angle",a);b&&this._resetOrigin();
return this},centerH:function(){this.canvas.centerObjectH(this);return this},centerV:function(){this.canvas.centerObjectV(this);return this},center:function(){this.canvas.centerObject(this);return this},remove:function(){this.canvas.remove(this);return this},getLocalPointer:function(a,b){b=b||this.canvas.getPointer(a);var c=this.translateToOriginPoint(this.getCenterPoint(),"left","top");return{x:b.x-c.x,y:b.y-c.y}},_setupCompositeOperation:function(a){this.globalCompositeOperation&&(this._prevGlobalCompositeOperation=
a.globalCompositeOperation,a.globalCompositeOperation=this.globalCompositeOperation)},_restoreCompositeOperation:function(a){this.globalCompositeOperation&&this._prevGlobalCompositeOperation&&(a.globalCompositeOperation=this._prevGlobalCompositeOperation)}}),b.util.createAccessors(b.Object),b.Object.prototype.rotate=b.Object.prototype.setAngle,e(b.Object.prototype,b.Observable),b.Object.NUM_FRACTION_DIGITS=2,b.Object.__uid=0)})("undefined"!==typeof exports?exports:this);
(function(){var e=fabric.util.degreesToRadians;fabric.util.object.extend(fabric.Object.prototype,{translateToCenterPoint:function(b,d,a){var c=b.x,g=b.y,f=this.stroke?this.strokeWidth:0;"left"===d?c=b.x+(this.getWidth()+f*this.scaleX)/2:"right"===d&&(c=b.x-(this.getWidth()+f*this.scaleX)/2);"top"===a?g=b.y+(this.getHeight()+f*this.scaleY)/2:"bottom"===a&&(g=b.y-(this.getHeight()+f*this.scaleY)/2);return fabric.util.rotatePoint(new fabric.Point(c,g),b,e(this.angle))},translateToOriginPoint:function(b,
d,a){var c=b.x,g=b.y,f=this.stroke?this.strokeWidth:0;"left"===d?c=b.x-(this.getWidth()+f*this.scaleX)/2:"right"===d&&(c=b.x+(this.getWidth()+f*this.scaleX)/2);"top"===a?g=b.y-(this.getHeight()+f*this.scaleY)/2:"bottom"===a&&(g=b.y+(this.getHeight()+f*this.scaleY)/2);return fabric.util.rotatePoint(new fabric.Point(c,g),b,e(this.angle))},getCenterPoint:function(){var b=new fabric.Point(this.left,this.top);return this.translateToCenterPoint(b,this.originX,this.originY)},getPointByOrigin:function(b,
d){var a=this.getCenterPoint();return this.translateToOriginPoint(a,b,d)},toLocalPoint:function(b,d,a){var c=this.getCenterPoint(),g=this.stroke?this.strokeWidth:0;d&&a?(d="left"===d?c.x-(this.getWidth()+g*this.scaleX)/2:"right"===d?c.x+(this.getWidth()+g*this.scaleX)/2:c.x,a="top"===a?c.y-(this.getHeight()+g*this.scaleY)/2:"bottom"===a?c.y+(this.getHeight()+g*this.scaleY)/2:c.y):(d=this.left,a=this.top);return fabric.util.rotatePoint(new fabric.Point(b.x,b.y),c,-e(this.angle)).subtractEquals(new fabric.Point(d,
a))},setPositionByOrigin:function(b,d,a){b=this.translateToCenterPoint(b,d,a);b=this.translateToOriginPoint(b,this.originX,this.originY);this.set("left",b.x);this.set("top",b.y)},adjustPosition:function(b){var d=e(this.angle),a=this.getWidth()/2,c=Math.cos(d)*a,a=Math.sin(d)*a,g=this.getWidth(),f=Math.cos(d)*g,d=Math.sin(d)*g;"center"===this.originX&&"left"===b||"right"===this.originX&&"center"===b?(this.left-=c,this.top-=a):"left"===this.originX&&"center"===b||"center"===this.originX&&"right"===
b?(this.left+=c,this.top+=a):"left"===this.originX&&"right"===b?(this.left+=f,this.top+=d):"right"===this.originX&&"left"===b&&(this.left-=f,this.top-=d);this.setCoords();this.originX=b},_setOriginToCenter:function(){this._originalOriginX=this.originX;this._originalOriginY=this.originY;var b=this.getCenterPoint();this.originY=this.originX="center";this.left=b.x;this.top=b.y},_resetOrigin:function(){var b=this.translateToOriginPoint(this.getCenterPoint(),this._originalOriginX,this._originalOriginY);
this.originX=this._originalOriginX;this.originY=this._originalOriginY;this.left=b.x;this.top=b.y;this._originalOriginY=this._originalOriginX=null},_getLeftTopCoords:function(){return this.translateToOriginPoint(this.getCenterPoint(),"left","center")}})})();
(function(){var e=fabric.util.degreesToRadians;fabric.util.object.extend(fabric.Object.prototype,{oCoords:null,intersectsWithRect:function(b,d){var a=this.oCoords,c=new fabric.Point(a.tl.x,a.tl.y),e=new fabric.Point(a.tr.x,a.tr.y),f=new fabric.Point(a.bl.x,a.bl.y),a=new fabric.Point(a.br.x,a.br.y);return"Intersection"===fabric.Intersection.intersectPolygonRectangle([c,e,a,f],b,d).status},intersectsWithObject:function(b){function d(a){return{tl:new fabric.Point(a.tl.x,a.tl.y),tr:new fabric.Point(a.tr.x,
a.tr.y),bl:new fabric.Point(a.bl.x,a.bl.y),br:new fabric.Point(a.br.x,a.br.y)}}var a=d(this.oCoords);b=d(b.oCoords);return"Intersection"===fabric.Intersection.intersectPolygonPolygon([a.tl,a.tr,a.br,a.bl],[b.tl,b.tr,b.br,b.bl]).status},isContainedWithinObject:function(b){var d=b.getBoundingRect();b=new fabric.Point(d.left,d.top);d=new fabric.Point(d.left+d.width,d.top+d.height);return this.isContainedWithinRect(b,d)},isContainedWithinRect:function(b,d){var a=this.getBoundingRect();return a.left>=
b.x&&a.left+a.width<=d.x&&a.top>=b.y&&a.top+a.height<=d.y},containsPoint:function(b){var d=this._getImageLines(this.oCoords);b=this._findCrossPoints(b,d);return 0!==b&&1===b%2},_getImageLines:function(b){return{topline:{o:b.tl,d:b.tr},rightline:{o:b.tr,d:b.br},bottomline:{o:b.br,d:b.bl},leftline:{o:b.bl,d:b.tl}}},_findCrossPoints:function(b,d){var a,c,e,f=0,k;for(k in d)if(e=d[k],!(e.o.y<b.y&&e.d.y<b.y||e.o.y>=b.y&&e.d.y>=b.y)&&(e.o.x===e.d.x&&e.o.x>=b.x?a=e.o.x:(a=(e.d.y-e.o.y)/(e.d.x-e.o.x),c=b.y-
0*b.x,e=e.o.y-a*e.o.x,a=-(c-e)/(0-a)),a>=b.x&&(f+=1),2===f))break;return f},getBoundingRectWidth:function(){return this.getBoundingRect().width},getBoundingRectHeight:function(){return this.getBoundingRect().height},getBoundingRect:function(){this.oCoords||this.setCoords();var b=[this.oCoords.tl.x,this.oCoords.tr.x,this.oCoords.br.x,this.oCoords.bl.x],d=fabric.util.array.min(b),b=fabric.util.array.max(b),b=Math.abs(d-b),a=[this.oCoords.tl.y,this.oCoords.tr.y,this.oCoords.br.y,this.oCoords.bl.y],c=
fabric.util.array.min(a),a=fabric.util.array.max(a);return{left:d,top:c,width:b,height:Math.abs(c-a)}},getWidth:function(){return this.width*this.scaleX},getHeight:function(){return this.height*this.scaleY},_constrainScale:function(b){return Math.abs(b)<this.minScaleLimit?0>b?-this.minScaleLimit:this.minScaleLimit:b},scale:function(b){b=this._constrainScale(b);0>b&&(this.flipX=!this.flipX,this.flipY=!this.flipY,b*=-1);this.scaleY=this.scaleX=b;this.setCoords();return this},scaleToWidth:function(b){var d=
this.getBoundingRectWidth()/this.getWidth();return this.scale(b/this.width/d)},scaleToHeight:function(b){var d=this.getBoundingRectHeight()/this.getHeight();return this.scale(b/this.height/d)},setCoords:function(){var b=e(this.angle),d=this.getViewportTransform(),a=function(a){return fabric.util.transformPoint(a,d)},c=this._calculateCurrentDimensions(!1),g=c.x,f=c.y;0>g&&(g=Math.abs(g));var c=Math.sqrt(Math.pow(g/2,2)+Math.pow(f/2,2)),k=Math.atan(isFinite(f/g)?f/g:0),l=Math.cos(k+b)*c,k=Math.sin(k+
b)*c,c=Math.sin(b),b=Math.cos(b),m=this.getCenterPoint(),f=new fabric.Point(g,f),m=new fabric.Point(m.x-l,m.y-k),k=new fabric.Point(m.x+f.x*b,m.y+f.x*c),g=a(new fabric.Point(m.x-f.y*c,m.y+f.y*b)),l=a(new fabric.Point(k.x-f.y*c,k.y+f.y*b)),f=a(m),a=a(k),k=new fabric.Point((f.x+g.x)/2,(f.y+g.y)/2),m=new fabric.Point((a.x+f.x)/2,(a.y+f.y)/2),p=new fabric.Point((l.x+a.x)/2,(l.y+a.y)/2),n=new fabric.Point((l.x+g.x)/2,(l.y+g.y)/2),c=new fabric.Point(m.x+c*this.rotatingPointOffset,m.y-b*this.rotatingPointOffset);
this.oCoords={tl:f,tr:a,br:l,bl:g,ml:k,mt:m,mr:p,mb:n,mtr:c};this._setCornerCoords&&this._setCornerCoords();return this}})})();
fabric.util.object.extend(fabric.Object.prototype,{sendToBack:function(){this.group?fabric.StaticCanvas.prototype.sendToBack.call(this.group,this):this.canvas.sendToBack(this);return this},bringToFront:function(){this.group?fabric.StaticCanvas.prototype.bringToFront.call(this.group,this):this.canvas.bringToFront(this);return this},sendBackwards:function(e){this.group?fabric.StaticCanvas.prototype.sendBackwards.call(this.group,this,e):this.canvas.sendBackwards(this,e);return this},bringForward:function(e){this.group?
fabric.StaticCanvas.prototype.bringForward.call(this.group,this,e):this.canvas.bringForward(this,e);return this},moveTo:function(e){this.group?fabric.StaticCanvas.prototype.moveTo.call(this.group,this,e):this.canvas.moveTo(this,e);return this}});
fabric.util.object.extend(fabric.Object.prototype,{getSvgStyles:function(){var e=this.fill?this.fill.toLive?"url(#SVGID_"+this.fill.id+")":this.fill:"none",b=this.fillRule,d=this.stroke?this.stroke.toLive?"url(#SVGID_"+this.stroke.id+")":this.stroke:"none",a=this.strokeWidth?this.strokeWidth:"0",c=this.strokeDashArray?this.strokeDashArray.join(" "):"";return["stroke: ",d,"; stroke-width: ",a,"; stroke-dasharray: ",c,"; stroke-linecap: ",this.strokeLineCap?this.strokeLineCap:"butt","; stroke-linejoin: ",
this.strokeLineJoin?this.strokeLineJoin:"miter","; stroke-miterlimit: ",this.strokeMiterLimit?this.strokeMiterLimit:"4","; fill: ",e,"; fill-rule: ",b,"; opacity: ","undefined"!==typeof this.opacity?this.opacity:"1",";",this.shadow?"filter: url(#SVGID_"+this.shadow.id+");":"",this.visible?"":" visibility: hidden;"].join("")},getSvgTransform:function(){if(this.group&&"path-group"===this.group.type)return"";var e=fabric.util.toFixed,b=this.getAngle(),d=!this.canvas||this.canvas.svgViewportTransformation?
this.getViewportTransform():[1,0,0,1,0,0],a=fabric.util.transformPoint(this.getCenterPoint(),d),c=fabric.Object.NUM_FRACTION_DIGITS,a="path-group"===this.type?"":"translate("+e(a.x,c)+" "+e(a.y,c)+")",b=0!==b?" rotate("+e(b,c)+")":"",e=1===this.scaleX&&1===this.scaleY&&1===d[0]&&1===d[3]?"":" scale("+e(this.scaleX*d[0],c)+" "+e(this.scaleY*d[3],c)+")",c="path-group"===this.type?this.width*d[0]:0,d="path-group"===this.type?this.height*d[3]:0;return[a,b,e,this.flipX?" matrix(-1 0 0 1 "+c+" 0) ":"",
this.flipY?" matrix(1 0 0 -1 0 "+d+")":""].join("")},getSvgTransformMatrix:function(){return this.transformMatrix?" matrix("+this.transformMatrix.join(" ")+") ":""},_createBaseSVGMarkup:function(){var e=[];this.fill&&this.fill.toLive&&e.push(this.fill.toSVG(this,!1));this.stroke&&this.stroke.toLive&&e.push(this.stroke.toSVG(this,!1));this.shadow&&e.push(this.shadow.toSVG(this));return e}});
fabric.util.object.extend(fabric.Object.prototype,{hasStateChanged:function(){return this.stateProperties.some(function(e){return this.get(e)!==this.originalState[e]},this)},saveState:function(e){this.stateProperties.forEach(function(b){this.originalState[b]=this.get(b)},this);e&&e.stateProperties&&e.stateProperties.forEach(function(b){this.originalState[b]=this.get(b)},this);return this},setupState:function(){this.originalState={};this.saveState();return this}});
(function(){var e=fabric.util.degreesToRadians;fabric.util.object.extend(fabric.Object.prototype,{_controlsVisibility:null,_findTargetCorner:function(b){if(!this.hasControls||!this.active)return!1;var d=b.x;b=b.y;var a,c;for(c in this.oCoords)if(this.isControlVisible(c)&&("mtr"!==c||this.hasRotatingPoint)&&(!this.get("lockUniScaling")||"mt"!==c&&"mr"!==c&&"mb"!==c&&"ml"!==c)&&(a=this._getImageLines(this.oCoords[c].corner),a=this._findCrossPoints({x:d,y:b},a),0!==a&&1===a%2))return this.__corner=c;
return!1},_setCornerCoords:function(){var b=this.oCoords,d=e(45-this.angle),a=Math.sqrt(2*Math.pow(this.cornerSize,2))/2,c=a*Math.cos(d),d=a*Math.sin(d),g,f;for(f in b)a=b[f].x,g=b[f].y,b[f].corner={tl:{x:a-d,y:g-c},tr:{x:a+c,y:g-d},bl:{x:a-c,y:g+d},br:{x:a+d,y:g+c}}},_calculateCurrentDimensions:function(b){var d=this.getViewportTransform(),a=this.strokeWidth,c=this.width,e=this.height,f="round"===this.strokeLineCap||"square"===this.strokeLineCap,k="line"===this.type&&0===this.width,l="line"===this.type&&
0===this.height,m=k||l;k?c=a:l&&(e=a);(f&&l||!m)&&(c+=0>c?-a:a);(f&&k||!m)&&(e+=0>e?-a:a);c=c*this.scaleX+2*this.padding;e=e*this.scaleY+2*this.padding;return b?fabric.util.transformPoint(new fabric.Point(c,e),d,!0):{x:c,y:e}},drawBorders:function(b){if(!this.hasBorders)return this;b.save();b.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1;b.strokeStyle=this.borderColor;b.lineWidth=1/this.borderScaleFactor;var d=this._calculateCurrentDimensions(!0),a=d.x,d=d.y;this.group&&(a*=this.group.scaleX,
d*=this.group.scaleY);b.strokeRect(~~-(a/2)-.5,~~-(d/2)-.5,~~a+1,~~d+1);this.hasRotatingPoint&&this.isControlVisible("mtr")&&!this.get("lockRotation")&&this.hasControls&&(a=-d/2,b.beginPath(),b.moveTo(0,a),b.lineTo(0,a-this.rotatingPointOffset),b.closePath(),b.stroke());b.restore();return this},drawControls:function(b){if(!this.hasControls)return this;var d=this._calculateCurrentDimensions(!0),a=d.x,d=d.y,c=-(a/2),e=-(d/2),f=this.cornerSize/2,k=this.transparentCorners?"strokeRect":"fillRect";b.save();
b.lineWidth=1;b.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1;b.strokeStyle=b.fillStyle=this.cornerColor;this._drawControl("tl",b,k,c-f,e-f);this._drawControl("tr",b,k,c+a-f,e-f);this._drawControl("bl",b,k,c-f,e+d-f);this._drawControl("br",b,k,c+a-f,e+d-f);this.get("lockUniScaling")||(this._drawControl("mt",b,k,c+a/2-f,e-f),this._drawControl("mb",b,k,c+a/2-f,e+d-f),this._drawControl("mr",b,k,c+a-f,e+d/2-f),this._drawControl("ml",b,k,c-f,e+d/2-f));this.hasRotatingPoint&&this._drawControl("mtr",
b,k,c+a/2-f,e-this.rotatingPointOffset-f);b.restore();return this},_drawControl:function(b,d,a,c,e){this.isControlVisible(b)&&(b=this.cornerSize,"undefined"!==typeof G_vmlCanvasManager||this.transparentCorners||d.clearRect(c,e,b,b),d[a](c,e,b,b))},isControlVisible:function(b){return this._getControlsVisibility()[b]},setControlVisible:function(b,d){this._getControlsVisibility()[b]=d;return this},setControlsVisibility:function(b){b||(b={});for(var d in b)this.setControlVisible(d,b[d]);return this},
_getControlsVisibility:function(){this._controlsVisibility||(this._controlsVisibility={tl:!0,tr:!0,br:!0,bl:!0,ml:!0,mt:!0,mr:!0,mb:!0,mtr:!0});return this._controlsVisibility}})})();
fabric.util.object.extend(fabric.StaticCanvas.prototype,{FX_DURATION:500,fxCenterObjectH:function(e,b){b=b||{};var d=function(){},a=b.onComplete||d,c=b.onChange||d,g=this;fabric.util.animate({startValue:e.get("left"),endValue:this.getCenter().left,duration:this.FX_DURATION,onChange:function(a){e.set("left",a);g.renderAll();c()},onComplete:function(){e.setCoords();a()}});return this},fxCenterObjectV:function(e,b){b=b||{};var d=function(){},a=b.onComplete||d,c=b.onChange||d,g=this;fabric.util.animate({startValue:e.get("top"),
endValue:this.getCenter().top,duration:this.FX_DURATION,onChange:function(a){e.set("top",a);g.renderAll();c()},onComplete:function(){e.setCoords();a()}});return this},fxRemove:function(e,b){b=b||{};var d=function(){},a=b.onComplete||d,c=b.onChange||d,g=this;fabric.util.animate({startValue:e.get("opacity"),endValue:0,duration:this.FX_DURATION,onStart:function(){e.set("active",!1)},onChange:function(a){e.set("opacity",a);g.renderAll();c()},onComplete:function(){g.remove(e);a()}});return this}});
fabric.util.object.extend(fabric.Object.prototype,{animate:function(){if(arguments[0]&&"object"===typeof arguments[0]){var e=[],b,d;for(b in arguments[0])e.push(b);for(var a=0,c=e.length;a<c;a++)b=e[a],d=a!==c-1,this._animate(b,arguments[0][b],arguments[1],d)}else this._animate.apply(this,arguments);return this},_animate:function(e,b,d,a){var c=this,g;b=b.toString();d=d?fabric.util.object.clone(d):{};~e.indexOf(".")&&(g=e.split("."));var f=g?this.get(g[0])[g[1]]:this.get(e);"from"in d||(d.from=f);
b=~b.indexOf("=")?f+parseFloat(b.replace("=","")):parseFloat(b);fabric.util.animate({startValue:d.from,endValue:b,byValue:d.by,easing:d.easing,duration:d.duration,abort:d.abort&&function(){return d.abort.call(c)},onChange:function(b){g?c[g[0]][g[1]]=b:c.set(e,b);a||d.onChange&&d.onChange()},onComplete:function(){a||(c.setCoords(),d.onComplete&&d.onComplete())}})}});
(function(e){function b(a,b){var c=a.origin,d=a.axis1,e=a.axis2,g=a.dimension,x=b.nearest,y=b.center,E=b.farthest;return function(){switch(this.get(c)){case x:return Math.min(this.get(d),this.get(e));case y:return Math.min(this.get(d),this.get(e))+.5*this.get(g);case E:return Math.max(this.get(d),this.get(e))}}}var d=e.fabric||(e.fabric={}),a=d.util.object.extend,c={x1:1,x2:1,y1:1,y2:1},g=d.StaticCanvas.supports("setLineDash");d.Line?d.warn("fabric.Line is already defined"):(d.Line=d.util.createClass(d.Object,
{type:"line",x1:0,y1:0,x2:0,y2:0,initialize:function(a,b){b=b||{};a||(a=[0,0,0,0]);this.callSuper("initialize",b);this.set("x1",a[0]);this.set("y1",a[1]);this.set("x2",a[2]);this.set("y2",a[3]);this._setWidthHeight(b)},_setWidthHeight:function(a){a||(a={});this.width=Math.abs(this.x2-this.x1);this.height=Math.abs(this.y2-this.y1);this.left="left"in a?a.left:this._getLeftToOriginX();this.top="top"in a?a.top:this._getTopToOriginY()},_set:function(a,b){this.callSuper("_set",a,b);"undefined"!==typeof c[a]&&
this._setWidthHeight();return this},_getLeftToOriginX:b({origin:"originX",axis1:"x1",axis2:"x2",dimension:"width"},{nearest:"left",center:"center",farthest:"right"}),_getTopToOriginY:b({origin:"originY",axis1:"y1",axis2:"y2",dimension:"height"},{nearest:"top",center:"center",farthest:"bottom"}),_render:function(a,b){a.beginPath();if(b){var c=this.getCenterPoint();a.translate(c.x-this.strokeWidth/2,c.y-this.strokeWidth/2)}if(!this.strokeDashArray||this.strokeDashArray&&g)c=this.calcLinePoints(),a.moveTo(c.x1,
c.y1),a.lineTo(c.x2,c.y2);a.lineWidth=this.strokeWidth;c=a.strokeStyle;a.strokeStyle=this.stroke||a.fillStyle;this.stroke&&this._renderStroke(a);a.strokeStyle=c},_renderDashedStroke:function(a){var b=this.calcLinePoints();a.beginPath();d.util.drawDashedLine(a,b.x1,b.y1,b.x2,b.y2,this.strokeDashArray);a.closePath()},toObject:function(b){return a(this.callSuper("toObject",b),this.calcLinePoints())},calcLinePoints:function(){var a=this.x1<=this.x2?-1:1,b=this.y1<=this.y2?-1:1;return{x1:a*this.width*
.5,x2:a*this.width*-.5,y1:b*this.height*.5,y2:b*this.height*-.5}},toSVG:function(a){var b=this._createBaseSVGMarkup(),c={x1:this.x1,x2:this.x2,y1:this.y1,y2:this.y2};this.group&&"path-group"===this.group.type||(c=this.calcLinePoints());b.push("<line ",'x1="',c.x1,'" y1="',c.y1,'" x2="',c.x2,'" y2="',c.y2,'" style="',this.getSvgStyles(),'" transform="',this.getSvgTransform(),this.getSvgTransformMatrix(),'"/>\n');return a?a(b.join("")):b.join("")},complexity:function(){return 1}}),d.Line.ATTRIBUTE_NAMES=
d.SHARED_ATTRIBUTES.concat(["x1","y1","x2","y2"]),d.Line.fromElement=function(b,c){var e=d.parseAttributes(b,d.Line.ATTRIBUTE_NAMES);return new d.Line([e.x1||0,e.y1||0,e.x2||0,e.y2||0],a(e,c))},d.Line.fromObject=function(a){return new d.Line([a.x1,a.y1,a.x2,a.y2],a)})})("undefined"!==typeof exports?exports:this);
(function(e){var b=e.fabric||(e.fabric={}),d=Math.PI,a=b.util.object.extend;b.Circle?b.warn("fabric.Circle is already defined."):(b.Circle=b.util.createClass(b.Object,{type:"circle",radius:0,startAngle:0,endAngle:2*d,initialize:function(a){a=a||{};this.callSuper("initialize",a);this.set("radius",a.radius||0);this.startAngle=a.startAngle||this.startAngle;this.endAngle=a.endAngle||this.endAngle},_set:function(a,b){this.callSuper("_set",a,b);"radius"===a&&this.setRadius(b);return this},toObject:function(b){return a(this.callSuper("toObject",
b),{radius:this.get("radius"),startAngle:this.startAngle,endAngle:this.endAngle})},toSVG:function(a){var b=this._createBaseSVGMarkup(),f=0,e=0,l=(this.endAngle-this.startAngle)%(2*d);0===l?(this.group&&"path-group"===this.group.type&&(f=this.left+this.radius,e=this.top+this.radius),b.push("<circle ",'cx="'+f+'" cy="'+e+'" ','r="',this.radius,'" style="',this.getSvgStyles(),'" transform="',this.getSvgTransform()," ",this.getSvgTransformMatrix(),'"/>\n')):b.push('<path d="M '+Math.cos(this.startAngle)*
this.radius+" "+Math.sin(this.startAngle)*this.radius," A "+this.radius+" "+this.radius," 0 ",+(l>d?1:0)+" 1"," "+Math.cos(this.endAngle)*this.radius+" "+Math.sin(this.endAngle)*this.radius,'" style="',this.getSvgStyles(),'" transform="',this.getSvgTransform()," ",this.getSvgTransformMatrix(),'"/>\n');return a?a(b.join("")):b.join("")},_render:function(a,b){a.beginPath();a.arc(b?this.left+this.radius:0,b?this.top+this.radius:0,this.radius,this.startAngle,this.endAngle,!1);this._renderFill(a);this._renderStroke(a)},
getRadiusX:function(){return this.get("radius")*this.get("scaleX")},getRadiusY:function(){return this.get("radius")*this.get("scaleY")},setRadius:function(a){this.radius=a;this.set("width",2*a).set("height",2*a)},complexity:function(){return 1}}),b.Circle.ATTRIBUTE_NAMES=b.SHARED_ATTRIBUTES.concat(["cx","cy","r"]),b.Circle.fromElement=function(c,d){d||(d={});var f=b.parseAttributes(c,b.Circle.ATTRIBUTE_NAMES);if(!("radius"in f&&0<=f.radius))throw Error("value of `r` attribute is require2d and can not be negative");
f.left=f.left||0;f.top=f.top||0;f=new b.Circle(a(f,d));f.left-=f.radius;f.top-=f.radius;return f},b.Circle.fromObject=function(a){return new b.Circle(a)})})("undefined"!==typeof exports?exports:this);
(function(e){var b=e.fabric||(e.fabric={});b.Triangle?b.warn("fabric.Triangle is already defined"):(b.Triangle=b.util.createClass(b.Object,{type:"triangle",initialize:function(b){b=b||{};this.callSuper("initialize",b);this.set("width",b.width||100).set("height",b.height||100)},_render:function(b){var a=this.width/2,c=this.height/2;b.beginPath();b.moveTo(-a,c);b.lineTo(0,-c);b.lineTo(a,c);b.closePath();this._renderFill(b);this._renderStroke(b)},_renderDashedStroke:function(d){var a=this.width/2,c=
this.height/2;d.beginPath();b.util.drawDashedLine(d,-a,c,0,-c,this.strokeDashArray);b.util.drawDashedLine(d,0,-c,a,c,this.strokeDashArray);b.util.drawDashedLine(d,a,c,-a,c,this.strokeDashArray);d.closePath()},toSVG:function(b){var a=this._createBaseSVGMarkup(),c=this.width/2,e=this.height/2,c=[-c+" "+e,"0 "+-e,c+" "+e].join();a.push("<polygon ",'points="',c,'" style="',this.getSvgStyles(),'" transform="',this.getSvgTransform(),'"/>');return b?b(a.join("")):a.join("")},complexity:function(){return 1}}),
b.Triangle.fromObject=function(d){return new b.Triangle(d)})})("undefined"!==typeof exports?exports:this);
(function(e){var b=e.fabric||(e.fabric={}),d=2*Math.PI,a=b.util.object.extend;b.Ellipse?b.warn("fabric.Ellipse is already defined."):(b.Ellipse=b.util.createClass(b.Object,{type:"ellipse",rx:0,ry:0,initialize:function(a){a=a||{};this.callSuper("initialize",a);this.set("rx",a.rx||0);this.set("ry",a.ry||0)},_set:function(a,b){this.callSuper("_set",a,b);switch(a){case "rx":this.rx=b;this.set("width",2*b);break;case "ry":this.ry=b,this.set("height",2*b)}return this},getRx:function(){return this.get("rx")*
this.get("scaleX")},getRy:function(){return this.get("ry")*this.get("scaleY")},toObject:function(b){return a(this.callSuper("toObject",b),{rx:this.get("rx"),ry:this.get("ry")})},toSVG:function(a){var b=this._createBaseSVGMarkup(),d=0,e=0;this.group&&"path-group"===this.group.type&&(d=this.left+this.rx,e=this.top+this.ry);b.push("<ellipse ",'cx="',d,'" cy="',e,'" ','rx="',this.rx,'" ry="',this.ry,'" style="',this.getSvgStyles(),'" transform="',this.getSvgTransform(),this.getSvgTransformMatrix(),'"/>\n');
return a?a(b.join("")):b.join("")},_render:function(a,b){a.beginPath();a.save();a.transform(1,0,0,this.ry/this.rx,0,0);a.arc(b?this.left+this.rx:0,b?(this.top+this.ry)*this.rx/this.ry:0,this.rx,0,d,!1);a.restore();this._renderFill(a);this._renderStroke(a)},complexity:function(){return 1}}),b.Ellipse.ATTRIBUTE_NAMES=b.SHARED_ATTRIBUTES.concat(["cx","cy","rx","ry"]),b.Ellipse.fromElement=function(c,d){d||(d={});var f=b.parseAttributes(c,b.Ellipse.ATTRIBUTE_NAMES);f.left=f.left||0;f.top=f.top||0;f=new b.Ellipse(a(f,
d));f.top-=f.ry;f.left-=f.rx;return f},b.Ellipse.fromObject=function(a){return new b.Ellipse(a)})})("undefined"!==typeof exports?exports:this);
(function(e){var b=e.fabric||(e.fabric={}),d=b.util.object.extend;b.Rect?console.warn("fabric.Rect is already defined"):(e=b.Object.prototype.stateProperties.concat(),e.push("rx","ry","x","y"),b.Rect=b.util.createClass(b.Object,{stateProperties:e,type:"rect",rx:0,ry:0,strokeDashArray:null,initialize:function(a){a=a||{};this.callSuper("initialize",a);this._initRxRy()},_initRxRy:function(){this.rx&&!this.ry?this.ry=this.rx:this.ry&&!this.rx&&(this.rx=this.ry)},_render:function(a,b){if(1===this.width&&
1===this.height)a.fillRect(0,0,1,1);else{var d=this.rx?Math.min(this.rx,this.width/2):0,f=this.ry?Math.min(this.ry,this.height/2):0,e=this.width,l=this.height,m=b?this.left:-this.width/2,p=b?this.top:-this.height/2,n=0!==d||0!==f;a.beginPath();a.moveTo(m+d,p);a.lineTo(m+e-d,p);n&&a.bezierCurveTo(m+e-.4477152502*d,p,m+e,p+.4477152502*f,m+e,p+f);a.lineTo(m+e,p+l-f);n&&a.bezierCurveTo(m+e,p+l-.4477152502*f,m+e-.4477152502*d,p+l,m+e-d,p+l);a.lineTo(m+d,p+l);n&&a.bezierCurveTo(m+.4477152502*d,p+l,m,p+
l-.4477152502*f,m,p+l-f);a.lineTo(m,p+f);n&&a.bezierCurveTo(m,p+.4477152502*f,m+.4477152502*d,p,m+d,p);a.closePath();this._renderFill(a);this._renderStroke(a)}},_renderDashedStroke:function(a){var c=-this.width/2,d=-this.height/2,f=this.width,e=this.height;a.beginPath();b.util.drawDashedLine(a,c,d,c+f,d,this.strokeDashArray);b.util.drawDashedLine(a,c+f,d,c+f,d+e,this.strokeDashArray);b.util.drawDashedLine(a,c+f,d+e,c,d+e,this.strokeDashArray);b.util.drawDashedLine(a,c,d+e,c,d,this.strokeDashArray);
a.closePath()},toObject:function(a){a=d(this.callSuper("toObject",a),{rx:this.get("rx")||0,ry:this.get("ry")||0});this.includeDefaultValues||this._removeDefaultValues(a);return a},toSVG:function(a){var b=this._createBaseSVGMarkup(),d=this.left,f=this.top;this.group&&"path-group"===this.group.type||(d=-this.width/2,f=-this.height/2);b.push("<rect ",'x="',d,'" y="',f,'" rx="',this.get("rx"),'" ry="',this.get("ry"),'" width="',this.width,'" height="',this.height,'" style="',this.getSvgStyles(),'" transform="',
this.getSvgTransform(),this.getSvgTransformMatrix(),'"/>\n');return a?a(b.join("")):b.join("")},complexity:function(){return 1}}),b.Rect.ATTRIBUTE_NAMES=b.SHARED_ATTRIBUTES.concat("x y rx ry width height".split(" ")),b.Rect.fromElement=function(a,c){if(!a)return null;c=c||{};var e=b.parseAttributes(a,b.Rect.ATTRIBUTE_NAMES);e.left=e.left||0;e.top=e.top||0;e=new b.Rect(d(c?b.util.object.clone(c):{},e));e.visible=0<e.width&&0<e.height;return e},b.Rect.fromObject=function(a){return new b.Rect(a)})})("undefined"!==
typeof exports?exports:this);
(function(e){var b=e.fabric||(e.fabric={});b.Polyline?b.warn("fabric.Polyline is already defined"):(b.Polyline=b.util.createClass(b.Object,{type:"polyline",points:null,minX:0,minY:0,initialize:function(d,a){return b.Polygon.prototype.initialize.call(this,d,a)},_calcDimensions:function(){return b.Polygon.prototype._calcDimensions.call(this)},_applyPointOffset:function(){return b.Polygon.prototype._applyPointOffset.call(this)},toObject:function(d){return b.Polygon.prototype.toObject.call(this,d)},toSVG:function(d){return b.Polygon.prototype.toSVG.call(this,
d)},_render:function(d){b.Polygon.prototype.commonRender.call(this,d)&&(this._renderFill(d),this._renderStroke(d))},_renderDashedStroke:function(d){var a,c;d.beginPath();for(var e=0,f=this.points.length;e<f;e++)a=this.points[e],c=this.points[e+1]||a,b.util.drawDashedLine(d,a.x,a.y,c.x,c.y,this.strokeDashArray)},complexity:function(){return this.get("points").length}}),b.Polyline.ATTRIBUTE_NAMES=b.SHARED_ATTRIBUTES.concat(),b.Polyline.fromElement=function(d,a){if(!d)return null;a||(a={});var c=b.parsePointsAttribute(d.getAttribute("points")),
e=b.parseAttributes(d,b.Polyline.ATTRIBUTE_NAMES);return new b.Polyline(c,b.util.object.extend(e,a))},b.Polyline.fromObject=function(d){return new b.Polyline(d.points,d,!0)})})("undefined"!==typeof exports?exports:this);
(function(e){var b=e.fabric||(e.fabric={}),d=b.util.object.extend,a=b.util.array.min,c=b.util.array.max,g=b.util.toFixed;b.Polygon?b.warn("fabric.Polygon is already defined"):(b.Polygon=b.util.createClass(b.Object,{type:"polygon",points:null,minX:0,minY:0,initialize:function(a,b){b=b||{};this.points=a||[];this.callSuper("initialize",b);this._calcDimensions();"top"in b||(this.top=this.minY);"left"in b||(this.left=this.minX)},_calcDimensions:function(){var b=this.points,d=a(b,"x"),e=a(b,"y"),g=c(b,
"x"),b=c(b,"y");this.width=g-d||0;this.height=b-e||0;this.minX=d||0;this.minY=e||0},_applyPointOffset:function(){this.points.forEach(function(a){a.x-=this.minX+this.width/2;a.y-=this.minY+this.height/2},this)},toObject:function(a){return d(this.callSuper("toObject",a),{points:this.points.concat()})},toSVG:function(a){for(var b=[],c=this._createBaseSVGMarkup(),d=0,e=this.points.length;d<e;d++)b.push(g(this.points[d].x,2),",",g(this.points[d].y,2)," ");c.push("<",this.type," ",'points="',b.join(""),
'" style="',this.getSvgStyles(),'" transform="',this.getSvgTransform()," ",this.getSvgTransformMatrix(),'"/>\n');return a?a(c.join("")):c.join("")},_render:function(a){this.commonRender(a)&&(this._renderFill(a),this.stroke||this.strokeDashArray)&&(a.closePath(),this._renderStroke(a))},commonRender:function(a){var b,c=this.points.length;if(!c||isNaN(this.points[c-1].y))return!1;a.beginPath();this._applyPointOffset&&(this.group&&"path-group"===this.group.type||this._applyPointOffset(),this._applyPointOffset=
null);a.moveTo(this.points[0].x,this.points[0].y);for(var d=0;d<c;d++)b=this.points[d],a.lineTo(b.x,b.y);return!0},_renderDashedStroke:function(a){b.Polyline.prototype._renderDashedStroke.call(this,a);a.closePath()},complexity:function(){return this.points.length}}),b.Polygon.ATTRIBUTE_NAMES=b.SHARED_ATTRIBUTES.concat(),b.Polygon.fromElement=function(a,c){if(!a)return null;c||(c={});var e=b.parsePointsAttribute(a.getAttribute("points")),g=b.parseAttributes(a,b.Polygon.ATTRIBUTE_NAMES);return new b.Polygon(e,
d(g,c))},b.Polygon.fromObject=function(a){return new b.Polygon(a.points,a,!0)})})("undefined"!==typeof exports?exports:this);
(function(e){var b=e.fabric||(e.fabric={}),d=b.util.array.min,a=b.util.array.max,c=b.util.object.extend,g=Object.prototype.toString,f=b.util.drawArc,k={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7},l={m:"l",M:"L"};b.Path?b.warn("fabric.Path is already defined"):(b.Path=b.util.createClass(b.Object,{type:"path",path:null,minX:0,minY:0,initialize:function(a,b){b=b||{};this.setOptions(b);if(!a)throw Error("`path` argument is require2d");var c="[object Array]"===g.call(a);if(this.path=c?a:a.match&&a.match(/[mzlhvcsqta][^mzlhvcsqta]*/gi))c||
(this.path=this._parsePath()),this._setPositionDimensions(),b.sourcePath&&this.setSourcePath(b.sourcePath)},_setPositionDimensions:function(){var a=this._parseDimensions();this.minX=a.left;this.minY=a.top;this.width=a.width;this.height=a.height;a.left+="center"===this.originX?this.width/2:"right"===this.originX?this.width:0;a.top+="center"===this.originY?this.height/2:"bottom"===this.originY?this.height:0;this.top=this.top||a.top;this.left=this.left||a.left;this.pathOffset=this.pathOffset||{x:this.minX+
this.width/2,y:this.minY+this.height/2}},_render:function(a){var b,c=null,d=0,e=0,g=0,k=0,l=0,q=0,t,r,v=-this.pathOffset.x,w=-this.pathOffset.y;this.group&&"path-group"===this.group.type&&(w=v=0);a.beginPath();for(var D=0,A=this.path.length;D<A;++D){b=this.path[D];switch(b[0]){case "l":g+=b[1];k+=b[2];a.lineTo(g+v,k+w);break;case "L":g=b[1];k=b[2];a.lineTo(g+v,k+w);break;case "h":g+=b[1];a.lineTo(g+v,k+w);break;case "H":g=b[1];a.lineTo(g+v,k+w);break;case "v":k+=b[1];a.lineTo(g+v,k+w);break;case "V":k=
b[1];a.lineTo(g+v,k+w);break;case "m":g+=b[1];k+=b[2];d=g;e=k;a.moveTo(g+v,k+w);break;case "M":g=b[1];k=b[2];d=g;e=k;a.moveTo(g+v,k+w);break;case "c":t=g+b[5];r=k+b[6];l=g+b[3];q=k+b[4];a.bezierCurveTo(g+b[1]+v,k+b[2]+w,l+v,q+w,t+v,r+w);g=t;k=r;break;case "C":g=b[5];k=b[6];l=b[3];q=b[4];a.bezierCurveTo(b[1]+v,b[2]+w,l+v,q+w,g+v,k+w);break;case "s":t=g+b[3];r=k+b[4];null===c[0].match(/[CcSs]/)?(l=g,q=k):(l=2*g-l,q=2*k-q);a.bezierCurveTo(l+v,q+w,g+b[1]+v,k+b[2]+w,t+v,r+w);l=g+b[1];q=k+b[2];g=t;k=r;
break;case "S":t=b[3];r=b[4];null===c[0].match(/[CcSs]/)?(l=g,q=k):(l=2*g-l,q=2*k-q);a.bezierCurveTo(l+v,q+w,b[1]+v,b[2]+w,t+v,r+w);g=t;k=r;l=b[1];q=b[2];break;case "q":t=g+b[3];r=k+b[4];l=g+b[1];q=k+b[2];a.quadraticCurveTo(l+v,q+w,t+v,r+w);g=t;k=r;break;case "Q":t=b[3];r=b[4];a.quadraticCurveTo(b[1]+v,b[2]+w,t+v,r+w);g=t;k=r;l=b[1];q=b[2];break;case "t":t=g+b[1];r=k+b[2];null===c[0].match(/[QqTt]/)?(l=g,q=k):(l=2*g-l,q=2*k-q);a.quadraticCurveTo(l+v,q+w,t+v,r+w);g=t;k=r;break;case "T":t=b[1];r=b[2];
null===c[0].match(/[QqTt]/)?(l=g,q=k):(l=2*g-l,q=2*k-q);a.quadraticCurveTo(l+v,q+w,t+v,r+w);g=t;k=r;break;case "a":f(a,g+v,k+w,[b[1],b[2],b[3],b[4],b[5],b[6]+g+v,b[7]+k+w]);g+=b[6];k+=b[7];break;case "A":f(a,g+v,k+w,[b[1],b[2],b[3],b[4],b[5],b[6]+v,b[7]+w]);g=b[6];k=b[7];break;case "z":case "Z":g=d,k=e,a.closePath()}c=b}this._renderFill(a);this._renderStroke(a)},toString:function(){return"#<fabric.Path ("+this.complexity()+'): { "top": '+this.top+', "left": '+this.left+" }>"},toObject:function(a){a=
c(this.callSuper("toObject",a),{path:this.path.map(function(a){return a.slice()}),pathOffset:this.pathOffset});this.sourcePath&&(a.sourcePath=this.sourcePath);this.transformMatrix&&(a.transformMatrix=this.transformMatrix);return a},toDatalessObject:function(a){a=this.toObject(a);this.sourcePath&&(a.path=this.sourcePath);delete a.sourcePath;return a},toSVG:function(a){for(var b=[],c=this._createBaseSVGMarkup(),d="",f=0,e=this.path.length;f<e;f++)b.push(this.path[f].join(" "));b=b.join(" ");this.group&&
"path-group"===this.group.type||(d=" translate("+-this.pathOffset.x+", "+-this.pathOffset.y+") ");c.push("<path ",'d="',b,'" style="',this.getSvgStyles(),'" transform="',this.getSvgTransform(),d,this.getSvgTransformMatrix(),'" stroke-linecap="round" ',"/>\n");return a?a(c.join("")):c.join("")},complexity:function(){return this.path.length},_parsePath:function(){for(var a=[],b=[],c,d,f=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:e[-+]?\d+)?)/ig,e,g=0,z=this.path.length;g<z;g++){c=this.path[g];e=c.slice(1).trim();
for(b.length=0;d=f.exec(e);)b.push(d[0]);c=[c.charAt(0)];e=0;for(var q=b.length;e<q;e++)d=parseFloat(b[e]),isNaN(d)||c.push(d);d=c[0];e=k[d.toLowerCase()];q=l[d]||d;if(c.length-1>e)for(var t=1,r=c.length;t<r;t+=e)a.push([d].concat(c.slice(t,t+e))),d=q;else a.push(c)}return a},_parseDimensions:function(){for(var c=[],f=[],e,g=null,k=0,l=0,u=0,z=0,q=0,t=0,r,v,w,D=0,A=this.path.length;D<A;++D){e=this.path[D];switch(e[0]){case "l":u+=e[1];z+=e[2];w=[];break;case "L":u=e[1];z=e[2];w=[];break;case "h":u+=
e[1];w=[];break;case "H":u=e[1];w=[];break;case "v":z+=e[1];w=[];break;case "V":z=e[1];w=[];break;case "m":u+=e[1];z+=e[2];k=u;l=z;w=[];break;case "M":u=e[1];z=e[2];k=u;l=z;w=[];break;case "c":r=u+e[5];v=z+e[6];q=u+e[3];t=z+e[4];w=b.util.getBoundsOfCurve(u,z,u+e[1],z+e[2],q,t,r,v);u=r;z=v;break;case "C":u=e[5];z=e[6];q=e[3];t=e[4];w=b.util.getBoundsOfCurve(u,z,e[1],e[2],q,t,u,z);break;case "s":r=u+e[3];v=z+e[4];null===g[0].match(/[CcSs]/)?(q=u,t=z):(q=2*u-q,t=2*z-t);w=b.util.getBoundsOfCurve(u,z,
q,t,u+e[1],z+e[2],r,v);q=u+e[1];t=z+e[2];u=r;z=v;break;case "S":r=e[3];v=e[4];null===g[0].match(/[CcSs]/)?(q=u,t=z):(q=2*u-q,t=2*z-t);w=b.util.getBoundsOfCurve(u,z,q,t,e[1],e[2],r,v);u=r;z=v;q=e[1];t=e[2];break;case "q":r=u+e[3];v=z+e[4];q=u+e[1];t=z+e[2];w=b.util.getBoundsOfCurve(u,z,q,t,q,t,r,v);u=r;z=v;break;case "Q":q=e[1];t=e[2];w=b.util.getBoundsOfCurve(u,z,q,t,q,t,e[3],e[4]);u=e[3];z=e[4];break;case "t":r=u+e[1];v=z+e[2];null===g[0].match(/[QqTt]/)?(q=u,t=z):(q=2*u-q,t=2*z-t);w=b.util.getBoundsOfCurve(u,
z,q,t,q,t,r,v);u=r;z=v;break;case "T":r=e[1];v=e[2];null===g[0].match(/[QqTt]/)?(q=u,t=z):(q=2*u-q,t=2*z-t);w=b.util.getBoundsOfCurve(u,z,q,t,q,t,r,v);u=r;z=v;break;case "a":w=b.util.getBoundsOfArc(u,z,e[1],e[2],e[3],e[4],e[5],e[6]+u,e[7]+z);u+=e[6];z+=e[7];break;case "A":w=b.util.getBoundsOfArc(u,z,e[1],e[2],e[3],e[4],e[5],e[6],e[7]);u=e[6];z=e[7];break;case "z":case "Z":u=k,z=l}g=e;w.forEach(function(a){c.push(a.x);f.push(a.y)});c.push(u);f.push(z)}e=d(c);g=d(f);k=a(c);l=a(f);return{left:e,top:g,
width:k-e,height:l-g}}}),b.Path.fromObject=function(a,c){"string"===typeof a.path?b.loadSVGFromURL(a.path,function(d){d=d[0];var f=a.path;delete a.path;b.util.object.extend(d,a);d.setSourcePath(f);c(d)}):c(new b.Path(a.path,a))},b.Path.ATTRIBUTE_NAMES=b.SHARED_ATTRIBUTES.concat(["d"]),b.Path.fromElement=function(a,d,f){a=b.parseAttributes(a,b.Path.ATTRIBUTE_NAMES);d&&d(new b.Path(a.d,c(a,f)))},b.Path.async=!0)})("undefined"!==typeof exports?exports:this);
(function(e){var b=e.fabric||(e.fabric={}),d=b.util.object.extend,a=b.util.array.invoke,c=b.Object.prototype.toObject;b.PathGroup?b.warn("fabric.PathGroup is already defined"):(b.PathGroup=b.util.createClass(b.Path,{type:"path-group",fill:"",initialize:function(a,b){b=b||{};this.paths=a||[];for(var c=this.paths.length;c--;)this.paths[c].group=this;b.toBeParsed&&(this.parseDimensionsFromPaths(b),delete b.toBeParsed);this.setOptions(b);this.setCoords();b.sourcePath&&this.setSourcePath(b.sourcePath)},
parseDimensionsFromPaths:function(a){for(var c,d,e=[],m=[],p,n=this.transformMatrix,x=this.paths.length;x--;)for(c=this.paths[x],d=c.height+c.strokeWidth,p=c.width+c.strokeWidth,c=[{x:c.left,y:c.top},{x:c.left+p,y:c.top},{x:c.left,y:c.top+d},{x:c.left+p,y:c.top+d}],p=0;p<c.length;p++)d=c[p],n&&(d=b.util.transformPoint(d,n,!1)),e.push(d.x),m.push(d.y);a.width=Math.max.apply(null,e);a.height=Math.max.apply(null,m)},render:function(a){if(this.visible){a.save();this.transformMatrix&&a.transform.apply(a,
this.transformMatrix);this.transform(a);this._setShadow(a);this.clipTo&&b.util.clipContext(this,a);a.translate(-this.width/2,-this.height/2);for(var c=0,d=this.paths.length;c<d;++c)this.paths[c].render(a,!0);this.clipTo&&a.restore();this._removeShadow(a);a.restore()}},_set:function(a,b){if("fill"===a&&b&&this.isSameColor())for(var c=this.paths.length;c--;)this.paths[c]._set(a,b);return this.callSuper("_set",a,b)},toObject:function(b){b=d(c.call(this,b),{paths:a(this.getObjects(),"toObject",b)});this.sourcePath&&
(b.sourcePath=this.sourcePath);return b},toDatalessObject:function(a){a=this.toObject(a);this.sourcePath&&(a.paths=this.sourcePath);return a},toSVG:function(a){for(var b=this.getObjects(),c=this.getPointByOrigin("left","top"),c="translate("+c.x+" "+c.y+")",c=["<g ",'style="',this.getSvgStyles(),'" ','transform="',this.getSvgTransformMatrix(),c,this.getSvgTransform(),'" ',">\n"],d=0,e=b.length;d<e;d++)c.push(b[d].toSVG(a));c.push("</g>\n");return a?a(c.join("")):c.join("")},toString:function(){return"#<fabric.PathGroup ("+
this.complexity()+"): { top: "+this.top+", left: "+this.left+" }>"},isSameColor:function(){var a=(this.getObjects()[0].get("fill")||"").toLowerCase();return this.getObjects().every(function(b){return(b.get("fill")||"").toLowerCase()===a})},complexity:function(){return this.paths.reduce(function(a,b){return a+(b&&b.complexity?b.complexity():0)},0)},getObjects:function(){return this.paths}}),b.PathGroup.fromObject=function(a,c){"string"===typeof a.paths?b.loadSVGFromURL(a.paths,function(d){var e=a.paths;
delete a.paths;d=b.util.groupSVGElements(d,a,e);c(d)}):b.util.enlivenObjects(a.paths,function(d){delete a.paths;c(new b.PathGroup(d,a))})},b.PathGroup.async=!0)})("undefined"!==typeof exports?exports:this);
(function(e){var b=e.fabric||(e.fabric={}),d=b.util.object.extend,a=b.util.array.min,c=b.util.array.max,g=b.util.array.invoke;if(!b.Group){var f={lockMovementX:!0,lockMovementY:!0,lockRotation:!0,lockScalingX:!0,lockScalingY:!0,lockUniScaling:!0};b.Group=b.util.createClass(b.Object,b.Collection,{type:"group",initialize:function(a,b){b=b||{};this._objects=a||[];for(var c=this._objects.length;c--;)this._objects[c].group=this;this.originalState={};this.callSuper("initialize");b.originX&&(this.originX=
b.originX);b.originY&&(this.originY=b.originY);this._calcBounds();this._updateObjectsCoords();this.callSuper("initialize",b);this.setCoords();this.saveCoords()},_updateObjectsCoords:function(){this.forEachObject(this._updateObjectCoords,this)},_updateObjectCoords:function(a){var b=a.getLeft(),c=a.getTop(),d=this.getCenterPoint();a.set({originalLeft:b,originalTop:c,left:b-d.x,top:c-d.y});a.setCoords();a.__origHasControls=a.hasControls;a.hasControls=!1},toString:function(){return"#<fabric.Group: ("+
this.complexity()+")>"},addWithUpdate:function(a){this._restoreObjectsState();a&&(this._objects.push(a),a.group=this);this.forEachObject(this._setObjectActive,this);this._calcBounds();this._updateObjectsCoords();return this},_setObjectActive:function(a){a.set("active",!0);a.group=this},removeWithUpdate:function(a){this._moveFlippedObject(a);this._restoreObjectsState();this.forEachObject(this._setObjectActive,this);this.remove(a);this._calcBounds();this._updateObjectsCoords();return this},_onObjectAdded:function(a){a.group=
this},_onObjectRemoved:function(a){delete a.group;a.set("active",!1)},delegatedProperties:{fill:!0,opacity:!0,fontFamily:!0,fontWeight:!0,fontSize:!0,fontStyle:!0,lineHeight:!0,textDecoration:!0,textAlign:!0,backgroundColor:!0},_set:function(a,b){if(a in this.delegatedProperties)for(var c=this._objects.length;c--;)this._objects[c].set(a,b);this.callSuper("_set",a,b)},toObject:function(a){return d(this.callSuper("toObject",a),{objects:g(this._objects,"toObject",a)})},render:function(a){if(this.visible){a.save();
this.clipTo&&b.util.clipContext(this,a);this.transform(a);for(var c=0,d=this._objects.length;c<d;c++)this._renderObject(this._objects[c],a);this.clipTo&&a.restore();a.restore()}},_renderControls:function(a,b){this.callSuper("_renderControls",a,b);for(var c=0,d=this._objects.length;c<d;c++)this._objects[c]._renderControls(a)},_renderObject:function(a,b){var c=a.hasRotatingPoint;a.visible&&(a.hasRotatingPoint=!1,a.render(b),a.hasRotatingPoint=c)},_restoreObjectsState:function(){this._objects.forEach(this._restoreObjectState,
this);return this},realizeTransform:function(a){this._moveFlippedObject(a);this._setObjectPosition(a);return a},_moveFlippedObject:function(a){var b=a.get("originX"),c=a.get("originY"),d=a.getCenterPoint();a.set({originX:"center",originY:"center",left:d.x,top:d.y});this._toggleFlipping(a);d=a.getPointByOrigin(b,c);a.set({originX:b,originY:c,left:d.x,top:d.y});return this},_toggleFlipping:function(a){this.flipX&&(a.toggle("flipX"),a.set("left",-a.get("left")),a.setAngle(-a.getAngle()));this.flipY&&
(a.toggle("flipY"),a.set("top",-a.get("top")),a.setAngle(-a.getAngle()))},_restoreObjectState:function(a){this._setObjectPosition(a);a.setCoords();a.hasControls=a.__origHasControls;delete a.__origHasControls;a.set("active",!1);a.setCoords();delete a.group;return this},_setObjectPosition:function(a){var b=this.getCenterPoint(),c=this._getRotatedLeftTop(a);a.set({angle:a.getAngle()+this.getAngle(),left:b.x+c.left,top:b.y+c.top,scaleX:a.get("scaleX")*this.get("scaleX"),scaleY:a.get("scaleY")*this.get("scaleY")})},
_getRotatedLeftTop:function(a){var b=this.getAngle()*(Math.PI/180);return{left:-Math.sin(b)*a.getTop()*this.get("scaleY")+Math.cos(b)*a.getLeft()*this.get("scaleX"),top:Math.cos(b)*a.getTop()*this.get("scaleY")+Math.sin(b)*a.getLeft()*this.get("scaleX")}},destroy:function(){this._objects.forEach(this._moveFlippedObject,this);return this._restoreObjectsState()},saveCoords:function(){this._originalLeft=this.get("left");this._originalTop=this.get("top");return this},hasMoved:function(){return this._originalLeft!==
this.get("left")||this._originalTop!==this.get("top")},setObjectsCoords:function(){this.forEachObject(function(a){a.setCoords()});return this},_calcBounds:function(a){for(var b=[],c=[],d,f,e=["tr","br","bl","tl"],g=0,E=this._objects.length;g<E;++g){d=this._objects[g];d.setCoords();for(var u=0;u<e.length;u++)f=e[u],b.push(d.oCoords[f].x),c.push(d.oCoords[f].y)}this.set(this._getBounds(b,c,a))},_getBounds:function(d,f,e){var g=b.util.invertTransform(this.getViewportTransform()),n=b.util.transformPoint(new b.Point(a(d),
a(f)),g);d=b.util.transformPoint(new b.Point(c(d),c(f)),g);d={width:d.x-n.x||0,height:d.y-n.y||0};e||(d.left=n.x||0,d.top=n.y||0,"center"===this.originX&&(d.left+=d.width/2),"right"===this.originX&&(d.left+=d.width),"center"===this.originY&&(d.top+=d.height/2),"bottom"===this.originY&&(d.top+=d.height));return d},toSVG:function(a){for(var b=["<g ",'transform="',this.getSvgTransform(),'">\n'],c=0,d=this._objects.length;c<d;c++)b.push(this._objects[c].toSVG(a));b.push("</g>\n");return a?a(b.join("")):
b.join("")},get:function(a){if(a in f){if(this[a])return this[a];for(var b=0,c=this._objects.length;b<c;b++)if(this._objects[b][a])return!0;return!1}return a in this.delegatedProperties?this._objects[0]&&this._objects[0].get(a):this[a]}});b.Group.fromObject=function(a,c){b.util.enlivenObjects(a.objects,function(d){delete a.objects;c&&c(new b.Group(d,a))})};b.Group.async=!0}})("undefined"!==typeof exports?exports:this);
(function(e){var b=fabric.util.object.extend;e.fabric||(e.fabric={});e.fabric.Image?fabric.warn("fabric.Image is already defined."):(fabric.Image=fabric.util.createClass(fabric.Object,{type:"image",crossOrigin:"",alignX:"none",alignY:"none",meetOrSlice:"meet",_lastScaleX:1,_lastScaleY:1,initialize:function(b,a){a||(a={});this.filters=[];this.resizeFilters=[];this.callSuper("initialize",a);this._initElement(b,a);this._initConfig(a);a.filters&&(this.filters=a.filters,this.applyFilters())},getElement:function(){return this._element},
setElement:function(b,a,c){this._originalElement=this._element=b;this._initConfig(c);0!==this.filters.length?this.applyFilters(a):a&&a();return this},setCrossOrigin:function(b){this.crossOrigin=b;this._element.crossOrigin=b;return this},getOriginalSize:function(){var b=this.getElement();return{width:b.width,height:b.height}},_stroke:function(b){b.save();this._setStrokeStyles(b);b.beginPath();b.strokeRect(-this.width/2,-this.height/2,this.width,this.height);b.closePath();b.restore()},_renderDashedStroke:function(b){var a=
-this.width/2,c=-this.height/2,e=this.width,f=this.height;b.save();this._setStrokeStyles(b);b.beginPath();fabric.util.drawDashedLine(b,a,c,a+e,c,this.strokeDashArray);fabric.util.drawDashedLine(b,a+e,c,a+e,c+f,this.strokeDashArray);fabric.util.drawDashedLine(b,a+e,c+f,a,c+f,this.strokeDashArray);fabric.util.drawDashedLine(b,a,c+f,a,c,this.strokeDashArray);b.closePath();b.restore()},toObject:function(d){return b(this.callSuper("toObject",d),{src:this._originalElement.src||this._originalElement._src,
filters:this.filters.map(function(a){return a&&a.toObject()}),crossOrigin:this.crossOrigin,alignX:this.alignX,alignY:this.alignY,meetOrSlice:this.meetOrSlice})},toSVG:function(b){var a=[],c=-this.width/2,e=-this.height/2,f="none";this.group&&"path-group"===this.group.type&&(c=this.left,e=this.top);"none"!==this.alignX&&"none"!==this.alignY&&(f="x"+this.alignX+"Y"+this.alignY+" "+this.meetOrSlice);a.push('<g transform="',this.getSvgTransform(),this.getSvgTransformMatrix(),'">\n','<image xlink:href="',
this.getSvgSrc(),'" x="',c,'" y="',e,'" style="',this.getSvgStyles(),'" width="',this.width,'" height="',this.height,'" preserveAspectRatio="',f,'"',"></image>\n");if(this.stroke||this.strokeDashArray)f=this.fill,this.fill=null,a.push("<rect ",'x="',c,'" y="',e,'" width="',this.width,'" height="',this.height,'" style="',this.getSvgStyles(),'"/>\n'),this.fill=f;a.push("</g>\n");return b?b(a.join("")):a.join("")},getSrc:function(){if(this.getElement())return this.getElement().src||this.getElement()._src},
setSrc:function(b,a,c){fabric.util.loadImage(b,function(b){return this.setElement(b,a,c)},this,c&&c.crossOrigin)},toString:function(){return'#<fabric.Image: { src: "'+this.getSrc()+'" }>'},clone:function(b,a){this.constructor.fromObject(this.toObject(a),b)},applyFilters:function(b,a,c,e){a=a||this.filters;if(c=c||this._originalElement){var f=c,k=fabric.util.createCanvasElement(),l=fabric.util.createImage(),m=this;k.width=f.width;k.height=f.height;k.getContext("2d").drawImage(f,0,0,f.width,f.height);
if(0===a.length)return this._element=c,b&&b(),k;a.forEach(function(a){a&&a.applyTo(k,a.scaleX||m.scaleX,a.scaleY||m.scaleY);!e&&a&&"Resize"===a.type&&(m.width*=a.scaleX,m.height*=a.scaleY)});l.width=k.width;l.height=k.height;fabric.isLikelyNode?(l.src=k.toBuffer(void 0,fabric.Image.pngCompression),m._element=l,!e&&(m._filteredEl=l),b&&b()):(l.onload=function(){m._element=l;!e&&(m._filteredEl=l);b&&b();l.onload=k=f=null},l.src=k.toDataURL("image/png"));return k}},_render:function(b,a){var c,e,f=this._findMargins(),
k;c=a?this.left:-this.width/2;e=a?this.top:-this.height/2;"slice"===this.meetOrSlice&&(b.beginPath(),b.rect(c,e,this.width,this.height),b.clip());!1===this.isMoving&&this.resizeFilters.length&&this._needsResize()?(this._lastScaleX=this.scaleX,this._lastScaleY=this.scaleY,k=this.applyFilters(null,this.resizeFilters,this._filteredEl||this._originalElement,!0)):k=this._element;k&&b.drawImage(k,c+f.marginX,e+f.marginY,f.width,f.height);this._renderStroke(b)},_needsResize:function(){return this.scaleX!==
this._lastScaleX||this.scaleY!==this._lastScaleY},_findMargins:function(){var b=this.width,a=this.height,c=0,e=0;if("none"!==this.alignX||"none"!==this.alignY)b=[this.width/this._element.width,this.height/this._element.height],a="meet"===this.meetOrSlice?Math.min.apply(null,b):Math.max.apply(null,b),b=this._element.width*a,a*=this._element.height,"Mid"===this.alignX&&(c=(this.width-b)/2),"Max"===this.alignX&&(c=this.width-b),"Mid"===this.alignY&&(e=(this.height-a)/2),"Max"===this.alignY&&(e=this.height-
a);return{width:b,height:a,marginX:c,marginY:e}},_resetWidthHeight:function(){var b=this.getElement();this.set("width",b.width);this.set("height",b.height)},_initElement:function(b){this.setElement(fabric.util.getById(b));fabric.util.addClass(this.getElement(),fabric.Image.CSS_CANVAS)},_initConfig:function(b){b||(b={});this.setOptions(b);this._setWidthHeight(b);this._element&&this.crossOrigin&&(this._element.crossOrigin=this.crossOrigin)},_initFilters:function(b,a){b.filters&&b.filters.length?fabric.util.enlivenObjects(b.filters,
function(b){a&&a(b)},"fabric.Image.filters"):a&&a()},_setWidthHeight:function(b){this.width="width"in b?b.width:this.getElement()?this.getElement().width||0:0;this.height="height"in b?b.height:this.getElement()?this.getElement().height||0:0},complexity:function(){return 1}}),fabric.Image.CSS_CANVAS="canvas-img",fabric.Image.prototype.getSvgSrc=fabric.Image.prototype.getSrc,fabric.Image.fromObject=function(b,a){fabric.util.loadImage(b.src,function(c){fabric.Image.prototype._initFilters.call(b,b,function(e){b.filters=
e||[];e=new fabric.Image(c,b);a&&a(e)})},null,b.crossOrigin)},fabric.Image.fromURL=function(b,a,c){fabric.util.loadImage(b,function(b){a&&a(new fabric.Image(b,c))},null,c&&c.crossOrigin)},fabric.Image.ATTRIBUTE_NAMES=fabric.SHARED_ATTRIBUTES.concat("x y width height preserveAspectRatio xlink:href".split(" ")),fabric.Image.fromElement=function(d,a,c){d=fabric.parseAttributes(d,fabric.Image.ATTRIBUTE_NAMES);var e="xMidYMid",f="meet",k;d.preserveAspectRatio&&(k=d.preserveAspectRatio.split(" "));k&&k.length&&
(f=k.pop(),"meet"!==f&&"slice"!==f?(e=f,f="meet"):k.length&&(e=k.pop()));k="none"!==e?e.slice(1,4):"none";e="none"!==e?e.slice(5,8):"none";d.alignX=k;d.alignY=e;d.meetOrSlice=f;fabric.Image.fromURL(d["xlink:href"],a,b(c?fabric.util.object.clone(c):{},d))},fabric.Image.async=!0,fabric.Image.pngCompression=1)})("undefined"!==typeof exports?exports:this);
fabric.util.object.extend(fabric.Object.prototype,{_getAngleValueForStraighten:function(){var e=this.getAngle()%360;return 0<e?90*Math.round((e-1)/90):90*Math.round(e/90)},straighten:function(){this.setAngle(this._getAngleValueForStraighten());return this},fxStraighten:function(e){e=e||{};var b=function(){},d=e.onComplete||b,a=e.onChange||b,c=this;fabric.util.animate({startValue:this.get("angle"),endValue:this._getAngleValueForStraighten(),duration:this.FX_DURATION,onChange:function(b){c.setAngle(b);
a()},onComplete:function(){c.setCoords();d()},onStart:function(){c.set("active",!1)}});return this}});fabric.util.object.extend(fabric.StaticCanvas.prototype,{straightenObject:function(e){e.straighten();this.renderAll();return this},fxStraightenObject:function(e){e.fxStraighten({onChange:this.renderAll.bind(this)});return this}});fabric.Image.filters=fabric.Image.filters||{};
fabric.Image.filters.BaseFilter=fabric.util.createClass({type:"BaseFilter",initialize:function(e){e&&this.setOptions(e)},setOptions:function(e){for(var b in e)this[b]=e[b]},toObject:function(){return{type:this.type}},toJSON:function(){return this.toObject()}});
(function(e){var b=e.fabric||(e.fabric={}),d=b.util.object.extend;b.Image.filters.Brightness=b.util.createClass(b.Image.filters.BaseFilter,{type:"Brightness",initialize:function(a){a=a||{};this.brightness=a.brightness||0},applyTo:function(a){var b=a.getContext("2d");a=b.getImageData(0,0,a.width,a.height);for(var d=a.data,f=this.brightness,e=0,l=d.length;e<l;e+=4)d[e]+=f,d[e+1]+=f,d[e+2]+=f;b.putImageData(a,0,0)},toObject:function(){return d(this.callSuper("toObject"),{brightness:this.brightness})}});
b.Image.filters.Brightness.fromObject=function(a){return new b.Image.filters.Brightness(a)}})("undefined"!==typeof exports?exports:this);
(function(e){var b=e.fabric||(e.fabric={}),d=b.util.object.extend;b.Image.filters.Convolute=b.util.createClass(b.Image.filters.BaseFilter,{type:"Convolute",initialize:function(a){a=a||{};this.opaque=a.opaque;this.matrix=a.matrix||[0,0,0,0,1,0,0,0,0];this.tmpCtx=b.util.createCanvasElement().getContext("2d")},_createImageData:function(a,b){return this.tmpCtx.createImageData(a,b)},applyTo:function(a){var b=this.matrix,d=a.getContext("2d"),f=d.getImageData(0,0,a.width,a.height);a=Math.round(Math.sqrt(b.length));
for(var e=Math.floor(a/2),l=f.data,m=f.width,f=f.height,p=this._createImageData(m,f),n=p.data,x=this.opaque?1:0,y=0;y<f;y++)for(var E=0;E<m;E++){for(var u=y,z=E,q=4*(y*m+E),t=0,r=0,v=0,w=0,D=0;D<a;D++)for(var A=0;A<a;A++){var C=u+D-e,H=z+A-e;0>C||C>f||0>H||H>m||(C=4*(C*m+H),H=b[D*a+A],t+=l[C]*H,r+=l[C+1]*H,v+=l[C+2]*H,w+=l[C+3]*H)}n[q]=t;n[q+1]=r;n[q+2]=v;n[q+3]=w+x*(255-w)}d.putImageData(p,0,0)},toObject:function(){return d(this.callSuper("toObject"),{opaque:this.opaque,matrix:this.matrix})}});b.Image.filters.Convolute.fromObject=
function(a){return new b.Image.filters.Convolute(a)}})("undefined"!==typeof exports?exports:this);
(function(e){var b=e.fabric||(e.fabric={}),d=b.util.object.extend;b.Image.filters.GradientTransparency=b.util.createClass(b.Image.filters.BaseFilter,{type:"GradientTransparency",initialize:function(a){a=a||{};this.threshold=a.threshold||100},applyTo:function(a){var b=a.getContext("2d");a=b.getImageData(0,0,a.width,a.height);for(var d=a.data,f=this.threshold,e=d.length,l=0,m=d.length;l<m;l+=4)d[l+3]=f+255*(e-l)/e;b.putImageData(a,0,0)},toObject:function(){return d(this.callSuper("toObject"),{threshold:this.threshold})}});
b.Image.filters.GradientTransparency.fromObject=function(a){return new b.Image.filters.GradientTransparency(a)}})("undefined"!==typeof exports?exports:this);
(function(e){var b=e.fabric||(e.fabric={});b.Image.filters.Grayscale=b.util.createClass(b.Image.filters.BaseFilter,{type:"Grayscale",applyTo:function(b){var a=b.getContext("2d");b=a.getImageData(0,0,b.width,b.height);for(var c=b.data,e=b.width*b.height*4,f=0,k;f<e;)k=(c[f]+c[f+1]+c[f+2])/3,c[f]=k,c[f+1]=k,c[f+2]=k,f+=4;a.putImageData(b,0,0)}});b.Image.filters.Grayscale.fromObject=function(){return new b.Image.filters.Grayscale}})("undefined"!==typeof exports?exports:this);
(function(e){var b=e.fabric||(e.fabric={});b.Image.filters.Invert=b.util.createClass(b.Image.filters.BaseFilter,{type:"Invert",applyTo:function(b){var a=b.getContext("2d");b=a.getImageData(0,0,b.width,b.height);var c=b.data,e=c.length,f;for(f=0;f<e;f+=4)c[f]=255-c[f],c[f+1]=255-c[f+1],c[f+2]=255-c[f+2];a.putImageData(b,0,0)}});b.Image.filters.Invert.fromObject=function(){return new b.Image.filters.Invert}})("undefined"!==typeof exports?exports:this);
(function(e){var b=e.fabric||(e.fabric={}),d=b.util.object.extend;b.Image.filters.Mask=b.util.createClass(b.Image.filters.BaseFilter,{type:"Mask",initialize:function(a){a=a||{};this.mask=a.mask;this.channel=-1<[0,1,2,3].indexOf(a.channel)?a.channel:0},applyTo:function(a){if(this.mask){var c=a.getContext("2d");a=c.getImageData(0,0,a.width,a.height);var d=a.data,f=this.mask.getElement(),e=b.util.createCanvasElement(),l=this.channel,m=a.width*a.height*4;e.width=f.width;e.height=f.height;e.getContext("2d").drawImage(f,
0,0,f.width,f.height);e=e.getContext("2d").getImageData(0,0,f.width,f.height).data;for(f=0;f<m;f+=4)d[f+3]=e[f+l];c.putImageData(a,0,0)}},toObject:function(){return d(this.callSuper("toObject"),{mask:this.mask.toObject(),channel:this.channel})}});b.Image.filters.Mask.fromObject=function(a,c){b.util.loadImage(a.mask.src,function(d){a.mask=new b.Image(d,a.mask);c&&c(new b.Image.filters.Mask(a))})};b.Image.filters.Mask.async=!0})("undefined"!==typeof exports?exports:this);
(function(e){var b=e.fabric||(e.fabric={}),d=b.util.object.extend;b.Image.filters.Noise=b.util.createClass(b.Image.filters.BaseFilter,{type:"Noise",initialize:function(a){a=a||{};this.noise=a.noise||0},applyTo:function(a){var b=a.getContext("2d");a=b.getImageData(0,0,a.width,a.height);for(var d=a.data,f=this.noise,e,l=0,m=d.length;l<m;l+=4)e=(.5-Math.random())*f,d[l]+=e,d[l+1]+=e,d[l+2]+=e;b.putImageData(a,0,0)},toObject:function(){return d(this.callSuper("toObject"),{noise:this.noise})}});b.Image.filters.Noise.fromObject=
function(a){return new b.Image.filters.Noise(a)}})("undefined"!==typeof exports?exports:this);
(function(e){var b=e.fabric||(e.fabric={}),d=b.util.object.extend;b.Image.filters.Pixelate=b.util.createClass(b.Image.filters.BaseFilter,{type:"Pixelate",initialize:function(a){a=a||{};this.blocksize=a.blocksize||4},applyTo:function(a){var b=a.getContext("2d");a=b.getImageData(0,0,a.width,a.height);var d=a.data,f=a.height,e=a.width,l,m,p,n,x,y,E;for(m=0;m<f;m+=this.blocksize)for(p=0;p<e;p+=this.blocksize){l=4*m*e+4*p;n=d[l];x=d[l+1];y=d[l+2];E=d[l+3];for(var u=m,z=m+this.blocksize;u<z;u++)for(var q=
p,t=p+this.blocksize;q<t;q++)l=4*u*e+4*q,d[l]=n,d[l+1]=x,d[l+2]=y,d[l+3]=E}b.putImageData(a,0,0)},toObject:function(){return d(this.callSuper("toObject"),{blocksize:this.blocksize})}});b.Image.filters.Pixelate.fromObject=function(a){return new b.Image.filters.Pixelate(a)}})("undefined"!==typeof exports?exports:this);
(function(e){var b=e.fabric||(e.fabric={}),d=b.util.object.extend;b.Image.filters.RemoveWhite=b.util.createClass(b.Image.filters.BaseFilter,{type:"RemoveWhite",initialize:function(a){a=a||{};this.threshold=a.threshold||30;this.distance=a.distance||20},applyTo:function(a){var b=a.getContext("2d");a=b.getImageData(0,0,a.width,a.height);for(var d=a.data,f=this.distance,e=255-this.threshold,l=Math.abs,m,p,n,x=0,y=d.length;x<y;x+=4)m=d[x],p=d[x+1],n=d[x+2],m>e&&p>e&&n>e&&l(m-p)<f&&l(m-n)<f&&l(p-n)<f&&
(d[x+3]=1);b.putImageData(a,0,0)},toObject:function(){return d(this.callSuper("toObject"),{threshold:this.threshold,distance:this.distance})}});b.Image.filters.RemoveWhite.fromObject=function(a){return new b.Image.filters.RemoveWhite(a)}})("undefined"!==typeof exports?exports:this);
(function(e){var b=e.fabric||(e.fabric={});b.Image.filters.Sepia=b.util.createClass(b.Image.filters.BaseFilter,{type:"Sepia",applyTo:function(b){var a=b.getContext("2d");b=a.getImageData(0,0,b.width,b.height);var c=b.data,e=c.length,f,k;for(f=0;f<e;f+=4)k=.3*c[f]+.59*c[f+1]+.11*c[f+2],c[f]=k+100,c[f+1]=k+50,c[f+2]=k+255;a.putImageData(b,0,0)}});b.Image.filters.Sepia.fromObject=function(){return new b.Image.filters.Sepia}})("undefined"!==typeof exports?exports:this);
(function(e){var b=e.fabric||(e.fabric={});b.Image.filters.Sepia2=b.util.createClass(b.Image.filters.BaseFilter,{type:"Sepia2",applyTo:function(b){var a=b.getContext("2d");b=a.getImageData(0,0,b.width,b.height);var c=b.data,e=c.length,f,k,l,m;for(f=0;f<e;f+=4)k=c[f],l=c[f+1],m=c[f+2],c[f]=(.393*k+.769*l+.189*m)/1.351,c[f+1]=(.349*k+.686*l+.168*m)/1.203,c[f+2]=(.272*k+.534*l+.131*m)/2.14;a.putImageData(b,0,0)}});b.Image.filters.Sepia2.fromObject=function(){return new b.Image.filters.Sepia2}})("undefined"!==
typeof exports?exports:this);
(function(e){var b=e.fabric||(e.fabric={}),d=b.util.object.extend;b.Image.filters.Tint=b.util.createClass(b.Image.filters.BaseFilter,{type:"Tint",initialize:function(a){a=a||{};this.color=a.color||"#000000";this.opacity="undefined"!==typeof a.opacity?a.opacity:(new b.Color(this.color)).getAlpha()},applyTo:function(a){var c=a.getContext("2d");a=c.getImageData(0,0,a.width,a.height);var d=a.data,f=d.length,e,l,m,p,n,x,y,E;e=(new b.Color(this.color)).getSource();l=e[0]*this.opacity;m=e[1]*this.opacity;
p=e[2]*this.opacity;E=1-this.opacity;for(e=0;e<f;e+=4)n=d[e],x=d[e+1],y=d[e+2],d[e]=l+n*E,d[e+1]=m+x*E,d[e+2]=p+y*E;c.putImageData(a,0,0)},toObject:function(){return d(this.callSuper("toObject"),{color:this.color,opacity:this.opacity})}});b.Image.filters.Tint.fromObject=function(a){return new b.Image.filters.Tint(a)}})("undefined"!==typeof exports?exports:this);
(function(e){var b=e.fabric||(e.fabric={}),d=b.util.object.extend;b.Image.filters.Multiply=b.util.createClass(b.Image.filters.BaseFilter,{type:"Multiply",initialize:function(a){a=a||{};this.color=a.color||"#000000"},applyTo:function(a){var c=a.getContext("2d");a=c.getImageData(0,0,a.width,a.height);var d=a.data,f=d.length,e,l;l=(new b.Color(this.color)).getSource();for(e=0;e<f;e+=4)d[e]*=l[0]/255,d[e+1]*=l[1]/255,d[e+2]*=l[2]/255;c.putImageData(a,0,0)},toObject:function(){return d(this.callSuper("toObject"),
{color:this.color})}});b.Image.filters.Multiply.fromObject=function(a){return new b.Image.filters.Multiply(a)}})("undefined"!==typeof exports?exports:this);
(function(e){var b=e.fabric;b.Image.filters.Blend=b.util.createClass({type:"Blend",initialize:function(b){b=b||{};this.color=b.color||"#000";this.image=b.image||!1;this.mode=b.mode||"multiply";this.alpha=b.alpha||1},applyTo:function(d){var a=d.getContext("2d");d=a.getImageData(0,0,d.width,d.height);var c=d.data,e,f,k,l,m,p,n,x=!1;this.image?(x=!0,n=b.util.createCanvasElement(),n.width=this.image.width,n.height=this.image.height,n=new b.StaticCanvas(n),n.add(this.image),n=n.getContext("2d").getImageData(0,
0,n.width,n.height).data):(n=(new b.Color(this.color)).getSource(),e=n[0]*this.alpha,f=n[1]*this.alpha,k=n[2]*this.alpha);for(var y=0,E=c.length;y<E;y+=4)switch(l=c[y],m=c[y+1],p=c[y+2],x&&(e=n[y]*this.alpha,f=n[y+1]*this.alpha,k=n[y+2]*this.alpha),this.mode){case "multiply":c[y]=l*e/255;c[y+1]=m*f/255;c[y+2]=p*k/255;break;case "screen":c[y]=1-(1-l)*(1-e);c[y+1]=1-(1-m)*(1-f);c[y+2]=1-(1-p)*(1-k);break;case "add":c[y]=Math.min(255,l+e);c[y+1]=Math.min(255,m+f);c[y+2]=Math.min(255,p+k);break;case "diff":case "difference":c[y]=
Math.abs(l-e);c[y+1]=Math.abs(m-f);c[y+2]=Math.abs(p-k);break;case "subtract":l-=e;m-=f;p-=k;c[y]=0>l?0:l;c[y+1]=0>m?0:m;c[y+2]=0>p?0:p;break;case "darken":c[y]=Math.min(l,e);c[y+1]=Math.min(m,f);c[y+2]=Math.min(p,k);break;case "lighten":c[y]=Math.max(l,e),c[y+1]=Math.max(m,f),c[y+2]=Math.max(p,k)}a.putImageData(d,0,0)},toObject:function(){return{color:this.color,image:this.image,mode:this.mode,alpha:this.alpha}}});b.Image.filters.Blend.fromObject=function(d){return new b.Image.filters.Blend(d)}})("undefined"!==
typeof exports?exports:this);
(function(e){var b=e.fabric||(e.fabric={}),d=Math.pow,a=Math.floor,c=Math.sqrt,g=Math.abs,f=Math.max,k=Math.round,l=Math.sin,m=Math.ceil;b.Image.filters.Resize=b.util.createClass(b.Image.filters.BaseFilter,{type:"Resize",resizeType:"hermite",scaleX:0,scaleY:0,lanczosLobes:3,applyTo:function(a,b,c){this.rcpScaleX=1/b;this.rcpScaleY=1/c;var d=a.width,e=a.height;b=k(d*b);c=k(e*c);var f;"sliceHack"===this.resizeType&&(f=this.sliceByTwo(a,d,e,b,c));"hermite"===this.resizeType&&(f=this.hermiteFastResize(a,
d,e,b,c));"bilinear"===this.resizeType&&(f=this.bilinearFiltering(a,d,e,b,c));"lanczos"===this.resizeType&&(f=this.lanczosResize(a,d,e,b,c));a.width=b;a.height=c;a.getContext("2d").putImageData(f,0,0)},sliceByTwo:function(c,d,e,g,k){var l=c.getContext("2d"),m,q=.5,t=.5,r=1,v=1,w=!1,D=!1,A=d,C=e,H=b.util.createCanvasElement(),F=H.getContext("2d");g=a(g);k=a(k);H.width=f(g,d);H.height=f(k,e);g>d&&(q=2,r=-1);k>e&&(t=2,v=-1);m=l.getImageData(0,0,d,e);c.width=f(g,d);c.height=f(k,e);for(l.putImageData(m,
0,0);!w||!D;)d=A,e=C,g*r<a(A*q*r)?A=a(A*q):(A=g,w=!0),k*v<a(C*t*v)?C=a(C*t):(C=k,D=!0),m=l.getImageData(0,0,d,e),F.putImageData(m,0,0),l.clearRect(0,0,A,C),l.drawImage(H,0,0,d,e,0,0,A,C);return l.getImageData(0,0,g,k)},lanczosResize:function(b,e,f,k,E){var u,z,q,t;function r(b){var l,m,p,v,Q,ea,Y,S,V,aa;q=(b+.5)*H;u=a(q);for(l=0;l<E;l++){t=(l+.5)*F;z=a(t);V=S=Y=ea=Q=0;for(m=u-P;m<=u+P;m++)if(!(0>m||m>=e)){aa=a(1E3*g(m-q));ca[aa]||(ca[aa]={});for(var ba=z-Z;ba<=z+Z;ba++)0>ba||ba>=f||(p=a(1E3*g(ba-
t)),ca[aa][p]||(ca[aa][p]=C(c(d(aa*I,2)+d(p*N,2))/1E3)),p=ca[aa][p],0<p&&(v=4*(ba*e+m),Q+=p,ea+=p*D[v],Y+=p*D[v+1],S+=p*D[v+2],V+=p*D[v+3]))}v=4*(l*k+b);A[v]=ea/Q;A[v+1]=Y/Q;A[v+2]=S/Q;A[v+3]=V/Q}return++b<k?r(b):w}b=b.getContext("2d");var v=b.getImageData(0,0,e,f),w=b.getImageData(0,0,k,E),D=v.data,A=w.data,C=function(a){return function(b){if(b>a)return 0;b*=Math.PI;if(1E-16>g(b))return 1;var c=b/a;return l(b)*l(c)/b/c}}(this.lanczosLobes),H=this.rcpScaleX,F=this.rcpScaleY,I=2/this.rcpScaleX,N=2/
this.rcpScaleY,P=m(H*this.lanczosLobes/2),Z=m(F*this.lanczosLobes/2),ca={};z=u=t=q=void 0;return r(0)},bilinearFiltering:function(b,c,d,e,f){var g,k,l,m,r,v,w,D,A,C,H=0,F=this.rcpScaleX,I=this.rcpScaleY;w=b.getContext("2d");b=4*(c-1);d=w.getImageData(0,0,c,d).data;var N=w.getImageData(0,0,e,f),P=N.data;for(w=0;w<f;w++)for(D=0;D<e;D++)for(r=a(F*D),v=a(I*w),A=F*D-r,C=I*w-v,v=4*(v*c+r),r=0;4>r;r++)g=d[v+r],k=d[v+4+r],l=d[v+b+r],m=d[v+b+4+r],g=g*(1-A)*(1-C)+k*A*(1-C)+l*C*(1-A)+m*A*C,P[H++]=g;return N},
hermiteFastResize:function(b,d,e,f,k){var l=this.rcpScaleX,z=this.rcpScaleY,q=m(l/2),t=m(z/2);b=b.getContext("2d");e=b.getImageData(0,0,d,e).data;b=b.getImageData(0,0,f,k);for(var r=b.data,v=0;v<k;v++)for(var w=0;w<f;w++){for(var D=4*(w+v*f),A=0,C=0,H=0,F=0,I=0,N=0,P=0,Z=(v+.5)*z,ca=a(v*z);ca<(v+1)*z;ca++)for(var U=g(Z-(ca+.5))/t,za=(w+.5)*l,U=U*U,ka=a(w*l);ka<(w+1)*l;ka++){var X=g(za-(ka+.5))/q,A=c(U+X*X);1<A&&-1>A||(A=2*A*A*A-3*A*A+1,0<A&&(X=4*(ka+ca*d),P+=A*e[X+3],H+=A,255>e[X+3]&&(A=A*e[X+3]/
250),F+=A*e[X],I+=A*e[X+1],N+=A*e[X+2],C+=A))}r[D]=F/C;r[D+1]=I/C;r[D+2]=N/C;r[D+3]=P/H}return b},toObject:function(){return{type:this.type,scaleX:this.scaleX,scaley:this.scaleY,resizeType:this.resizeType,lanczosLobes:this.lanczosLobes}}});b.Image.filters.Resize.fromObject=function(){return new b.Image.filters.Resize}})("undefined"!==typeof exports?exports:this);
(function(e){var b=e.fabric||(e.fabric={}),d=b.util.object.extend,a=b.util.object.clone,c=b.util.toFixed,g=b.StaticCanvas.supports("setLineDash");b.Text?b.warn("fabric.Text is already defined"):(e=b.Object.prototype.stateProperties.concat(),e.push("fontFamily","fontWeight","fontSize","text","textDecoration","textAlign","fontStyle","lineHeight","textBackgroundColor"),b.Text=b.util.createClass(b.Object,{_dimensionAffectingProps:{fontSize:!0,fontWeight:!0,fontFamily:!0,fontStyle:!0,lineHeight:!0,stroke:!0,
strokeWidth:!0,text:!0,textAlign:!0},_reNewline:/\r?\n/,type:"text",fontSize:40,fontWeight:"normal",fontFamily:"Times New Roman",textDecoration:"",textAlign:"left",fontStyle:"",lineHeight:1.16,textBackgroundColor:"",stateProperties:e,stroke:null,shadow:null,_fontSizeFraction:.25,_fontSizeMult:1.13,initialize:function(a,b){b=b||{};this.text=a;this.__skipDimension=!0;this.setOptions(b);this.__skipDimension=!1;this._initDimensions()},_initDimensions:function(a){if(!this.__skipDimension){a||(a=b.util.createCanvasElement().getContext("2d"),
this._setTextStyles(a));this._textLines=this.text.split(this._reNewline);this._clearCache();var c=this.textAlign;this.textAlign="left";this.width=this._getTextWidth(a);this.textAlign=c;this.height=this._getTextHeight(a)}},toString:function(){return"#<fabric.Text ("+this.complexity()+'): { "text": "'+this.text+'", "fontFamily": "'+this.fontFamily+'" }>'},_render:function(a){this.clipTo&&b.util.clipContext(this,a);this._renderTextBackground(a);this._renderText(a);this._renderTextDecoration(a);this.clipTo&&
a.restore()},_renderText:function(a){a.save();this._translateForTextAlign(a);this._setOpacity(a);this._setShadow(a);this._setupCompositeOperation(a);this._renderTextFill(a);this._renderTextStroke(a);this._restoreCompositeOperation(a);this._removeShadow(a);a.restore()},_translateForTextAlign:function(a){"left"!==this.textAlign&&"justify"!==this.textAlign&&a.translate("center"===this.textAlign?this.width/2:this.width,0)},_setTextStyles:function(a){a.textBaseline="alphabetic";this.skipTextAlign||(a.textAlign=
this.textAlign);a.font=this._getFontDeclaration()},_getTextHeight:function(){return this._textLines.length*this._getHeightOfLine()},_getTextWidth:function(a){for(var b=this._getLineWidth(a,0),c=1,d=this._textLines.length;c<d;c++){var e=this._getLineWidth(a,c);e>b&&(b=e)}return b},_renderChars:function(a,b,c,d,e){b[a](c,d,e)},_renderTextLine:function(a,b,c,d,e,g){e-=this.fontSize*this._fontSizeFraction;if("justify"!==this.textAlign)this._renderChars(a,b,c,d,e,g);else{var x=this._getLineWidth(b,g),
y=this.width;if(y>=x){x=c.split(/\s+/);c=this._getWidthOfWords(b,c,g);for(var y=(y-c)/(x.length-1),E=c=0,u=x.length;E<u;E++)this._renderChars(a,b,x[E],d+c,e,g),c+=b.measureText(x[E]).width+y}else this._renderChars(a,b,c,d,e,g)}},_getWidthOfWords:function(a,b){return a.measureText(b.replace(/\s+/g,"")).width},_getLeftOffset:function(){return-this.width/2},_getTopOffset:function(){return-this.height/2},_renderTextFill:function(a){if(this.fill||this._skipFillStrokeCheck){for(var b=0,c=0,d=this._textLines.length;c<
d;c++){var e=this._getHeightOfLine(a,c),g=e/this.lineHeight;this._renderTextLine("fillText",a,this._textLines[c],this._getLeftOffset(),this._getTopOffset()+b+g,c);b+=e}this.shadow&&!this.shadow.affectStroke&&this._removeShadow(a)}},_renderTextStroke:function(a){if(this.stroke&&0!==this.strokeWidth||this._skipFillStrokeCheck){var b=0;a.save();this.strokeDashArray&&(1&this.strokeDashArray.length&&this.strokeDashArray.push.apply(this.strokeDashArray,this.strokeDashArray),g&&a.setLineDash(this.strokeDashArray));
a.beginPath();for(var c=0,d=this._textLines.length;c<d;c++){var e=this._getHeightOfLine(a,c),n=e/this.lineHeight;this._renderTextLine("strokeText",a,this._textLines[c],this._getLeftOffset(),this._getTopOffset()+b+n,c);b+=e}a.closePath();a.restore()}},_getHeightOfLine:function(){return this.fontSize*this._fontSizeMult*this.lineHeight},_renderTextBackground:function(a){this._renderTextBoxBackground(a);this._renderTextLinesBackground(a)},_renderTextBoxBackground:function(a){this.backgroundColor&&(a.save(),
a.fillStyle=this.backgroundColor,a.fillRect(this._getLeftOffset(),this._getTopOffset(),this.width,this.height),a.restore())},_renderTextLinesBackground:function(a){var b=0,c=this._getHeightOfLine();if(this.textBackgroundColor){a.save();a.fillStyle=this.textBackgroundColor;for(var d=0,e=this._textLines.length;d<e;d++){if(""!==this._textLines[d]){var g=this._getLineWidth(a,d),x=this._getLineLeftOffset(g);a.fillRect(this._getLeftOffset()+x,this._getTopOffset()+b,g,this.fontSize*this._fontSizeMult)}b+=
c}a.restore()}},_getLineLeftOffset:function(a){return"center"===this.textAlign?(this.width-a)/2:"right"===this.textAlign?this.width-a:0},_clearCache:function(){this.__lineWidths=[];this.__lineHeights=[];this.__lineOffsets=[]},_shouldClearCache:function(){var a=!1,b;for(b in this._dimensionAffectingProps)this["__"+b]!==this[b]&&(this["__"+b]=this[b],a=!0);return a},_getLineWidth:function(a,b){if(this.__lineWidths[b])return this.__lineWidths[b];this.__lineWidths[b]=a.measureText(this._textLines[b]).width;
return this.__lineWidths[b]},_renderTextDecoration:function(a){if(this.textDecoration){var b=this.height/2,c=[];-1<this.textDecoration.indexOf("underline")&&c.push(.85);-1<this.textDecoration.indexOf("line-through")&&c.push(.43);-1<this.textDecoration.indexOf("overline")&&c.push(-.12);if(0<c.length){var d,e=0,g,x,y;d=0;for(g=this._textLines.length;d<g;d++){var E=this._getLineWidth(a,d),u=this._getLineLeftOffset(E),z=this._getHeightOfLine(a,d);x=0;for(y=c.length;x<y;x++)a.fillRect(this._getLeftOffset()+
u,e+(this._fontSizeMult-1+c[x])*this.fontSize-b,E,this.fontSize/15);e+=z}}}},_getFontDeclaration:function(){return[b.isLikelyNode?this.fontWeight:this.fontStyle,b.isLikelyNode?this.fontStyle:this.fontWeight,this.fontSize+"px",b.isLikelyNode?'"'+this.fontFamily+'"':this.fontFamily].join(" ")},render:function(a,b){this.visible&&(a.save(),this._setTextStyles(a),this._shouldClearCache()&&this._initDimensions(a),b||this.transform(a),this._setStrokeStyles(a),this._setFillStyles(a),this.transformMatrix&&
a.transform.apply(a,this.transformMatrix),this.group&&"path-group"===this.group.type&&a.translate(this.left,this.top),this._render(a),a.restore())},toObject:function(a){a=d(this.callSuper("toObject",a),{text:this.text,fontSize:this.fontSize,fontWeight:this.fontWeight,fontFamily:this.fontFamily,fontStyle:this.fontStyle,lineHeight:this.lineHeight,textDecoration:this.textDecoration,textAlign:this.textAlign,textBackgroundColor:this.textBackgroundColor});this.includeDefaultValues||this._removeDefaultValues(a);
return a},toSVG:function(a){var b=this._createBaseSVGMarkup(),c=this._getSVGLeftTopOffsets(this.ctx),c=this._getSVGTextAndBg(c.textTop,c.textLeft);this._wrapSVGTextAndBg(b,c);return a?a(b.join("")):b.join("")},_getSVGLeftTopOffsets:function(a){a=this._getHeightOfLine(a,0);return{textLeft:-this.width/2+(this.group&&"path-group"===this.group.type?this.left:0),textTop:0+(this.group&&"path-group"===this.group.type?-this.top:0),lineTop:a}},_wrapSVGTextAndBg:function(a,b){a.push('\t<g transform="',this.getSvgTransform(),
this.getSvgTransformMatrix(),'">\n',b.textBgRects.join(""),"\t\t<text ",this.fontFamily?'font-family="'+this.fontFamily.replace(/"/g,"'")+'" ':"",this.fontSize?'font-size="'+this.fontSize+'" ':"",this.fontStyle?'font-style="'+this.fontStyle+'" ':"",this.fontWeight?'font-weight="'+this.fontWeight+'" ':"",this.textDecoration?'text-decoration="'+this.textDecoration+'" ':"",'style="',this.getSvgStyles(),'" >',b.textSpans.join(""),"</text>\n","\t</g>\n")},_getSVGTextAndBg:function(a,b){var c=[],d=[],e=
0;this._setSVGBg(d);for(var g=0,x=this._textLines.length;g<x;g++)this.textBackgroundColor&&this._setSVGTextLineBg(d,g,b,a,e),this._setSVGTextLineText(g,c,e,b,a,d),e+=this._getHeightOfLine(this.ctx,g);return{textSpans:c,textBgRects:d}},_setSVGTextLineText:function(a,d,e,g,p){e=this.fontSize*(this._fontSizeMult-this._fontSizeFraction)-p+e-this.height/2;d.push('<tspan x="',c(g+this._getLineLeftOffset(this.__lineWidths[a]),4),'" ','y="',c(e,4),'" ',this._getFillAttributes(this.fill),">",b.util.string.escapeXml(this._textLines[a]),
"</tspan>")},_setSVGTextLineBg:function(a,b,d,e,g){a.push("\t\t<rect ",this._getFillAttributes(this.textBackgroundColor),' x="',c(d+this._getLineLeftOffset(this.__lineWidths[b]),4),'" y="',c(g-this.height/2,4),'" width="',c(this.__lineWidths[b],4),'" height="',c(this._getHeightOfLine(this.ctx,b)/this.lineHeight,4),'"></rect>\n')},_setSVGBg:function(a){this.backgroundColor&&a.push("\t\t<rect ",this._getFillAttributes(this.backgroundColor),' x="',c(-this.width/2,4),'" y="',c(-this.height/2,4),'" width="',
c(this.width,4),'" height="',c(this.height,4),'"></rect>\n')},_getFillAttributes:function(a){var c=a&&"string"===typeof a?new b.Color(a):"";return c&&c.getSource()&&1!==c.getAlpha()?'opacity="'+c.getAlpha()+'" fill="'+c.setAlpha(1).toRgb()+'"':'fill="'+a+'"'},_set:function(a,b){this.callSuper("_set",a,b);a in this._dimensionAffectingProps&&(this._initDimensions(),this.setCoords())},complexity:function(){return 1}}),b.Text.ATTRIBUTE_NAMES=b.SHARED_ATTRIBUTES.concat("x y dx dy font-family font-style font-weight font-size text-decoration text-anchor".split(" ")),
b.Text.DEFAULT_SVG_FONT_SIZE=16,b.Text.fromElement=function(a,c){if(!a)return null;var d=b.parseAttributes(a,b.Text.ATTRIBUTE_NAMES);c=b.util.object.extend(c?b.util.object.clone(c):{},d);c.top=c.top||0;c.left=c.left||0;"dx"in d&&(c.left+=d.dx);"dy"in d&&(c.top+=d.dy);"fontSize"in c||(c.fontSize=b.Text.DEFAULT_SVG_FONT_SIZE);c.originX||(c.originX="left");var d=a.textContent.replace(/^\s+|\s+$|\n+/g,"").replace(/\s+/g," "),d=new b.Text(d,c),e=0;"left"===d.originX&&(e=d.getWidth()/2);"right"===d.originX&&
(e=-d.getWidth()/2);d.set({left:d.getLeft()+e,top:d.getTop()-d.getHeight()/2+d.fontSize*(.18+d._fontSizeFraction)});return d},b.Text.fromObject=function(c){return new b.Text(c.text,a(c))},b.util.createAccessors(b.Text))})("undefined"!==typeof exports?exports:this);
(function(){var e=fabric.util.object.clone;fabric.IText=fabric.util.createClass(fabric.Text,fabric.Observable,{type:"i-text",selectionStart:0,selectionEnd:0,selectionColor:"rgba(17,119,255,0.3)",isEditing:!1,editable:!0,editingBorderColor:"rgba(102,153,255,0.25)",cursorWidth:2,cursorColor:"#333",cursorDelay:1E3,cursorDuration:600,styles:null,caching:!0,_skipFillStrokeCheck:!1,_reSpace:/\s|\n/,_currentCursorOpacity:0,_selectionDirection:null,_abortCursorAnimation:!1,_charWidthsCache:{},initialize:function(b,
d){this.styles=d?d.styles||{}:{};this.callSuper("initialize",b,d);this.initBehavior()},_clearCache:function(){this.callSuper("_clearCache");this.__maxFontHeights=[];this.__widthOfSpace=[]},isEmptyStyles:function(){if(!this.styles)return!0;var b=this.styles,d;for(d in b)for(var a in b[d])for(var c in b[d][a])return!1;return!0},setSelectionStart:function(b){b=Math.max(b,0);this.selectionStart!==b&&(this.fire("selection:changed"),this.canvas&&this.canvas.fire("text:selection:changed",{target:this}),
this.selectionStart=b);this._updateTextarea()},setSelectionEnd:function(b){b=Math.min(b,this.text.length);this.selectionEnd!==b&&(this.fire("selection:changed"),this.canvas&&this.canvas.fire("text:selection:changed",{target:this}),this.selectionEnd=b);this._updateTextarea()},getSelectionStyles:function(b,d){if(2===arguments.length){for(var a=[],c=b;c<d;c++)a.push(this.getSelectionStyles(c));return a}a=this.get2DCursorLocation(b);return this.styles[a.lineIndex]?this.styles[a.lineIndex][a.charIndex]||
{}:{}},setSelectionStyles:function(b){if(this.selectionStart===this.selectionEnd)this._extendStyles(this.selectionStart,b);else for(var d=this.selectionStart;d<this.selectionEnd;d++)this._extendStyles(d,b);this._clearCache();return this},_extendStyles:function(b,d){var a=this.get2DCursorLocation(b);this.styles[a.lineIndex]||(this.styles[a.lineIndex]={});this.styles[a.lineIndex][a.charIndex]||(this.styles[a.lineIndex][a.charIndex]={});fabric.util.object.extend(this.styles[a.lineIndex][a.charIndex],
d)},_render:function(b){this.callSuper("_render",b);this.ctx=b;this.isEditing&&this.renderCursorOrSelection()},renderCursorOrSelection:function(){if(this.active){var b=this.text.split(""),d,a;this.canvas.contextTop?(a=this.canvas.contextTop,a.save(),a.transform.apply(a,this.canvas.viewportTransform),this.transform(a)):(a=this.ctx,a.save());this.selectionStart===this.selectionEnd?(d=this._getCursorBoundaries(b,"cursor"),this.renderCursor(d,a)):(d=this._getCursorBoundaries(b,"selection"),this.renderSelection(b,
d,a));a.restore()}},get2DCursorLocation:function(b){"undefined"===typeof b&&(b=this.selectionStart);b=this.text.slice(0,b).split(this._reNewline);return{lineIndex:b.length-1,charIndex:b[b.length-1].length}},getCurrentCharStyle:function(b,d){var a=this.styles[b]&&this.styles[b][0===d?0:d-1];return{fontSize:a&&a.fontSize||this.fontSize,fill:a&&a.fill||this.fill,textBackgroundColor:a&&a.textBackgroundColor||this.textBackgroundColor,textDecoration:a&&a.textDecoration||this.textDecoration,fontFamily:a&&
a.fontFamily||this.fontFamily,fontWeight:a&&a.fontWeight||this.fontWeight,fontStyle:a&&a.fontStyle||this.fontStyle,stroke:a&&a.stroke||this.stroke,strokeWidth:a&&a.strokeWidth||this.strokeWidth}},getCurrentCharFontSize:function(b,d){return this.styles[b]&&this.styles[b][0===d?0:d-1]&&this.styles[b][0===d?0:d-1].fontSize||this.fontSize},getCurrentCharColor:function(b,d){return this.styles[b]&&this.styles[b][0===d?0:d-1]&&this.styles[b][0===d?0:d-1].fill||this.cursorColor},_getCursorBoundaries:function(b,
d){var a=Math.round(this._getLeftOffset()),c=this._getTopOffset(),e=this._getCursorBoundariesOffsets(b,d);return{left:a,top:c,leftOffset:e.left+e.lineLeft,topOffset:e.top}},_getCursorBoundariesOffsets:function(b,d){for(var a=0,c=0,e=0,f=0,k=0,l=0;l<this.selectionStart;l++)"\n"===b[l]?(k=0,f+=this._getHeightOfLine(this.ctx,c),c++,e=0):(k+=this._getWidthOfChar(this.ctx,b[l],c,e),e++),a=this._getCachedLineOffset(c);"cursor"===d&&(f+=(1-this._fontSizeFraction)*this._getHeightOfLine(this.ctx,c)/this.lineHeight-
this.getCurrentCharFontSize(c,e)*(1-this._fontSizeFraction));return{top:f,left:k,lineLeft:a}},_getCachedLineOffset:function(b){var d=this._getLineWidth(this.ctx,b);return this.__lineOffsets[b]||(this.__lineOffsets[b]=this._getLineLeftOffset(d))},renderCursor:function(b,d){var a=this.get2DCursorLocation(),c=a.lineIndex,a=a.charIndex,e=this.getCurrentCharFontSize(c,a),f=0===c&&0===a?this._getCachedLineOffset(c):b.leftOffset;d.fillStyle=this.getCurrentCharColor(c,a);d.globalAlpha=this.__isMousedown?
1:this._currentCursorOpacity;d.fillRect(b.left+f,b.top+b.topOffset,this.cursorWidth/this.scaleX,e)},renderSelection:function(b,d,a){a.fillStyle=this.selectionColor;b=this.get2DCursorLocation(this.selectionStart);for(var c=this.get2DCursorLocation(this.selectionEnd),e=b.lineIndex,f=c.lineIndex,k=e;k<=f;k++){var l=this._getCachedLineOffset(k)||0,m=this._getHeightOfLine(this.ctx,k),p=0,n=this._textLines[k];if(k===e)for(var x=0,y=n.length;x<y;x++)x>=b.charIndex&&(k!==f||x<c.charIndex)&&(p+=this._getWidthOfChar(a,
n[x],k,x)),x<b.charIndex&&(l+=this._getWidthOfChar(a,n[x],k,x));else if(k>e&&k<f)p+=this._getLineWidth(a,k)||5;else if(k===f)for(x=0,y=c.charIndex;x<y;x++)p+=this._getWidthOfChar(a,n[x],k,x);a.fillRect(d.left+l,d.top+d.topOffset,p,m);d.topOffset+=m}},_renderChars:function(b,d,a,c,e,f){if(this.isEmptyStyles())return this._renderCharsFast(b,d,a,c,e);this.skipTextAlign=!0;c-="center"===this.textAlign?this.width/2:"right"===this.textAlign?this.width:0;var k=this._getHeightOfLine(d,f),l=this._getCachedLineOffset(f);
a=a.split("");var m,p="";c+=l||0;d.save();e-=k/this.lineHeight*this._fontSizeFraction;for(var l=0,n=a.length;l<=n;l++){m=m||this.getCurrentCharStyle(f,l);var x=this.getCurrentCharStyle(f,l+1);if(this._hasStyleChanged(m,x)||l===n)this._renderChar(b,d,f,l-1,p,c,e,k),p="",m=x;p+=a[l]}d.restore()},_renderCharsFast:function(b,d,a,c,e){this.skipTextAlign=!1;"fillText"===b&&this.fill&&this.callSuper("_renderChars",b,d,a,c,e);"strokeText"===b&&(this.stroke&&0<this.strokeWidth||this.skipFillStrokeCheck)&&
this.callSuper("_renderChars",b,d,a,c,e)},_renderChar:function(b,d,a,c,e,f,k,l){var m;l=this._fontSizeFraction*l/this.lineHeight;if(this.styles&&this.styles[a]&&(m=this.styles[a][c])){var p=m.stroke||this.stroke,n=m.fill||this.fill;d.save();b=this._applyCharStylesGetWidth(d,e,a,c,m);a=this._getHeightOfChar(d,e,a,c);n&&d.fillText(e,f,k);p&&d.strokeText(e,f,k);this._renderCharDecoration(d,m,f,k,l,b,a);d.restore();d.translate(b,0)}else{if("strokeText"===b&&this.stroke)d[b](e,f,k);if("fillText"===b&&
this.fill)d[b](e,f,k);b=this._applyCharStylesGetWidth(d,e,a,c);this._renderCharDecoration(d,null,f,k,l,b,this.fontSize);d.translate(d.measureText(e).width,0)}},_hasStyleChanged:function(b,d){return b.fill!==d.fill||b.fontSize!==d.fontSize||b.textBackgroundColor!==d.textBackgroundColor||b.textDecoration!==d.textDecoration||b.fontFamily!==d.fontFamily||b.fontWeight!==d.fontWeight||b.fontStyle!==d.fontStyle||b.stroke!==d.stroke||b.strokeWidth!==d.strokeWidth},_renderCharDecoration:function(b,d,a,c,e,
f,k){if(d=d?d.textDecoration||this.textDecoration:this.textDecoration)-1<d.indexOf("underline")&&b.fillRect(a,c+k/10,f,k/15),-1<d.indexOf("line-through")&&b.fillRect(a,c-k*(this._fontSizeFraction+this._fontSizeMult-1)+k/15,f,k/15),-1<d.indexOf("overline")&&b.fillRect(a,c-(this._fontSizeMult-this._fontSizeFraction)*k,f,k/15)},_renderTextLine:function(b,d,a,c,e,f){this.isEmptyStyles()||(e+=this.fontSize*(this._fontSizeFraction+.03));this.callSuper("_renderTextLine",b,d,a,c,e,f)},_renderTextDecoration:function(b){if(this.isEmptyStyles())return this.callSuper("_renderTextDecoration",
b)},_renderTextLinesBackground:function(b){if(this.textBackgroundColor||this.styles){b.save();this.textBackgroundColor&&(b.fillStyle=this.textBackgroundColor);for(var d=0,a=0,c=this._textLines.length;a<c;a++){var e=this._getHeightOfLine(b,a);if(""!==this._textLines[a]){var f=this._getLineWidth(b,a),k=this._getCachedLineOffset(a);this.textBackgroundColor&&(b.fillStyle=this.textBackgroundColor,b.fillRect(this._getLeftOffset()+k,this._getTopOffset()+d,f,e/this.lineHeight));if(this.styles[a])for(var f=
0,l=this._textLines[a].length;f<l;f++)if(this.styles[a]&&this.styles[a][f]&&this.styles[a][f].textBackgroundColor){var m=this._textLines[a][f];b.fillStyle=this.styles[a][f].textBackgroundColor;b.fillRect(this._getLeftOffset()+k+this._getWidthOfCharsAt(b,a,f),this._getTopOffset()+d,this._getWidthOfChar(b,m,a,f)+1,e/this.lineHeight)}}d+=e}b.restore()}},_getCacheProp:function(b,d){return b+d.fontFamily+d.fontSize+d.fontWeight+d.fontStyle+d.shadow},_applyCharStylesGetWidth:function(b,d,a,c,g){a=(a=g||
this.styles[a]&&this.styles[a][c])?e(a):{};this._applyFontStyles(a);c=this._getCacheProp(d,a);if(this.isEmptyStyles()&&this._charWidthsCache[c]&&this.caching)return this._charWidthsCache[c];"string"===typeof a.shadow&&(a.shadow=new fabric.Shadow(a.shadow));g=a.fill||this.fill;b.fillStyle=g.toLive?g.toLive(b,this):g;a.stroke&&(b.strokeStyle=a.stroke&&a.stroke.toLive?a.stroke.toLive(b,this):a.stroke);b.lineWidth=a.strokeWidth||this.strokeWidth;b.font=this._getFontDeclaration.call(a);this._setShadow.call(a,
b);if(!this.caching)return b.measureText(d).width;this._charWidthsCache[c]||(this._charWidthsCache[c]=b.measureText(d).width);return this._charWidthsCache[c]},_applyFontStyles:function(b){b.fontFamily||(b.fontFamily=this.fontFamily);b.fontSize||(b.fontSize=this.fontSize);b.fontWeight||(b.fontWeight=this.fontWeight);b.fontStyle||(b.fontStyle=this.fontStyle)},_getStyleDeclaration:function(b,d){return this.styles[b]&&this.styles[b][d]?e(this.styles[b][d]):{}},_getWidthOfChar:function(b,d,a,c){if("justify"===
this.textAlign&&/\s/.test(d))return this._getWidthOfSpace(b,a);var e=this._getStyleDeclaration(a,c);this._applyFontStyles(e);e=this._getCacheProp(d,e);if(this._charWidthsCache[e]&&this.caching)return this._charWidthsCache[e];if(b)return b.save(),d=this._applyCharStylesGetWidth(b,d,a,c),b.restore(),d},_getHeightOfChar:function(b,d,a,c){return this.styles[a]&&this.styles[a][c]?this.styles[a][c].fontSize||this.fontSize:this.fontSize},_getHeightOfCharAt:function(b,d,a){return this._getHeightOfChar(b,
this._textLines[d][a],d,a)},_getWidthOfCharsAt:function(b,d,a){var c=0,e,f;for(e=0;e<a;e++)f=this._textLines[d][e],c+=this._getWidthOfChar(b,f,d,e);return c},_getLineWidth:function(b,d){if(this.__lineWidths[d])return this.__lineWidths[d];this.__lineWidths[d]=this._getWidthOfCharsAt(b,d,this._textLines[d].length);return this.__lineWidths[d]},_getWidthOfSpace:function(b,d){if(this.__widthOfSpace[d])return this.__widthOfSpace[d];var a=this._textLines[d],c=this._getWidthOfWords(b,a,d),c=this.width-c,
a=a.length-a.replace(/\s+/g,"").length,a=c/a;return this.__widthOfSpace[d]=a},_getWidthOfWords:function(b,d,a){for(var c=0,e=0;e<d.length;e++){var f=d[e];f.match(/\s/)||(c+=this._getWidthOfChar(b,f,a,e))}return c},_getHeightOfLine:function(b,d){if(this.__lineHeights[d])return this.__lineHeights[d];for(var a=this._textLines[d],c=this._getHeightOfChar(b,a[0],d,0),e=1,f=a.length;e<f;e++){var k=this._getHeightOfChar(b,a[e],d,e);k>c&&(c=k)}this.__maxFontHeights[d]=c;this.__lineHeights[d]=c*this.lineHeight*
this._fontSizeMult;return this.__lineHeights[d]},_getTextHeight:function(b){for(var d=0,a=0,c=this._textLines.length;a<c;a++)d+=this._getHeightOfLine(b,a);return d},_renderTextBoxBackground:function(b){this.backgroundColor&&(b.save(),b.fillStyle=this.backgroundColor,b.fillRect(this._getLeftOffset(),this._getTopOffset(),this.width,this.height),b.restore())},toObject:function(b){return fabric.util.object.extend(this.callSuper("toObject",b),{styles:e(this.styles)})}});fabric.IText.fromObject=function(b){return new fabric.IText(b.text,
e(b))}})();
(function(){var e=fabric.util.object.clone;fabric.util.object.extend(fabric.IText.prototype,{initBehavior:function(){this.initAddedHandler();this.initRemovedHandler();this.initCursorSelectionHandlers();this.initDoubleClickSimulation()},initSelectedHandler:function(){this.on("selected",function(){var b=this;setTimeout(function(){b.selected=!0},100)})},initAddedHandler:function(){var b=this;this.on("added",function(){this.canvas&&!this.canvas._hasITextHandlers&&(this.canvas._hasITextHandlers=!0,this._initCanvasHandlers());
b.canvas&&(b.canvas._iTextInstances=b.canvas._iTextInstances||[],b.canvas._iTextInstances.push(b))})},initRemovedHandler:function(){var b=this;this.on("removed",function(){b.canvas&&(b.canvas._iTextInstances=b.canvas._iTextInstances||[],fabric.util.removeFromArray(b.canvas._iTextInstances,b))})},_initCanvasHandlers:function(){var b=this;this.canvas.on("selection:cleared",function(){fabric.IText.prototype.exitEditingOnOthers(b.canvas)});this.canvas.on("mouse:up",function(){b.canvas._iTextInstances&&
b.canvas._iTextInstances.forEach(function(b){b.__isMousedown=!1})});this.canvas.on("object:selected",function(){fabric.IText.prototype.exitEditingOnOthers(b.canvas)})},_tick:function(){this._currentTickState=this._animateCursor(this,1,this.cursorDuration,"_onTickComplete")},_animateCursor:function(b,d,a,c){var e;e={isAborted:!1,abort:function(){this.isAborted=!0}};b.animate("_currentCursorOpacity",d,{duration:a,onComplete:function(){if(!e.isAborted)b[c]()},onChange:function(){b.canvas&&(b.canvas.clearContext(b.canvas.contextTop||
b.ctx),b.renderCursorOrSelection())},abort:function(){return e.isAborted}});return e},_onTickComplete:function(){var b=this;this._cursorTimeout1&&clearTimeout(this._cursorTimeout1);this._cursorTimeout1=setTimeout(function(){b._currentTickCompleteState=b._animateCursor(b,0,this.cursorDuration/2,"_tick")},100)},initDelayedCursor:function(b){var d=this;b=b?0:this.cursorDelay;this._currentTickState&&this._currentTickState.abort();this._currentTickCompleteState&&this._currentTickCompleteState.abort();
clearTimeout(this._cursorTimeout1);this._currentCursorOpacity=1;this.canvas&&(this.canvas.clearContext(this.canvas.contextTop||this.ctx),this.renderCursorOrSelection());this._cursorTimeout2&&clearTimeout(this._cursorTimeout2);this._cursorTimeout2=setTimeout(function(){d._tick()},b)},abortCursorAnimation:function(){this._currentTickState&&this._currentTickState.abort();this._currentTickCompleteState&&this._currentTickCompleteState.abort();clearTimeout(this._cursorTimeout1);clearTimeout(this._cursorTimeout2);
this._currentCursorOpacity=0;this.canvas&&this.canvas.clearContext(this.canvas.contextTop||this.ctx)},selectAll:function(){this.setSelectionStart(0);this.setSelectionEnd(this.text.length)},getSelectedText:function(){return this.text.slice(this.selectionStart,this.selectionEnd)},findWordBoundaryLeft:function(b){var d=0,a=b-1;if(this._reSpace.test(this.text.charAt(a)))for(;this._reSpace.test(this.text.charAt(a));)d++,a--;for(;/\S/.test(this.text.charAt(a))&&-1<a;)d++,a--;return b-d},findWordBoundaryRight:function(b){var d=
0,a=b;if(this._reSpace.test(this.text.charAt(a)))for(;this._reSpace.test(this.text.charAt(a));)d++,a++;for(;/\S/.test(this.text.charAt(a))&&a<this.text.length;)d++,a++;return b+d},findLineBoundaryLeft:function(b){for(var d=0,a=b-1;!/\n/.test(this.text.charAt(a))&&-1<a;)d++,a--;return b-d},findLineBoundaryRight:function(b){for(var d=0,a=b;!/\n/.test(this.text.charAt(a))&&a<this.text.length;)d++,a++;return b+d},getNumNewLinesInSelectedText:function(){for(var b=0,d=0,a=this.getSelectedText().split(""),
c=a.length;d<c;d++)"\n"===a[d]&&b++;return b},searchWordBoundary:function(b,d){for(var a=this._reSpace.test(this.text.charAt(b))?b-1:b,c=this.text.charAt(a),e=/[ \n\.,;!\?\-]/;!e.test(c)&&0<a&&a<this.text.length;)a+=d,c=this.text.charAt(a);e.test(c)&&"\n"!==c&&(a+=1===d?0:1);return a},selectWord:function(b){var d=this.searchWordBoundary(b,-1);b=this.searchWordBoundary(b,1);this.setSelectionStart(d);this.setSelectionEnd(b)},selectLine:function(b){var d=this.findLineBoundaryLeft(b);b=this.findLineBoundaryRight(b);
this.setSelectionStart(d);this.setSelectionEnd(b)},enterEditing:function(){if(!this.isEditing&&this.editable){this.canvas&&this.exitEditingOnOthers(this.canvas);this.isEditing=!0;this.initHiddenTextarea();this.hiddenTextarea.focus();this._updateTextarea();this._saveEditingProps();this._setEditingProps();this._tick();this.fire("editing:entered");if(!this.canvas)return this;this.canvas.renderAll();this.canvas.fire("text:editing:entered",{target:this});this.initMouseMoveHandler();return this}},exitEditingOnOthers:function(b){b._iTextInstances&&
b._iTextInstances.forEach(function(b){b.selected=!1;b.isEditing&&b.exitEditing()})},initMouseMoveHandler:function(){var b=this;this.canvas.on("mouse:move",function(d){b.__isMousedown&&b.isEditing&&(d=b.getSelectionStartFromPointer(d.e),d>=b.__selectionStartOnMouseDown?(b.setSelectionStart(b.__selectionStartOnMouseDown),b.setSelectionEnd(d)):(b.setSelectionStart(d),b.setSelectionEnd(b.__selectionStartOnMouseDown)))})},_setEditingProps:function(){this.hoverCursor="text";this.canvas&&(this.canvas.defaultCursor=
this.canvas.moveCursor="text");this.borderColor=this.editingBorderColor;this.hasControls=this.selectable=!1;this.lockMovementX=this.lockMovementY=!0},_updateTextarea:function(){this.hiddenTextarea&&(this.hiddenTextarea.value=this.text,this.hiddenTextarea.selectionStart=this.selectionStart,this.hiddenTextarea.selectionEnd=this.selectionEnd)},_saveEditingProps:function(){this._savedProps={hasControls:this.hasControls,borderColor:this.borderColor,lockMovementX:this.lockMovementX,lockMovementY:this.lockMovementY,
hoverCursor:this.hoverCursor,defaultCursor:this.canvas&&this.canvas.defaultCursor,moveCursor:this.canvas&&this.canvas.moveCursor}},_restoreEditingProps:function(){this._savedProps&&(this.hoverCursor=this._savedProps.overCursor,this.hasControls=this._savedProps.hasControls,this.borderColor=this._savedProps.borderColor,this.lockMovementX=this._savedProps.lockMovementX,this.lockMovementY=this._savedProps.lockMovementY,this.canvas&&(this.canvas.defaultCursor=this._savedProps.defaultCursor,this.canvas.moveCursor=
this._savedProps.moveCursor))},exitEditing:function(){this.isEditing=this.selected=!1;this.selectable=!0;this.selectionEnd=this.selectionStart;this.hiddenTextarea&&this.canvas&&this.hiddenTextarea.parentNode.removeChild(this.hiddenTextarea);this.hiddenTextarea=null;this.abortCursorAnimation();this._restoreEditingProps();this._currentCursorOpacity=0;this.fire("editing:exited");this.canvas&&this.canvas.fire("text:editing:exited",{target:this});return this},_removeExtraneousStyles:function(){for(var b in this.styles)this._textLines[b]||
delete this.styles[b]},_removeCharsFromTo:function(b,d){for(var a=d;a!==b;){var c=this.get2DCursorLocation(a).charIndex;a--;(c=this.get2DCursorLocation(a).charIndex>c)?this.removeStyleObject(c,a+1):this.removeStyleObject(0===this.get2DCursorLocation(a).charIndex,a)}this.text=this.text.slice(0,b)+this.text.slice(d);this._clearCache()},insertChars:function(b,d){var a="\n"===this.text.slice(this.selectionStart,this.selectionStart+1);this.text=this.text.slice(0,this.selectionStart)+b+this.text.slice(this.selectionEnd);
this.selectionStart===this.selectionEnd&&this.insertStyleObjects(b,a,d);this.setSelectionStart(this.selectionStart+b.length);this.setSelectionEnd(this.selectionStart);this._clearCache();this.canvas&&this.canvas.renderAll();this.setCoords();this.fire("changed");this.canvas&&this.canvas.fire("text:changed",{target:this})},insertNewlineStyleObject:function(b,d,a){this.shiftLineStyles(b,1);this.styles[b+1]||(this.styles[b+1]={});var c=this.styles[b][d-1],g={};if(a)g[0]=e(c);else for(var f in this.styles[b])parseInt(f,
10)>=d&&(g[parseInt(f,10)-d]=this.styles[b][f],delete this.styles[b][f]);this.styles[b+1]=g;this._clearCache()},insertCharStyleObject:function(b,d,a){var c=this.styles[b],g=e(c);0!==d||a||(d=1);for(var f in g){var k=parseInt(f,10);k>=d&&(c[k+1]=g[k])}this.styles[b][d]=a||e(c[d-1]);this._clearCache()},insertStyleObjects:function(b,d,a){var c=this.get2DCursorLocation(),e=c.lineIndex,c=c.charIndex;this.styles[e]||(this.styles[e]={});"\n"===b?this.insertNewlineStyleObject(e,c,d):a?this._insertStyles(this.copiedStyles):
this.insertCharStyleObject(e,c)},_insertStyles:function(b){for(var d=0,a=b.length;d<a;d++){var c=this.get2DCursorLocation(this.selectionStart+d);this.insertCharStyleObject(c.lineIndex,c.charIndex,b[d])}},shiftLineStyles:function(b,d){var a=e(this.styles),c;for(c in this.styles){var g=parseInt(c,10);g>b&&(this.styles[g+d]=a[g])}},removeStyleObject:function(b,d){var a=this.get2DCursorLocation(d),c=a.lineIndex,a=a.charIndex;if(b){var g=this._textLines[c-1],g=g?g.length:0;this.styles[c-1]||(this.styles[c-
1]={});for(a in this.styles[c])this.styles[c-1][parseInt(a,10)+g]=this.styles[c][a];this.shiftLineStyles(c,-1)}else{(c=this.styles[c])&&delete c[a+(this.selectionStart===this.selectionEnd?-1:0)];var f=e(c);for(g in f){var k=parseInt(g,10);k>=a&&0!==k&&(c[k-1]=f[k],delete c[k])}}},insertNewline:function(){this.insertChars("\n")}})})();
fabric.util.object.extend(fabric.IText.prototype,{initDoubleClickSimulation:function(){this.__lastClickTime=+new Date;this.__lastLastClickTime=+new Date;this.__lastPointer={};this.on("mousedown",this.onMouseDown.bind(this))},onMouseDown:function(e){this.__newClickTime=+new Date;var b=this.canvas.getPointer(e.e);this.isTripleClick(b)?(this.fire("tripleclick",e),this._stopEvent(e.e)):this.isDoubleClick(b)&&(this.fire("dblclick",e),this._stopEvent(e.e));this.__lastLastClickTime=this.__lastClickTime;
this.__lastClickTime=this.__newClickTime;this.__lastPointer=b;this.__lastIsEditing=this.isEditing;this.__lastSelected=this.selected},isDoubleClick:function(e){return 500>this.__newClickTime-this.__lastClickTime&&this.__lastPointer.x===e.x&&this.__lastPointer.y===e.y&&this.__lastIsEditing},isTripleClick:function(e){return 500>this.__newClickTime-this.__lastClickTime&&500>this.__lastClickTime-this.__lastLastClickTime&&this.__lastPointer.x===e.x&&this.__lastPointer.y===e.y},_stopEvent:function(e){e.preventDefault&&
e.preventDefault();e.stopPropagation&&e.stopPropagation()},initCursorSelectionHandlers:function(){this.initSelectedHandler();this.initMousedownHandler();this.initMouseupHandler();this.initClicks()},initClicks:function(){this.on("dblclick",function(e){this.selectWord(this.getSelectionStartFromPointer(e.e))});this.on("tripleclick",function(e){this.selectLine(this.getSelectionStartFromPointer(e.e))})},initMousedownHandler:function(){this.on("mousedown",function(e){var b=this.canvas.getPointer(e.e);this.__mousedownX=
b.x;this.__mousedownY=b.y;this.__isMousedown=!0;this.hiddenTextarea&&this.canvas&&this.canvas.wrapperEl.appendChild(this.hiddenTextarea);this.selected&&this.setCursorByClick(e.e);this.isEditing&&(this.__selectionStartOnMouseDown=this.selectionStart,this.initDelayedCursor(!0))})},_isObjectMoved:function(e){e=this.canvas.getPointer(e);return this.__mousedownX!==e.x||this.__mousedownY!==e.y},initMouseupHandler:function(){this.on("mouseup",function(e){this.__isMousedown=!1;this._isObjectMoved(e.e)||(this.__lastSelected&&
(this.enterEditing(),this.initDelayedCursor(!0)),this.selected=!0)})},setCursorByClick:function(e){var b=this.getSelectionStartFromPointer(e);e.shiftKey?b<this.selectionStart?(this.setSelectionEnd(this.selectionStart),this.setSelectionStart(b)):this.setSelectionEnd(b):(this.setSelectionStart(b),this.setSelectionEnd(b))},_getLocalRotatedPointer:function(e){var b=this.canvas.getPointer(e),b=new fabric.Point(b.x,b.y),d=new fabric.Point(this.left,this.top),b=fabric.util.rotatePoint(b,d,fabric.util.degreesToRadians(-this.angle));
return this.getLocalPointer(e,b)},getSelectionStartFromPointer:function(e){e=this._getLocalRotatedPointer(e);for(var b=0,d=0,a=0,c=0,g,f=0,k=this._textLines.length;f<k;f++){g=this._textLines[f].split("");a+=this._getHeightOfLine(this.ctx,f)*this.scaleY;d=this._getLineWidth(this.ctx,f);d=this._getLineLeftOffset(d)*this.scaleX;this.flipX&&(this._textLines[f]=g.reverse().join(""));for(var l=0,m=g.length;l<m;l++){var p=g[l],b=d,d=d+this._getWidthOfChar(this.ctx,p,f,this.flipX?m-l:l)*this.scaleX;if(a<=
e.y||d<=e.x)c++;else return this._getNewSelectionStartFromOffset(e,b,d,c+f,m)}if(e.y<a)return this._getNewSelectionStartFromOffset(e,b,d,c+f,m)}return this.text.length},_getNewSelectionStartFromOffset:function(e,b,d,a,c){e=a+(d-e.x>e.x-b?0:1);this.flipX&&(e=c-e);e>this.text.length&&(e=this.text.length);return e}});
fabric.util.object.extend(fabric.IText.prototype,{initHiddenTextarea:function(){this.hiddenTextarea=fabric.document.createElement("textarea");this.hiddenTextarea.setAttribute("autocapitalize","off");this.hiddenTextarea.style.cssText="position: fixed; bottom: 20px; left: 0px; opacity: 0; width: 0px; height: 0px; z-index: -999;";fabric.document.body.appendChild(this.hiddenTextarea);fabric.util.addListener(this.hiddenTextarea,"keydown",this.onKeyDown.bind(this));fabric.util.addListener(this.hiddenTextarea,
"keypress",this.onKeyPress.bind(this));fabric.util.addListener(this.hiddenTextarea,"copy",this.copy.bind(this));fabric.util.addListener(this.hiddenTextarea,"paste",this.paste.bind(this));!this._clickHandlerInitialized&&this.canvas&&(fabric.util.addListener(this.canvas.upperCanvasEl,"click",this.onClick.bind(this)),this._clickHandlerInitialized=!0)},_keysMap:{8:"removeChars",9:"exitEditing",27:"exitEditing",13:"insertNewline",33:"moveCursorUp",34:"moveCursorDown",35:"moveCursorRight",36:"moveCursorLeft",
37:"moveCursorLeft",38:"moveCursorUp",39:"moveCursorRight",40:"moveCursorDown",46:"forwardDelete"},_ctrlKeysMap:{65:"selectAll",88:"cut"},onClick:function(){this.hiddenTextarea&&this.hiddenTextarea.focus()},onKeyDown:function(e){if(this.isEditing){if(e.keyCode in this._keysMap)this[this._keysMap[e.keyCode]](e);else if(e.keyCode in this._ctrlKeysMap&&(e.ctrlKey||e.metaKey))this[this._ctrlKeysMap[e.keyCode]](e);else return;e.stopImmediatePropagation();e.preventDefault();this.canvas&&this.canvas.renderAll()}},
forwardDelete:function(e){this.selectionStart===this.selectionEnd&&this.moveCursorRight(e);this.removeChars(e)},copy:function(e){var b=this.getSelectedText();(e=this._getClipboardData(e))&&e.setData("text",b);this.copiedText=b;this.copiedStyles=this.getSelectionStyles(this.selectionStart,this.selectionEnd)},paste:function(e){var b=null;(b=(e=this._getClipboardData(e))?e.getData("text"):this.copiedText)&&this.insertChars(b,!0)},cut:function(e){this.selectionStart!==this.selectionEnd&&(this.copy(),
this.removeChars(e))},_getClipboardData:function(e){return e&&(e.clipboardData||fabric.window.clipboardData)},onKeyPress:function(e){!this.isEditing||e.metaKey||e.ctrlKey||(0!==e.which&&this.insertChars(String.fromCharCode(e.which)),e.stopPropagation())},getDownCursorOffset:function(e,b){var d=b?this.selectionEnd:this.selectionStart,a=this.text.slice(0,d),c=this.text.slice(d),g=a.slice(a.lastIndexOf("\n")+1),a=c.match(/(.*)\n?/)[1],c=(c.match(/.*\n(.*)\n?/)||{})[1]||"",f=this.get2DCursorLocation(d);
if(f.lineIndex===this._textLines.length-1||e.metaKey||34===e.keyCode)return this.text.length-d;for(var d=this._getLineWidth(this.ctx,f.lineIndex),k=this._getLineLeftOffset(d),l=f.lineIndex,m=0,p=g.length;m<p;m++)d=g[m],k+=this._getWidthOfChar(this.ctx,d,l,m);g=this._getIndexOnNextLine(f,c,k);return a.length+1+g},_getIndexOnNextLine:function(e,b,d){e=e.lineIndex+1;for(var a=this._getLineWidth(this.ctx,e),a=this._getLineLeftOffset(a),c=0,g,f=0,k=b.length;f<k;f++){var l=this._getWidthOfChar(this.ctx,
b[f],e,f),a=a+l;if(a>d){g=!0;c=Math.abs(a-d)<Math.abs(a-l-d)?f+1:f;break}}g||(c=b.length);return c},moveCursorDown:function(e){this.abortCursorAnimation();this._currentCursorOpacity=1;var b=this.getDownCursorOffset(e,"right"===this._selectionDirection);e.shiftKey?this.moveCursorDownWithShift(b):this.moveCursorDownWithoutShift(b);this.initDelayedCursor()},moveCursorDownWithoutShift:function(e){this._selectionDirection="right";this.setSelectionStart(this.selectionStart+e);this.setSelectionEnd(this.selectionStart)},
swapSelectionPoints:function(){var e=this.selectionEnd;this.setSelectionEnd(this.selectionStart);this.setSelectionStart(e)},moveCursorDownWithShift:function(e){this.selectionEnd===this.selectionStart&&(this._selectionDirection="right");"right"===this._selectionDirection?this.setSelectionEnd(this.selectionEnd+e):this.setSelectionStart(this.selectionStart+e);this.selectionEnd<this.selectionStart&&"left"===this._selectionDirection&&(this.swapSelectionPoints(),this._selectionDirection="right");this.selectionEnd>
this.text.length&&this.setSelectionEnd(this.text.length)},getUpCursorOffset:function(e,b){var d=b?this.selectionEnd:this.selectionStart,a=this.get2DCursorLocation(d);if(0===a.lineIndex||e.metaKey||33===e.keyCode)return d;var c=this.text.slice(0,d),d=c.slice(c.lastIndexOf("\n")+1),c=(c.match(/\n?(.*)\n.*$/)||{})[1]||"",g;g=this._getLineWidth(this.ctx,a.lineIndex);for(var f=this._getLineLeftOffset(g),k=a.lineIndex,l=0,m=d.length;l<m;l++)g=d[l],f+=this._getWidthOfChar(this.ctx,g,k,l);a=this._getIndexOnPrevLine(a,
c,f);return c.length-a+d.length},_getIndexOnPrevLine:function(e,b,d){e=e.lineIndex-1;for(var a=this._getLineWidth(this.ctx,e),a=this._getLineLeftOffset(a),c=0,g,f=0,k=b.length;f<k;f++){var l=this._getWidthOfChar(this.ctx,b[f],e,f),a=a+l;if(a>d){g=!0;c=Math.abs(a-d)<Math.abs(a-l-d)?f:f-1;break}}g||(c=b.length-1);return c},moveCursorUp:function(e){this.abortCursorAnimation();this._currentCursorOpacity=1;var b=this.getUpCursorOffset(e,"right"===this._selectionDirection);e.shiftKey?this.moveCursorUpWithShift(b):
this.moveCursorUpWithoutShift(b);this.initDelayedCursor()},moveCursorUpWithShift:function(e){this.selectionEnd===this.selectionStart&&(this._selectionDirection="left");"right"===this._selectionDirection?this.setSelectionEnd(this.selectionEnd-e):this.setSelectionStart(this.selectionStart-e);this.selectionEnd<this.selectionStart&&"right"===this._selectionDirection&&(this.swapSelectionPoints(),this._selectionDirection="left")},moveCursorUpWithoutShift:function(e){this.selectionStart===this.selectionEnd&&
this.setSelectionStart(this.selectionStart-e);this.setSelectionEnd(this.selectionStart);this._selectionDirection="left"},moveCursorLeft:function(e){if(0!==this.selectionStart||0!==this.selectionEnd)this.abortCursorAnimation(),this._currentCursorOpacity=1,e.shiftKey?this.moveCursorLeftWithShift(e):this.moveCursorLeftWithoutShift(e),this.initDelayedCursor()},_move:function(e,b,d){var a="selectionStart"===b?"setSelectionStart":"setSelectionEnd";if(e.altKey)this[a](this["findWordBoundary"+d](this[b]));
else if(e.metaKey||35===e.keyCode||36===e.keyCode)this[a](this["findLineBoundary"+d](this[b]));else this[a](this[b]+("Left"===d?-1:1))},_moveLeft:function(e,b){this._move(e,b,"Left")},_moveRight:function(e,b){this._move(e,b,"Right")},moveCursorLeftWithoutShift:function(e){this._selectionDirection="left";this.selectionEnd===this.selectionStart&&this._moveLeft(e,"selectionStart");this.setSelectionEnd(this.selectionStart)},moveCursorLeftWithShift:function(e){"right"===this._selectionDirection&&this.selectionStart!==
this.selectionEnd?this._moveLeft(e,"selectionEnd"):(this._selectionDirection="left",this._moveLeft(e,"selectionStart"),"\n"===this.text.charAt(this.selectionStart)&&this.setSelectionStart(this.selectionStart-1))},moveCursorRight:function(e){this.selectionStart>=this.text.length&&this.selectionEnd>=this.text.length||(this.abortCursorAnimation(),this._currentCursorOpacity=1,e.shiftKey?this.moveCursorRightWithShift(e):this.moveCursorRightWithoutShift(e),this.initDelayedCursor())},moveCursorRightWithShift:function(e){"left"===
this._selectionDirection&&this.selectionStart!==this.selectionEnd?this._moveRight(e,"selectionStart"):(this._selectionDirection="right",this._moveRight(e,"selectionEnd"),"\n"===this.text.charAt(this.selectionEnd-1)&&this.setSelectionEnd(this.selectionEnd+1))},moveCursorRightWithoutShift:function(e){this._selectionDirection="right";this.selectionStart===this.selectionEnd?(this._moveRight(e,"selectionStart"),this.setSelectionEnd(this.selectionStart)):(this.setSelectionEnd(this.selectionEnd+this.getNumNewLinesInSelectedText()),
this.setSelectionStart(this.selectionEnd))},removeChars:function(e){this.selectionStart===this.selectionEnd?this._removeCharsNearCursor(e):this._removeCharsFromTo(this.selectionStart,this.selectionEnd);this.setSelectionEnd(this.selectionStart);this._removeExtraneousStyles();this._clearCache();this.canvas&&this.canvas.renderAll();this.setCoords();this.fire("changed");this.canvas&&this.canvas.fire("text:changed",{target:this})},_removeCharsNearCursor:function(e){0!==this.selectionStart&&(e.metaKey?
(e=this.findLineBoundaryLeft(this.selectionStart),this._removeCharsFromTo(e,this.selectionStart),this.setSelectionStart(e)):e.altKey?(e=this.findWordBoundaryLeft(this.selectionStart),this._removeCharsFromTo(e,this.selectionStart),this.setSelectionStart(e)):(e="\n"===this.text.slice(this.selectionStart-1,this.selectionStart),this.removeStyleObject(e),this.setSelectionStart(this.selectionStart-1),this.text=this.text.slice(0,this.selectionStart)+this.text.slice(this.selectionStart+1)))}});
fabric.util.object.extend(fabric.IText.prototype,{_setSVGTextLineText:function(e,b,d,a,c,g){this.styles[e]?this._setSVGTextLineChars(e,b,d,a,g):this.callSuper("_setSVGTextLineText",e,b,d,a,c)},_setSVGTextLineChars:function(e,b,d,a,c){d=this._textLines[e].split("");a=0;for(var g=this._getSVGLineLeftOffset(e)-this.width/2,f=this._getSVGLineTopOffset(e),k=this._getHeightOfLine(this.ctx,e),l=0,m=d.length;l<m;l++){var p=this.styles[e][l]||{};b.push(this._createTextCharSpan(d[l],p,g,f.lineTop+f.offset,
a));var n=this._getWidthOfChar(this.ctx,d[l],e,l);p.textBackgroundColor&&c.push(this._createTextCharBg(p,g,f.lineTop,k,n,a));a+=n}},_getSVGLineLeftOffset:function(e){return fabric.util.toFixed(this._getLineLeftOffset(this.__lineWidths[e]),2)},_getSVGLineTopOffset:function(e){for(var b=0,d=0,d=0;d<e;d++)b+=this._getHeightOfLine(this.ctx,d);d=this._getHeightOfLine(this.ctx,d);return{lineTop:b,offset:(this._fontSizeMult-this._fontSizeFraction)*d/(this.lineHeight*this._fontSizeMult)}},_createTextCharBg:function(e,
b,d,a,c,g){return['<rect fill="',e.textBackgroundColor,'" x="',b+g,'" y="',d-this.height/2,'" width="',c,'" height="',a/this.lineHeight,'"></rect>'].join("")},_createTextCharSpan:function(e,b,d,a,c){var g=this.getSvgStyles.call(fabric.util.object.extend({visible:!0,fill:this.fill,stroke:this.stroke,type:"text"},b));return['<tspan x="',d+c,'" y="',a-this.height/2,'" ',b.fontFamily?'font-family="'+b.fontFamily.replace(/"/g,"'")+'" ':"",b.fontSize?'font-size="'+b.fontSize+'" ':"",b.fontStyle?'font-style="'+
b.fontStyle+'" ':"",b.fontWeight?'font-weight="'+b.fontWeight+'" ':"",b.textDecoration?'text-decoration="'+b.textDecoration+'" ':"",'style="',g,'">',fabric.util.string.escapeXml(e),"</tspan>"].join("")}});
(function(){function e(b,d,e){var f=a.parse(b);f.port||(f.port=0===f.protocol.indexOf("https:")?443:80);b=(0===f.protocol.indexOf("https:")?g:c).request({hostname:f.hostname,port:f.port,path:f.path,method:"GET"},function(a){var b="";d&&a.setEncoding(d);a.on("end",function(){e(b)});a.on("data",function(c){200===a.statusCode&&(b+=c)})});b.on("error",function(a){a.errno===process.ECONNREFUSED?fabric.log("ECONNREFUSED: connection refused to "+f.hostname+":"+f.port):fabric.log(a.message)});b.end()}function b(a,
b){require2("fs").readFile(a,function(a,c){if(a)throw fabric.log(a),a;b(c)})}if("undefined"===typeof document||"undefined"===typeof window){var d=require2("xmldom").DOMParser,a=require2("url"),c=require2("http"),g=require2("https"),f=require2("canvas"),k=require2("canvas").Image;fabric.util.loadImage=function(a,c,d){function f(b){g.src=new Buffer(b,"binary");g._src=a;c&&c.call(d,g)}var g=new k;a&&(a instanceof Buffer||0===a.indexOf("data"))?(g.src=g._src=a,c&&c.call(d,g)):a&&0!==a.indexOf("http")?
b(a,f):a?e(a,"binary",f):c&&c.call(d,a)};fabric.loadSVGFromURL=function(a,c,d){a=a.replace(/^\n\s*/,"").replace(/\?.*$/,"").trim();0!==a.indexOf("http")?b(a,function(a){fabric.loadSVGFromString(a.toString(),c,d)}):e(a,"",function(a){fabric.loadSVGFromString(a,c,d)})};fabric.loadSVGFromString=function(a,b,c){a=(new d).parseFromString(a);fabric.parseSVGDocument(a.documentElement,function(a,c){b&&b(a,c)},c)};fabric.util.getScript=function(a,b){e(a,"",function(a){eval(a);b&&b()})};fabric.Image.fromObject=
function(a,b){fabric.util.loadImage(a.src,function(c){var d=new fabric.Image(c);d._initConfig(a);d._initFilters(a,function(a){d.filters=a||[];b&&b(d)})})};fabric.createCanvasForNode=function(a,b,c,d){d=d||c;var e=fabric.document.createElement("canvas");a=new f(a||600,b||600,d);e.style={};e.width=a.width;e.height=a.height;c=new (fabric.Canvas||fabric.StaticCanvas)(e,c);c.contextContainer=a.getContext("2d");c.nodeCanvas=a;c.Font=f.Font;return c};fabric.StaticCanvas.prototype.createPNGStream=function(){return this.nodeCanvas.createPNGStream()};
fabric.StaticCanvas.prototype.createJPEGStream=function(a){return this.nodeCanvas.createJPEGStream(a)};var l=fabric.StaticCanvas.prototype.setWidth;fabric.StaticCanvas.prototype.setWidth=function(a,b){l.call(this,a,b);this.nodeCanvas.width=a;return this};fabric.Canvas&&(fabric.Canvas.prototype.setWidth=fabric.StaticCanvas.prototype.setWidth);var m=fabric.StaticCanvas.prototype.setHeight;fabric.StaticCanvas.prototype.setHeight=function(a,b){m.call(this,a,b);this.nodeCanvas.height=a;return this};fabric.Canvas&&
(fabric.Canvas.prototype.setHeight=fabric.StaticCanvas.prototype.setHeight)}})();
(function(e,b,d,a){function c(a,b,c){return setTimeout(p(a,c),b)}function g(a,b,c){return Array.isArray(a)?(f(a,c[b],c),!0):!1}function f(b,c,d){var e;if(b)if(b.forEach)b.forEach(c,d);else if(b.length!==a)for(e=0;e<b.length;)c.call(d,b[e],e,b),e++;else for(e in b)b.hasOwnProperty(e)&&c.call(d,b[e],e,b)}function k(b,c,d){for(var e=Object.keys(c),f=0;f<e.length;){if(!d||d&&b[e[f]]===a)b[e[f]]=c[e[f]];f++}return b}function l(a,b){return k(a,b,!0)}function m(a,b,c){b=b.prototype;var d;d=a.prototype=Object.create(b);
d.constructor=a;d._super=b;c&&k(d,c)}function p(a,b){return function(){return a.apply(b,arguments)}}function n(b,c){return"function"==typeof b?b.apply(c?c[0]||a:a,c):b}function x(a,b,c){f(u(b),function(b){a.addEventListener(b,c,!1)})}function y(a,b,c){f(u(b),function(b){a.removeEventListener(b,c,!1)})}function E(a,b){for(;a;){if(a==b)return!0;a=a.parentNode}return!1}function u(a){return a.trim().split(/\s+/g)}function z(a,b,c){if(a.indexOf&&!c)return a.indexOf(b);for(var d=0;d<a.length;){if(c&&a[d][c]==
b||!c&&a[d]===b)return d;d++}return-1}function q(a){return Array.prototype.slice.call(a,0)}function t(a,b,c){for(var d=[],e=[],f=0;f<a.length;){var g=b?a[f][b]:a[f];0>z(e,g)&&d.push(a[f]);e[f]=g;f++}c&&(d=b?d.sort(function(a,c){return a[b]>c[b]}):d.sort());return d}function r(b,c){for(var d,e=c[0].toUpperCase()+c.slice(1),f=0;f<Ia.length;){d=(d=Ia[f])?d+e:c;if(d in b)return d;f++}return a}function v(a){a=a.ownerDocument;return a.defaultView||a.parentWindow}function w(a,b){var c=this;this.manager=
a;this.callback=b;this.element=a.element;this.target=a.options.inputTarget;this.domHandler=function(b){n(a.options.enable,[a])&&c.handler(b)};this.init()}function D(a){var b=a.options.inputClass;return new (b?b:Ua?Z:Va?U:Ja?ka:P)(a,A)}function A(b,c,d){var e=d.pointers.length,f=d.changedPointers.length,g=c&1&&0===e-f;d.isFirst=!!g;d.isFinal=!!(c&12&&0===e-f);g&&(b.session={});d.eventType=c;c=b.session;e=d.pointers;f=e.length;c.firstInput||(c.firstInput=C(d));1<f&&!c.firstMultiple?c.firstMultiple=
C(d):1===f&&(c.firstMultiple=!1);var g=c.firstInput,h=(f=c.firstMultiple)?f.center:g.center,k=d.center=H(e);d.timeStamp=Aa();d.deltaTime=d.timeStamp-g.timeStamp;d.angle=N(h,k);d.distance=I(h,k);var g=d.center,h=c.offsetDelta||{},k=c.prevDelta||{},l=c.prevInput||{};if(1===d.eventType||4===l.eventType)k=c.prevDelta={x:l.deltaX||0,y:l.deltaY||0},h=c.offsetDelta={x:g.x,y:g.y};d.deltaX=k.x+(g.x-h.x);d.deltaY=k.y+(g.y-h.y);d.offsetDirection=F(d.deltaX,d.deltaY);f?(g=f.pointers,g=I(e[0],e[1],na)/I(g[0],
g[1],na)):g=1;d.scale=g;f?(f=f.pointers,e=N(e[1],e[0],na)-N(f[1],f[0],na)):e=0;d.rotation=e;h=c.lastInterval||d;e=d.timeStamp-h.timeStamp;8!=d.eventType&&(25<e||h.velocity===a)?(g=h.deltaX-d.deltaX,h=h.deltaY-d.deltaY,k=g/e||0,l=h/e||0,e=k,f=l,k=ra(k)>ra(l)?k:l,g=F(g,h),c.lastInterval=d):(k=h.velocity,e=h.velocityX,f=h.velocityY,g=h.direction);d.velocity=k;d.velocityX=e;d.velocityY=f;d.direction=g;c=b.element;E(d.srcEvent.target,c)&&(c=d.srcEvent.target);d.target=c;b.emit("hammer.input",d);b.recognize(d);
b.session.prevInput=d}function C(a){for(var b=[],c=0;c<a.pointers.length;)b[c]={clientX:ga(a.pointers[c].clientX),clientY:ga(a.pointers[c].clientY)},c++;return{timeStamp:Aa(),pointers:b,center:H(b),deltaX:a.deltaX,deltaY:a.deltaY}}function H(a){var b=a.length;if(1===b)return{x:ga(a[0].clientX),y:ga(a[0].clientY)};for(var c=0,d=0,e=0;e<b;)c+=a[e].clientX,d+=a[e].clientY,e++;return{x:ga(c/b),y:ga(d/b)}}function F(a,b){return a===b?1:ra(a)>=ra(b)?0<a?2:4:0<b?8:16}function I(a,b,c){c||(c=ha);var d=b[c[0]]-
a[c[0]];a=b[c[1]]-a[c[1]];return Math.sqrt(d*d+a*a)}function N(a,b,c){c||(c=ha);return 180*Math.atan2(b[c[1]]-a[c[1]],b[c[0]]-a[c[0]])/Math.PI}function P(){this.evEl=la;this.evWin=G;this.allow=!0;this.pressed=!1;w.apply(this,arguments)}function Z(){this.evEl=Ka;this.evWin=ta;w.apply(this,arguments);this.store=this.manager.session.pointerEvents=[]}function ca(){this.evTarget="touchstart";this.evWin="touchstart touchmove touchend touchcancel";this.started=!1;w.apply(this,arguments)}function U(){this.evTarget=
La;this.targetIds={};w.apply(this,arguments)}function za(a,b){var c=q(a.touches),d=this.targetIds;if(b&3&&1===c.length)return d[c[0].identifier]=!0,[c,c];var e,f=q(a.changedTouches),g=[],h=this.target;e=c.filter(function(a){return E(a.target,h)});if(1===b)for(c=0;c<e.length;)d[e[c].identifier]=!0,c++;for(c=0;c<f.length;)d[f[c].identifier]&&g.push(f[c]),b&12&&delete d[f[c].identifier],c++;if(g.length)return[t(e.concat(g),"identifier",!0),g]}function ka(){w.apply(this,arguments);var a=p(this.handler,
this);this.touch=new U(this.manager,a);this.mouse=new P(this.manager,a)}function X(a,b){this.manager=a;this.set(b)}function Ea(a){if(-1<a.indexOf("none"))return"none";var b=-1<a.indexOf("pan-x"),c=-1<a.indexOf("pan-y");return b&&c?"pan-x pan-y":b||c?b?"pan-x":"pan-y":-1<a.indexOf("manipulation")?"manipulation":"auto"}function Q(b){this.id=Wa++;this.manager=null;this.options=l(b||{},this.defaults);b=this.options.enable;this.options.enable=b===a?!0:b;this.state=1;this.simultaneous={};this.require2Fail=
[]}function ea(a){return 16==a?"down":8==a?"up":2==a?"left":4==a?"right":""}function Y(a,b){var c=b.manager;return c?c.get(a):a}function S(){Q.apply(this,arguments)}function V(){S.apply(this,arguments);this.pY=this.pX=null}function aa(){S.apply(this,arguments)}function ba(){Q.apply(this,arguments);this._input=this._timer=null}function ua(){S.apply(this,arguments)}function va(){S.apply(this,arguments)}function L(){Q.apply(this,arguments);this.pCenter=this.pTime=!1;this._input=this._timer=null;this.count=
0}function K(b,c){c=c||{};var d=c.recognizers;c.recognizers=d===a?K.defaults.preset:d;return new h(b,c)}function h(a,b){b=b||{};this.options=l(b,K.defaults);this.options.inputTarget=this.options.inputTarget||a;this.handlers={};this.session={};this.recognizers=[];this.element=a;this.input=D(this);this.touchAction=new X(this,this.options.touchAction);Ma(this,!0);f(b.recognizers,function(a){var b=this.add(new a[0](a[1]));a[2]&&b.recognizeWith(a[2]);a[3]&&b.require2Failure(a[3])},this)}function Ma(a,
b){var c=a.element;f(a.options.cssProps,function(a,d){c.style[r(c.style,d)]=b?a:""})}function Xa(a,c){var d=b.createEvent("Event");d.initEvent(a,!0,!0);d.gesture=c;c.target.dispatchEvent(d)}var Ia=" webkit moz MS ms o".split(" "),Ya=b.createElement("div"),ga=Math.round,ra=Math.abs,Aa=Date.now,Wa=1,pa=/mobile|tablet|ip(ad|hone|od)|android/i,Ja="ontouchstart"in e,Ua=r(e,"PointerEvent")!==a,Va=Ja&&pa.test(navigator.userAgent),ha=["x","y"],na=["clientX","clientY"];w.prototype={handler:function(){},init:function(){this.evEl&&
x(this.element,this.evEl,this.domHandler);this.evTarget&&x(this.target,this.evTarget,this.domHandler);this.evWin&&x(v(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&y(this.element,this.evEl,this.domHandler);this.evTarget&&y(this.target,this.evTarget,this.domHandler);this.evWin&&y(v(this.element),this.evWin,this.domHandler)}};var Ba={mousedown:1,mousemove:2,mouseup:4},la="mousedown",G="mousemove mouseup";m(P,w,{handler:function(a){var b=Ba[a.type];b&1&&0===a.button&&(this.pressed=
!0);b&2&&1!==a.which&&(b=4);this.pressed&&this.allow&&(b&4&&(this.pressed=!1),this.callback(this.manager,b,{pointers:[a],changedPointers:[a],pointerType:"mouse",srcEvent:a}))}});var R={pointerdown:1,pointermove:2,pointerup:4,pointercancel:8,pointerout:8},Za={2:"touch",3:"pen",4:"mouse",5:"kinect"},Ka="pointerdown",ta="pointermove pointerup pointercancel";e.MSPointerEvent&&(Ka="MSPointerDown",ta="MSPointerMove MSPointerUp MSPointerCancel");m(Z,w,{handler:function(a){var b=this.store,c=!1,d=a.type.toLowerCase().replace("ms",
""),d=R[d],e=Za[a.pointerType]||a.pointerType,f="touch"==e,g=z(b,a.pointerId,"pointerId");d&1&&(0===a.button||f)?0>g&&(b.push(a),g=b.length-1):d&12&&(c=!0);0>g||(b[g]=a,this.callback(this.manager,d,{pointers:b,changedPointers:[a],pointerType:e,srcEvent:a}),c&&b.splice(g,1))}});var ma={touchstart:1,touchmove:2,touchend:4,touchcancel:8};m(ca,w,{handler:function(a){var b=ma[a.type];1===b&&(this.started=!0);if(this.started){var c;c=q(a.touches);var d=q(a.changedTouches);b&12&&(c=t(c.concat(d),"identifier",
!0));c=[c,d];b&12&&0===c[0].length-c[1].length&&(this.started=!1);this.callback(this.manager,b,{pointers:c[0],changedPointers:c[1],pointerType:"touch",srcEvent:a})}}});var wa={touchstart:1,touchmove:2,touchend:4,touchcancel:8},La="touchstart touchmove touchend touchcancel";m(U,w,{handler:function(a){var b=wa[a.type],c=za.call(this,a,b);c&&this.callback(this.manager,b,{pointers:c[0],changedPointers:c[1],pointerType:"touch",srcEvent:a})}});m(ka,w,{handler:function(a,b,c){var d="mouse"==c.pointerType;
if("touch"==c.pointerType)this.mouse.allow=!1;else if(d&&!this.mouse.allow)return;b&12&&(this.mouse.allow=!0);this.callback(a,b,c)},destroy:function(){this.touch.destroy();this.mouse.destroy()}});var Na=r(Ya.style,"touchAction"),Oa=Na!==a;X.prototype={set:function(a){"compute"==a&&(a=this.compute());Oa&&(this.manager.element.style[Na]=a);this.actions=a.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var a=[];f(this.manager.recognizers,function(b){n(b.options.enable,
[b])&&(a=a.concat(b.getTouchAction()))});return Ea(a.join(" "))},preventDefaults:function(a){if(!Oa){var b=a.srcEvent;a=a.offsetDirection;if(this.manager.session.prevented)b.preventDefault();else{var c=this.actions,d=-1<c.indexOf("none"),e=-1<c.indexOf("pan-y"),c=-1<c.indexOf("pan-x");if(d||e&&a&6||c&&a&24)return this.preventSrc(b)}}},preventSrc:function(a){this.manager.session.prevented=!0;a.preventDefault()}};Q.prototype={defaults:{},set:function(a){k(this.options,a);this.manager&&this.manager.touchAction.update();
return this},recognizeWith:function(a){if(g(a,"recognizeWith",this))return this;var b=this.simultaneous;a=Y(a,this);b[a.id]||(b[a.id]=a,a.recognizeWith(this));return this},dropRecognizeWith:function(a){if(g(a,"dropRecognizeWith",this))return this;a=Y(a,this);delete this.simultaneous[a.id];return this},require2Failure:function(a){if(g(a,"require2Failure",this))return this;var b=this.require2Fail;a=Y(a,this);-1===z(b,a)&&(b.push(a),a.require2Failure(this));return this},droprequire2Failure:function(a){if(g(a,
"droprequire2Failure",this))return this;a=Y(a,this);a=z(this.require2Fail,a);-1<a&&this.require2Fail.splice(a,1);return this},hasrequire2Failures:function(){return 0<this.require2Fail.length},canRecognizeWith:function(a){return!!this.simultaneous[a.id]},emit:function(a){function b(e){c.manager.emit(c.options.event+(e?d&16?"cancel":d&8?"end":d&4?"move":d&2?"start":"":""),a)}var c=this,d=this.state;8>d&&b(!0);b();8<=d&&b(!0)},tryEmit:function(a){if(this.canEmit())return this.emit(a);this.state=32},
canEmit:function(){for(var a=0;a<this.require2Fail.length;){if(!(this.require2Fail[a].state&33))return!1;a++}return!0},recognize:function(a){a=k({},a);n(this.options.enable,[this,a])?(this.state&56&&(this.state=1),this.state=this.process(a),this.state&30&&this.tryEmit(a)):(this.reset(),this.state=32)},process:function(a){},getTouchAction:function(){},reset:function(){}};m(S,Q,{defaults:{pointers:1},attrTest:function(a){var b=this.options.pointers;return 0===b||a.pointers.length===b},process:function(a){var b=
this.state,c=a.eventType,d=b&6;a=this.attrTest(a);return d&&(c&8||!a)?b|16:d||a?c&4?b|8:b&2?b|4:2:32}});m(V,S,{defaults:{event:"pan",threshold:10,pointers:1,direction:30},getTouchAction:function(){var a=this.options.direction,b=[];a&6&&b.push("pan-y");a&24&&b.push("pan-x");return b},directionTest:function(a){var b=this.options,c=!0,d=a.distance,e=a.direction,f=a.deltaX,g=a.deltaY;e&b.direction||(b.direction&6?(e=0===f?1:0>f?2:4,c=f!=this.pX,d=Math.abs(a.deltaX)):(e=0===g?1:0>g?8:16,c=g!=this.pY,d=
Math.abs(a.deltaY)));a.direction=e;return c&&d>b.threshold&&e&b.direction},attrTest:function(a){return S.prototype.attrTest.call(this,a)&&(this.state&2||!(this.state&2)&&this.directionTest(a))},emit:function(a){this.pX=a.deltaX;this.pY=a.deltaY;var b=ea(a.direction);b&&this.manager.emit(this.options.event+b,a);this._super.emit.call(this,a)}});m(aa,S,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return["none"]},attrTest:function(a){return this._super.attrTest.call(this,
a)&&(Math.abs(a.scale-1)>this.options.threshold||this.state&2)},emit:function(a){this._super.emit.call(this,a);1!==a.scale&&this.manager.emit(this.options.event+(1>a.scale?"in":"out"),a)}});m(ba,Q,{defaults:{event:"press",pointers:1,time:500,threshold:5},getTouchAction:function(){return["auto"]},process:function(a){var b=this.options,d=a.pointers.length===b.pointers,e=a.distance<b.threshold,f=a.deltaTime>b.time;this._input=a;if(!e||!d||a.eventType&12&&!f)this.reset();else if(a.eventType&1)this.reset(),
this._timer=c(function(){this.state=8;this.tryEmit()},b.time,this);else if(a.eventType&4)return 8;return 32},reset:function(){clearTimeout(this._timer)},emit:function(a){8===this.state&&(a&&a.eventType&4?this.manager.emit(this.options.event+"up",a):(this._input.timeStamp=Aa(),this.manager.emit(this.options.event,this._input)))}});m(ua,S,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return["none"]},attrTest:function(a){return this._super.attrTest.call(this,a)&&(Math.abs(a.rotation)>
this.options.threshold||this.state&2)}});m(va,S,{defaults:{event:"swipe",threshold:10,velocity:.65,direction:30,pointers:1},getTouchAction:function(){return V.prototype.getTouchAction.call(this)},attrTest:function(a){var b=this.options.direction,c;b&30?c=a.velocity:b&6?c=a.velocityX:b&24&&(c=a.velocityY);return this._super.attrTest.call(this,a)&&b&a.direction&&a.distance>this.options.threshold&&ra(c)>this.options.velocity&&a.eventType&4},emit:function(a){var b=ea(a.direction);b&&this.manager.emit(this.options.event+
b,a);this.manager.emit(this.options.event,a)}});m(L,Q,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:2,posThreshold:10},getTouchAction:function(){return["manipulation"]},process:function(a){var b=this.options,d=a.pointers.length===b.pointers,e=a.distance<b.threshold,f=a.deltaTime<b.time;this.reset();if(a.eventType&1&&0===this.count)return this.failTimeout();if(e&&f&&d){if(4!=a.eventType)return this.failTimeout();d=this.pTime?a.timeStamp-this.pTime<b.interval:!0;e=!this.pCenter||
I(this.pCenter,a.center)<b.posThreshold;this.pTime=a.timeStamp;this.pCenter=a.center;this.count=e&&d?this.count+1:1;this._input=a;if(0===this.count%b.taps)return this.hasrequire2Failures()?(this._timer=c(function(){this.state=8;this.tryEmit()},b.interval,this),2):8}return 32},failTimeout:function(){this._timer=c(function(){this.state=32},this.options.interval,this);return 32},reset:function(){clearTimeout(this._timer)},emit:function(){8==this.state&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,
this._input))}});K.VERSION="2.0.4";K.defaults={domEvents:!1,touchAction:"compute",enable:!0,inputTarget:null,inputClass:null,preset:[[ua,{enable:!1}],[aa,{enable:!1},["rotate"]],[va,{direction:6}],[V,{direction:6},["swipe"]],[L],[L,{event:"doubletap",taps:2},["tap"]],[ba]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};h.prototype={set:function(a){k(this.options,a);a.touchAction&&this.touchAction.update();
a.inputTarget&&(this.input.destroy(),this.input.target=a.inputTarget,this.input.init());return this},stop:function(a){this.session.stopped=a?2:1},recognize:function(a){var b=this.session;if(!b.stopped){this.touchAction.preventDefaults(a);var c,d=this.recognizers,e=b.curRecognizer;if(!e||e&&e.state&8)e=b.curRecognizer=null;for(var f=0;f<d.length;)c=d[f],2===b.stopped||e&&c!=e&&!c.canRecognizeWith(e)?c.reset():c.recognize(a),!e&&c.state&14&&(e=b.curRecognizer=c),f++}},get:function(a){if(a instanceof
Q)return a;for(var b=this.recognizers,c=0;c<b.length;c++)if(b[c].options.event==a)return b[c];return null},add:function(a){if(g(a,"add",this))return this;var b=this.get(a.options.event);b&&this.remove(b);this.recognizers.push(a);a.manager=this;this.touchAction.update();return a},remove:function(a){if(g(a,"remove",this))return this;var b=this.recognizers;a=this.get(a);b.splice(z(b,a),1);this.touchAction.update();return this},on:function(a,b){var c=this.handlers;f(u(a),function(a){c[a]=c[a]||[];c[a].push(b)});
return this},off:function(a,b){var c=this.handlers;f(u(a),function(a){b?c[a].splice(z(c[a],b),1):delete c[a]});return this},emit:function(a,b){this.options.domEvents&&Xa(a,b);var c=this.handlers[a]&&this.handlers[a].slice();if(c&&c.length){b.type=a;b.preventDefault=function(){b.srcEvent.preventDefault()};for(var d=0;d<c.length;)c[d](b),d++}},destroy:function(){this.element&&Ma(this,!1);this.handlers={};this.session={};this.input.destroy();this.element=null}};k(K,{INPUT_START:1,INPUT_MOVE:2,INPUT_END:4,
INPUT_CANCEL:8,STATE_POSSIBLE:1,STATE_BEGAN:2,STATE_CHANGED:4,STATE_ENDED:8,STATE_RECOGNIZED:8,STATE_CANCELLED:16,STATE_FAILED:32,DIRECTION_NONE:1,DIRECTION_LEFT:2,DIRECTION_RIGHT:4,DIRECTION_UP:8,DIRECTION_DOWN:16,DIRECTION_HORIZONTAL:6,DIRECTION_VERTICAL:24,DIRECTION_ALL:30,Manager:h,Input:w,TouchAction:X,TouchInput:U,MouseInput:P,PointerEventInput:Z,TouchMouseInput:ka,SingleTouchInput:ca,Recognizer:Q,AttrRecognizer:S,Tap:L,Pan:V,Swipe:va,Pinch:aa,Rotate:ua,Press:ba,on:x,off:y,each:f,merge:l,extend:k,
inherit:m,bindFn:p,prefixed:r});"function"==typeof define&&define.amd?define(function(){return K}):"undefined"!=typeof module&&module.exports?module.exports=K:e[d]=K})(window,document,"Hammer");
(function(e,b){"object"===typeof module&&"object"===typeof module.exports?module.exports=e.document?b(e,!0):function(d){if(!d.document)throw Error("jQuery require2s a window with a document");return b(d)}:b(e)})("undefined"!==typeof window?window:this,function(e,b){function d(a){var b="length"in a&&a.length,c=h.type(a);return"function"===c||h.isWindow(a)?!1:1===a.nodeType&&b?!0:"array"===c||0===b||"number"===typeof b&&0<b&&b-1 in a}function a(a,b,c){if(h.isFunction(b))return h.grep(a,function(a,d){return!!b.call(a,
d,a)!==c});if(b.nodeType)return h.grep(a,function(a){return a===b!==c});if("string"===typeof b){if(Wa.test(b))return h.filter(b,a,c);b=h.filter(b,a)}return h.grep(a,function(a){return 0<=aa.call(b,a)!==c})}function c(a,b){for(;(a=a[b])&&1!==a.nodeType;);return a}function g(a){var b=na[a]={};h.each(a.match(ha)||[],function(a,c){b[c]=!0});return b}function f(){K.removeEventListener("DOMContentLoaded",f,!1);e.removeEventListener("load",f,!1);h.ready()}function k(){Object.defineProperty(this.cache={},
0,{get:function(){return{}}});this.expando=h.expando+k.uid++}function l(a,b,c){if(void 0===c&&1===a.nodeType)if(c="data-"+b.replace(Ka,"-$1").toLowerCase(),c=a.getAttribute(c),"string"===typeof c){try{c="true"===c?!0:"false"===c?!1:"null"===c?null:+c+""===c?+c:Za.test(c)?h.parseJSON(c):c}catch(d){}R.set(a,b,c)}else c=void 0;return c}function m(){return!0}function p(){return!1}function n(){try{return K.activeElement}catch(a){}}function x(a,b){return h.nodeName(a,"table")&&h.nodeName(11!==b.nodeType?
b:b.firstChild,"tr")?a.getElementsByTagName("tbody")[0]||a.appendChild(a.ownerDocument.createElement("tbody")):a}function y(a){a.type=(null!==a.getAttribute("type"))+"/"+a.type;return a}function E(a){var b=Cb.exec(a.type);b?a.type=b[1]:a.removeAttribute("type");return a}function u(a,b){for(var c=0,d=a.length;c<d;c++)G.set(a[c],"globalEval",!b||G.get(b[c],"globalEval"))}function z(a,b){var c,d,e,f;if(1===b.nodeType){if(G.hasData(a)&&(f=G.access(a),c=G.set(b,f),f=f.events))for(e in delete c.handle,
c.events={},f)for(c=0,d=f[e].length;c<d;c++)h.event.add(b,e,f[e][c]);R.hasData(a)&&(e=R.access(a),e=h.extend({},e),R.set(b,e))}}function q(a,b){var c=a.getElementsByTagName?a.getElementsByTagName(b||"*"):a.querySelectorAll?a.querySelectorAll(b||"*"):[];return void 0===b||b&&h.nodeName(a,b)?h.merge([a],c):c}function t(a,b){var c,d=h(b.createElement(a)).appendTo(b.body),f=e.getDefaultComputedStyle&&(c=e.getDefaultComputedStyle(d[0]))?c.display:h.css(d[0],"display");d.detach();return f}function r(a){var b=
K,c=lb[a];c||(c=t(a,b),"none"!==c&&c||(Pa=(Pa||h("<iframe frameborder='0' width='0' height='0'/>")).appendTo(b.documentElement),b=Pa[0].contentDocument,b.write(),b.close(),c=t(a,b),Pa.detach()),lb[a]=c);return c}function v(a,b,c){var d,e,f=a.style;(c=c||Qa(a))&&(e=c.getPropertyValue(b)||c[b]);c&&(""!==e||h.contains(a.ownerDocument,a)||(e=h.style(a,b)),$a.test(e)&&mb.test(b)&&(a=f.width,b=f.minWidth,d=f.maxWidth,f.minWidth=f.maxWidth=f.width=e,e=c.width,f.width=a,f.minWidth=b,f.maxWidth=d));return void 0!==
e?e+"":e}function w(a,b){return{get:function(){if(a())delete this.get;else return(this.get=b).apply(this,arguments)}}}function D(a,b){if(b in a)return b;for(var c=b[0].toUpperCase()+b.slice(1),d=b,e=nb.length;e--;)if(b=nb[e]+c,b in a)return b;return d}function A(a,b,c){return(a=Db.exec(b))?Math.max(0,a[1]-(c||0))+(a[2]||"px"):b}function C(a,b,c,d,e){b=c===(d?"border":"content")?4:"width"===b?1:0;for(var f=0;4>b;b+=2)"margin"===c&&(f+=h.css(a,c+ma[b],!0,e)),d?("content"===c&&(f-=h.css(a,"padding"+
ma[b],!0,e)),"margin"!==c&&(f-=h.css(a,"border"+ma[b]+"Width",!0,e))):(f+=h.css(a,"padding"+ma[b],!0,e),"padding"!==c&&(f+=h.css(a,"border"+ma[b]+"Width",!0,e)));return f}function H(a,b,c){var d=!0,e="width"===b?a.offsetWidth:a.offsetHeight,f=Qa(a),g="border-box"===h.css(a,"boxSizing",!1,f);if(0>=e||null==e){e=v(a,b,f);if(0>e||null==e)e=a.style[b];if($a.test(e))return e;d=g&&(L.boxSizingReliable()||e===a.style[b]);e=parseFloat(e)||0}return e+C(a,b,c||(g?"border":"content"),d,f)+"px"}function F(a,
b){for(var c,d,e,f=[],g=0,k=a.length;g<k;g++)d=a[g],d.style&&(f[g]=G.get(d,"olddisplay"),c=d.style.display,b?(f[g]||"none"!==c||(d.style.display=""),""===d.style.display&&wa(d)&&(f[g]=G.access(d,"olddisplay",r(d.nodeName)))):(e=wa(d),"none"===c&&e||G.set(d,"olddisplay",e?c:h.css(d,"display"))));for(g=0;g<k;g++)d=a[g],!d.style||b&&"none"!==d.style.display&&""!==d.style.display||(d.style.display=b?f[g]||"":"none");return a}function I(a,b,c,d,e){return new I.prototype.init(a,b,c,d,e)}function N(){setTimeout(function(){Ca=
void 0});return Ca=h.now()}function P(a,b){var c,d=0,e={height:a};for(b=b?1:0;4>d;d+=2-b)c=ma[d],e["margin"+c]=e["padding"+c]=a;b&&(e.opacity=e.width=a);return e}function Z(a,b,c){for(var d,e=(Fa[b]||[]).concat(Fa["*"]),f=0,g=e.length;f<g;f++)if(d=e[f].call(c,b,a))return d}function ca(a,b){var c,d,e,f,g;for(c in a)if(d=h.camelCase(c),e=b[d],f=a[c],h.isArray(f)&&(e=f[1],f=a[c]=f[0]),c!==d&&(a[d]=f,delete a[c]),(g=h.cssHooks[d])&&"expand"in g)for(c in f=g.expand(f),delete a[d],f)c in a||(a[c]=f[c],
b[c]=e);else b[d]=e}function U(a,b,c){var d,e=0,f=Ra.length,g=h.Deferred().always(function(){delete k.elem}),k=function(){if(d)return!1;for(var b=Ca||N(),b=Math.max(0,l.startTime+l.duration-b),c=1-(b/l.duration||0),e=0,f=l.tweens.length;e<f;e++)l.tweens[e].run(c);g.notifyWith(a,[l,c,b]);if(1>c&&f)return b;g.resolveWith(a,[l]);return!1},l=g.promise({elem:a,props:h.extend({},b),opts:h.extend(!0,{specialEasing:{}},c),originalProperties:b,originalOptions:c,startTime:Ca||N(),duration:c.duration,tweens:[],
createTween:function(b,c){var d=h.Tween(a,l.opts,b,c,l.opts.specialEasing[b]||l.opts.easing);l.tweens.push(d);return d},stop:function(b){var c=0,e=b?l.tweens.length:0;if(d)return this;for(d=!0;c<e;c++)l.tweens[c].run(1);b?g.resolveWith(a,[l,b]):g.rejectWith(a,[l,b]);return this}});c=l.props;for(ca(c,l.opts.specialEasing);e<f;e++)if(b=Ra[e].call(l,a,c,l.opts))return b;h.map(c,Z,l);h.isFunction(l.opts.start)&&l.opts.start.call(a,l);h.fx.timer(h.extend(k,{elem:a,anim:l,queue:l.opts.queue}));return l.progress(l.opts.progress).done(l.opts.done,
l.opts.complete).fail(l.opts.fail).always(l.opts.always)}function za(a){return function(b,c){"string"!==typeof b&&(c=b,b="*");var d,e=0,f=b.toLowerCase().match(ha)||[];if(h.isFunction(c))for(;d=f[e++];)"+"===d[0]?(d=d.slice(1)||"*",(a[d]=a[d]||[]).unshift(c)):(a[d]=a[d]||[]).push(c)}}function ka(a,b,c,d){function e(k){var l;f[k]=!0;h.each(a[k]||[],function(a,B){var h=B(b,c,d);if("string"===typeof h&&!g&&!f[h])return b.dataTypes.unshift(h),e(h),!1;if(g)return!(l=h)});return l}var f={},g=a===ab;return e(b.dataTypes[0])||
!f["*"]&&e("*")}function X(a,b){var c,d,e=h.ajaxSettings.flatOptions||{};for(c in b)void 0!==b[c]&&((e[c]?a:d||(d={}))[c]=b[c]);d&&h.extend(!0,a,d);return a}function Ea(a,b,c,d){var e;if(h.isArray(b))h.each(b,function(b,e){c||Eb.test(a)?d(a,e):Ea(a+"["+("object"===typeof e?b:"")+"]",e,c,d)});else if(c||"object"!==h.type(b))d(a,b);else for(e in b)Ea(a+"["+e+"]",b[e],c,d)}function Q(a){return h.isWindow(a)?a:9===a.nodeType&&a.defaultView}var ea=[],Y=ea.slice,S=ea.concat,V=ea.push,aa=ea.indexOf,ba={},
ua=ba.toString,va=ba.hasOwnProperty,L={},K=e.document,h=function(a,b){return new h.fn.init(a,b)},Ma=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,Xa=/^-ms-/,Ia=/-([\da-z])/gi,Ya=function(a,b){return b.toUpperCase()};h.fn=h.prototype={jquery:"2.1.4",constructor:h,selector:"",length:0,toArray:function(){return Y.call(this)},get:function(a){return null!=a?0>a?this[a+this.length]:this[a]:Y.call(this)},pushStack:function(a){a=h.merge(this.constructor(),a);a.prevObject=this;a.context=this.context;return a},each:function(a,
b){return h.each(this,a,b)},map:function(a){return this.pushStack(h.map(this,function(b,c){return a.call(b,c,b)}))},slice:function(){return this.pushStack(Y.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(a){var b=this.length;a=+a+(0>a?b:0);return this.pushStack(0<=a&&a<b?[this[a]]:[])},end:function(){return this.prevObject||this.constructor(null)},push:V,sort:ea.sort,splice:ea.splice};h.extend=h.fn.extend=function(){var a,b,c,d,e,f=arguments[0]||
{},g=1,k=arguments.length,l=!1;"boolean"===typeof f&&(l=f,f=arguments[g]||{},g++);"object"===typeof f||h.isFunction(f)||(f={});g===k&&(f=this,g--);for(;g<k;g++)if(null!=(a=arguments[g]))for(b in a)c=f[b],d=a[b],f!==d&&(l&&d&&(h.isPlainObject(d)||(e=h.isArray(d)))?(e?(e=!1,c=c&&h.isArray(c)?c:[]):c=c&&h.isPlainObject(c)?c:{},f[b]=h.extend(l,c,d)):void 0!==d&&(f[b]=d));return f};h.extend({expando:"jQuery"+("2.1.4"+Math.random()).replace(/\D/g,""),isReady:!0,error:function(a){throw Error(a);},noop:function(){},
isFunction:function(a){return"function"===h.type(a)},isArray:Array.isArray,isWindow:function(a){return null!=a&&a===a.window},isNumeric:function(a){return!h.isArray(a)&&0<=a-parseFloat(a)+1},isPlainObject:function(a){return"object"!==h.type(a)||a.nodeType||h.isWindow(a)||a.constructor&&!va.call(a.constructor.prototype,"isPrototypeOf")?!1:!0},isEmptyObject:function(a){for(var b in a)return!1;return!0},type:function(a){return null==a?a+"":"object"===typeof a||"function"===typeof a?ba[ua.call(a)]||"object":
typeof a},globalEval:function(a){var b;b=eval;if(a=h.trim(a))1===a.indexOf("use strict")?(b=K.createElement("script"),b.text=a,K.head.appendChild(b).parentNode.removeChild(b)):b(a)},camelCase:function(a){return a.replace(Xa,"ms-").replace(Ia,Ya)},nodeName:function(a,b){return a.nodeName&&a.nodeName.toLowerCase()===b.toLowerCase()},each:function(a,b,c){var e,f=0,g=a.length;e=d(a);if(c)if(e)for(;f<g&&(e=b.apply(a[f],c),!1!==e);f++);else for(f in a){if(e=b.apply(a[f],c),!1===e)break}else if(e)for(;f<
g&&(e=b.call(a[f],f,a[f]),!1!==e);f++);else for(f in a)if(e=b.call(a[f],f,a[f]),!1===e)break;return a},trim:function(a){return null==a?"":(a+"").replace(Ma,"")},makeArray:function(a,b){var c=b||[];null!=a&&(d(Object(a))?h.merge(c,"string"===typeof a?[a]:a):V.call(c,a));return c},inArray:function(a,b,c){return null==b?-1:aa.call(b,a,c)},merge:function(a,b){for(var c=+b.length,d=0,e=a.length;d<c;d++)a[e++]=b[d];a.length=e;return a},grep:function(a,b,c){for(var d=[],e=0,f=a.length,g=!c;e<f;e++)c=!b(a[e],
e),c!==g&&d.push(a[e]);return d},map:function(a,b,c){var e,f=0,g=a.length,h=[];if(d(a))for(;f<g;f++)e=b(a[f],f,c),null!=e&&h.push(e);else for(f in a)e=b(a[f],f,c),null!=e&&h.push(e);return S.apply([],h)},guid:1,proxy:function(a,b){var c,d;"string"===typeof b&&(c=a[b],b=a,a=c);if(h.isFunction(a))return d=Y.call(arguments,2),c=function(){return a.apply(b||this,d.concat(Y.call(arguments)))},c.guid=a.guid=a.guid||h.guid++,c},now:Date.now,support:L});h.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),
function(a,b){ba["[object "+b+"]"]=b.toLowerCase()});var ga=function(a){function b(a,c,d,e){var f,B,g,h,M;(c?c.ownerDocument||c:qa)!==L&&K(c);c=c||L;d=d||[];h=c.nodeType;if("string"!==typeof a||!a||1!==h&&9!==h&&11!==h)return d;if(!e&&sa){if(11!==h&&(f=Ea.exec(a)))if(g=f[1])if(9===h)if((B=c.getElementById(g))&&B.parentNode){if(B.id===g)return d.push(B),d}else return d;else{if(c.ownerDocument&&(B=c.ownerDocument.getElementById(g))&&R(c,B)&&B.id===g)return d.push(B),d}else{if(f[2])return U.apply(d,
c.getElementsByTagName(a)),d;if((g=f[3])&&t.getElementsByClassName)return U.apply(d,c.getElementsByClassName(g)),d}if(t.qsa&&(!fa||!fa.test(a))){B=f=T;g=c;M=1!==h&&a;if(1===h&&"object"!==c.nodeName.toLowerCase()){h=C(a);(f=c.getAttribute("id"))?B=f.replace(Fa,"\\$&"):c.setAttribute("id",B);B="[id='"+B+"'] ";for(g=h.length;g--;)h[g]=B+n(h[g]);g=ua.test(a)&&m(c.parentNode)||c;M=h.join(",")}if(M)try{return U.apply(d,g.querySelectorAll(M)),d}catch(J){}finally{f||c.removeAttribute("id")}}}return F(a.replace(na,
"$1"),c,d,e)}function c(){function a(c,d){b.push(c+" ")>r.cacheLength&&delete a[b.shift()];return a[c+" "]=d}var b=[];return a}function d(a){a[T]=!0;return a}function e(a){var b=L.createElement("div");try{return!!a(b)}catch(c){return!1}finally{b.parentNode&&b.parentNode.removeChild(b)}}function f(a,b){for(var c=a.split("|"),d=a.length;d--;)r.attrHandle[c[d]]=b}function g(a,b){var c=b&&a,d=c&&1===a.nodeType&&1===b.nodeType&&(~b.sourceIndex||-2147483648)-(~a.sourceIndex||-2147483648);if(d)return d;
if(c)for(;c=c.nextSibling;)if(c===b)return-1;return a?1:-1}function h(a){return function(b){return"input"===b.nodeName.toLowerCase()&&b.type===a}}function k(a){return function(b){var c=b.nodeName.toLowerCase();return("input"===c||"button"===c)&&b.type===a}}function l(a){return d(function(b){b=+b;return d(function(c,d){for(var e,f=a([],c.length,b),B=f.length;B--;)c[e=f[B]]&&(c[e]=!(d[e]=c[e]))})})}function m(a){return a&&"undefined"!==typeof a.getElementsByTagName&&a}function p(){}function n(a){for(var b=
0,c=a.length,d="";b<c;b++)d+=a[b].value;return d}function q(a,b,c){var d=b.dir,e=c&&"parentNode"===d,f=Y++;return b.first?function(b,c,f){for(;b=b[d];)if(1===b.nodeType||e)return a(b,c,f)}:function(b,c,B){var g,h,M=[P,f];if(B)for(;b=b[d];){if((1===b.nodeType||e)&&a(b,c,B))return!0}else for(;b=b[d];)if(1===b.nodeType||e){h=b[T]||(b[T]={});if((g=h[d])&&g[0]===P&&g[1]===f)return M[2]=g[2];h[d]=M;if(M[2]=a(b,c,B))return!0}}}function w(a){return 1<a.length?function(b,c,d){for(var e=a.length;e--;)if(!a[e](b,
c,d))return!1;return!0}:a[0]}function x(a,b,c,d,e){for(var f,B=[],g=0,h=a.length,M=null!=b;g<h;g++)if(f=a[g])if(!c||c(f,d,e))B.push(f),M&&b.push(g);return B}function u(a,c,e,f,B,g){f&&!f[T]&&(f=u(f));B&&!B[T]&&(B=u(B,g));return d(function(d,g,h,J){var k,W,l=[],da=[],ia=g.length,m;if(!(m=d)){m=c||"*";for(var O=h.nodeType?[h]:h,Ga=[],p=0,n=O.length;p<n;p++)b(m,O[p],Ga);m=Ga}m=!a||!d&&c?m:x(m,l,a,h,J);O=e?B||(d?a:ia||f)?[]:g:m;e&&e(m,O,h,J);if(f)for(k=x(O,da),f(k,[],h,J),h=k.length;h--;)if(W=k[h])O[da[h]]=
!(m[da[h]]=W);if(d){if(B||a){if(B){k=[];for(h=O.length;h--;)(W=O[h])&&k.push(m[h]=W);B(null,O=[],k,J)}for(h=O.length;h--;)(W=O[h])&&-1<(k=B?Z(d,W):l[h])&&(d[k]=!(g[k]=W))}}else O=x(O===g?O.splice(ia,O.length):O),B?B(null,g,O,J):U.apply(g,O)})}function v(a){var b,c,d,e=a.length,f=r.relative[a[0].type];c=f||r.relative[" "];for(var B=f?1:0,g=q(function(a){return a===b},c,!0),h=q(function(a){return-1<Z(b,a)},c,!0),M=[function(a,c,d){a=!f&&(d||c!==H)||((b=c).nodeType?g(a,c,d):h(a,c,d));b=null;return a}];B<
e;B++)if(c=r.relative[a[B].type])M=[q(w(M),c)];else{c=r.filter[a[B].type].apply(null,a[B].matches);if(c[T]){for(d=++B;d<e&&!r.relative[a[d].type];d++);return u(1<B&&w(M),1<B&&n(a.slice(0,B-1).concat({value:" "===a[B-2].type?"*":""})).replace(na,"$1"),c,B<d&&v(a.slice(B,d)),d<e&&v(a=a.slice(d)),d<e&&n(a))}M.push(c)}return w(M)}function z(a,c){var e=0<c.length,f=0<a.length,B=function(d,B,g,h,J){var k,W,l,da=0,ia="0",m=d&&[],O=[],Ga=H,p=d||f&&r.find.TAG("*",J),n=P+=null==Ga?1:Math.random()||.1,q=p.length;
for(J&&(H=B!==L&&B);ia!==q&&null!=(k=p[ia]);ia++){if(f&&k){for(W=0;l=a[W++];)if(l(k,B,g)){h.push(k);break}J&&(P=n)}e&&((k=!l&&k)&&da--,d&&m.push(k))}da+=ia;if(e&&ia!==da){for(W=0;l=c[W++];)l(m,O,B,g);if(d){if(0<da)for(;ia--;)m[ia]||O[ia]||(O[ia]=ga.call(h));O=x(O)}U.apply(h,O);J&&!d&&0<O.length&&1<da+c.length&&b.uniqueSort(h)}J&&(P=n,H=Ga);return m};return e?d(B):B}var y,t,r,A,D,C,E,F,H,G,I,K,L,N,sa,fa,Q,S,R,T="sizzle"+1*new Date,qa=a.document,P=0,Y=0,X=c(),aa=c(),ca=c(),ba=function(a,b){a===b&&(I=
!0);return 0},ea={}.hasOwnProperty,V=[],ga=V.pop,ha=V.push,U=V.push,ja=V.slice,Z=function(a,b){for(var c=0,d=a.length;c<d;c++)if(a[c]===b)return c;return-1},ka="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+".replace("w","w#"),la="\\[[\\x20\\t\\r\\n\\f]*((?:\\\\.|[\\w-]|[^\\x00-\\xa0])+)(?:[\\x20\\t\\r\\n\\f]*([*^$|!~]?=)[\\x20\\t\\r\\n\\f]*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+ka+"))|)[\\x20\\t\\r\\n\\f]*\\]",ma=":((?:\\\\.|[\\w-]|[^\\x00-\\xa0])+)(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+
la+")*)|.*)\\)|)",ra=RegExp("[\\x20\\t\\r\\n\\f]+","g"),na=RegExp("^[\\x20\\t\\r\\n\\f]+|((?:^|[^\\\\])(?:\\\\.)*)[\\x20\\t\\r\\n\\f]+$","g"),ta=/^[\x20\t\r\n\f]*,[\x20\t\r\n\f]*/,va=/^[\x20\t\r\n\f]*([>+~]|[\x20\t\r\n\f])[\x20\t\r\n\f]*/,wa=RegExp("=[\\x20\\t\\r\\n\\f]*([^\\]'\"]*?)[\\x20\\t\\r\\n\\f]*\\]","g"),za=new RegExp(ma),Aa=new RegExp("^"+ka+"$"),pa={ID:/^#((?:\\.|[\w-]|[^\x00-\xa0])+)/,CLASS:/^\.((?:\\.|[\w-]|[^\x00-\xa0])+)/,TAG:new RegExp("^("+"(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+".replace("w",
"w*")+")"),ATTR:new RegExp("^"+la),PSEUDO:new RegExp("^"+ma),CHILD:/^:(only|first|last|nth|nth-last)-(child|of-type)(?:\([\x20\t\r\n\f]*(even|odd|(([+-]|)(\d*)n|)[\x20\t\r\n\f]*(?:([+-]|)[\x20\t\r\n\f]*(\d+)|))[\x20\t\r\n\f]*\)|)/i,bool:/^(?:checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|require2d|scoped)$/i,needsContext:/^[\x20\t\r\n\f]*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\([\x20\t\r\n\f]*((?:-\d)?\d*)[\x20\t\r\n\f]*\)|)(?=[^-]|$)/i},
Ba=/^(?:input|select|textarea|button)$/i,Ca=/^h\d$/i,oa=/^[^{]+\{\s*\[native \w/,Ea=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,ua=/[+~]/,Fa=/'|\\/g,xa=RegExp("\\\\([\\da-f]{1,6}[\\x20\\t\\r\\n\\f]?|([\\x20\\t\\r\\n\\f])|.)","ig"),ya=function(a,b,c){a="0x"+b-65536;return a!==a||c?b:0>a?String.fromCharCode(a+65536):String.fromCharCode(a>>10|55296,a&1023|56320)},Da=function(){K()};try{U.apply(V=ja.call(qa.childNodes),qa.childNodes),V[qa.childNodes.length].nodeType}catch(Zb){U={apply:V.length?function(a,b){ha.apply(a,
ja.call(b))}:function(a,b){for(var c=a.length,d=0;a[c++]=b[d++];);a.length=c-1}}}t=b.support={};D=b.isXML=function(a){return(a=a&&(a.ownerDocument||a).documentElement)?"HTML"!==a.nodeName:!1};K=b.setDocument=function(a){var b=a?a.ownerDocument||a:qa;if(b===L||9!==b.nodeType||!b.documentElement)return L;L=b;N=b.documentElement;(a=b.defaultView)&&a!==a.top&&(a.addEventListener?a.addEventListener("unload",Da,!1):a.attachEvent&&a.attachEvent("onunload",Da));sa=!D(b);t.attributes=e(function(a){a.className=
"i";return!a.getAttribute("className")});t.getElementsByTagName=e(function(a){a.appendChild(b.createComment(""));return!a.getElementsByTagName("*").length});t.getElementsByClassName=oa.test(b.getElementsByClassName);t.getById=e(function(a){N.appendChild(a).id=T;return!b.getElementsByName||!b.getElementsByName(T).length});t.getById?(r.find.ID=function(a,b){if("undefined"!==typeof b.getElementById&&sa){var c=b.getElementById(a);return c&&c.parentNode?[c]:[]}},r.filter.ID=function(a){var b=a.replace(xa,
ya);return function(a){return a.getAttribute("id")===b}}):(delete r.find.ID,r.filter.ID=function(a){var b=a.replace(xa,ya);return function(a){return(a="undefined"!==typeof a.getAttributeNode&&a.getAttributeNode("id"))&&a.value===b}});r.find.TAG=t.getElementsByTagName?function(a,b){if("undefined"!==typeof b.getElementsByTagName)return b.getElementsByTagName(a);if(t.qsa)return b.querySelectorAll(a)}:function(a,b){var c,d=[],e=0,f=b.getElementsByTagName(a);if("*"===a){for(;c=f[e++];)1===c.nodeType&&
d.push(c);return d}return f};r.find.CLASS=t.getElementsByClassName&&function(a,b){if(sa)return b.getElementsByClassName(a)};Q=[];fa=[];if(t.qsa=oa.test(b.querySelectorAll))e(function(a){N.appendChild(a).innerHTML="<a id='"+T+"'></a><select id='"+T+"-\f]' msallowcapture=''><option selected=''></option></select>";a.querySelectorAll("[msallowcapture^='']").length&&fa.push("[*^$]=[\\x20\\t\\r\\n\\f]*(?:''|\"\")");a.querySelectorAll("[selected]").length||fa.push("\\[[\\x20\\t\\r\\n\\f]*(?:value|checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|require2d|scoped)");
a.querySelectorAll("[id~="+T+"-]").length||fa.push("~=");a.querySelectorAll(":checked").length||fa.push(":checked");a.querySelectorAll("a#"+T+"+*").length||fa.push(".#.+[+~]")}),e(function(a){var c=b.createElement("input");c.setAttribute("type","hidden");a.appendChild(c).setAttribute("name","D");a.querySelectorAll("[name=d]").length&&fa.push("name[\\x20\\t\\r\\n\\f]*[*^$|!~]?=");a.querySelectorAll(":enabled").length||fa.push(":enabled",":disabled");a.querySelectorAll("*,:x");fa.push(",.*:")});(t.matchesSelector=
oa.test(S=N.matches||N.webkitMatchesSelector||N.mozMatchesSelector||N.oMatchesSelector||N.msMatchesSelector))&&e(function(a){t.disconnectedMatch=S.call(a,"div");S.call(a,"[s!='']:x");Q.push("!=",ma)});fa=fa.length&&new RegExp(fa.join("|"));Q=Q.length&&new RegExp(Q.join("|"));R=(a=oa.test(N.compareDocumentPosition))||oa.test(N.contains)?function(a,b){var c=9===a.nodeType?a.documentElement:a,d=b&&b.parentNode;return a===d||!!(d&&1===d.nodeType&&(c.contains?c.contains(d):a.compareDocumentPosition&&a.compareDocumentPosition(d)&
16))}:function(a,b){if(b)for(;b=b.parentNode;)if(b===a)return!0;return!1};ba=a?function(a,c){if(a===c)return I=!0,0;var d=!a.compareDocumentPosition-!c.compareDocumentPosition;if(d)return d;d=(a.ownerDocument||a)===(c.ownerDocument||c)?a.compareDocumentPosition(c):1;return d&1||!t.sortDetached&&c.compareDocumentPosition(a)===d?a===b||a.ownerDocument===qa&&R(qa,a)?-1:c===b||c.ownerDocument===qa&&R(qa,c)?1:G?Z(G,a)-Z(G,c):0:d&4?-1:1}:function(a,c){if(a===c)return I=!0,0;var d,e=0;d=a.parentNode;var f=
c.parentNode,B=[a],h=[c];if(!d||!f)return a===b?-1:c===b?1:d?-1:f?1:G?Z(G,a)-Z(G,c):0;if(d===f)return g(a,c);for(d=a;d=d.parentNode;)B.unshift(d);for(d=c;d=d.parentNode;)h.unshift(d);for(;B[e]===h[e];)e++;return e?g(B[e],h[e]):B[e]===qa?-1:h[e]===qa?1:0};return b};b.matches=function(a,c){return b(a,null,null,c)};b.matchesSelector=function(a,c){(a.ownerDocument||a)!==L&&K(a);c=c.replace(wa,"='$1']");if(!(!t.matchesSelector||!sa||Q&&Q.test(c)||fa&&fa.test(c)))try{var d=S.call(a,c);if(d||t.disconnectedMatch||
a.document&&11!==a.document.nodeType)return d}catch(e){}return 0<b(c,L,null,[a]).length};b.contains=function(a,b){(a.ownerDocument||a)!==L&&K(a);return R(a,b)};b.attr=function(a,b){(a.ownerDocument||a)!==L&&K(a);var c=r.attrHandle[b.toLowerCase()],c=c&&ea.call(r.attrHandle,b.toLowerCase())?c(a,b,!sa):void 0;return void 0!==c?c:t.attributes||!sa?a.getAttribute(b):(c=a.getAttributeNode(b))&&c.specified?c.value:null};b.error=function(a){throw Error("Syntax error, unrecognized expression: "+a);};b.uniqueSort=
function(a){var b,c=[],d=0,e=0;I=!t.detectDuplicates;G=!t.sortStable&&a.slice(0);a.sort(ba);if(I){for(;b=a[e++];)b===a[e]&&(d=c.push(e));for(;d--;)a.splice(c[d],1)}G=null;return a};A=b.getText=function(a){var b,c="",d=0;b=a.nodeType;if(!b)for(;b=a[d++];)c+=A(b);else if(1===b||9===b||11===b){if("string"===typeof a.textContent)return a.textContent;for(a=a.firstChild;a;a=a.nextSibling)c+=A(a)}else if(3===b||4===b)return a.nodeValue;return c};r=b.selectors={cacheLength:50,createPseudo:d,match:pa,attrHandle:{},
find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(a){a[1]=a[1].replace(xa,ya);a[3]=(a[3]||a[4]||a[5]||"").replace(xa,ya);"~="===a[2]&&(a[3]=" "+a[3]+" ");return a.slice(0,4)},CHILD:function(a){a[1]=a[1].toLowerCase();"nth"===a[1].slice(0,3)?(a[3]||b.error(a[0]),a[4]=+(a[4]?a[5]+(a[6]||1):2*("even"===a[3]||"odd"===a[3])),a[5]=+(a[7]+a[8]||"odd"===a[3])):a[3]&&b.error(a[0]);return a},PSEUDO:function(a){var b,
c=!a[6]&&a[2];if(pa.CHILD.test(a[0]))return null;a[3]?a[2]=a[4]||a[5]||"":c&&za.test(c)&&(b=C(c,!0))&&(b=c.indexOf(")",c.length-b)-c.length)&&(a[0]=a[0].slice(0,b),a[2]=c.slice(0,b));return a.slice(0,3)}},filter:{TAG:function(a){var b=a.replace(xa,ya).toLowerCase();return"*"===a?function(){return!0}:function(a){return a.nodeName&&a.nodeName.toLowerCase()===b}},CLASS:function(a){var b=X[a+" "];return b||(b=new RegExp("(^|[\\x20\\t\\r\\n\\f])"+a+"([\\x20\\t\\r\\n\\f]|$)"))&&X(a,function(a){return b.test("string"===
typeof a.className&&a.className||"undefined"!==typeof a.getAttribute&&a.getAttribute("class")||"")})},ATTR:function(a,c,d){return function(e){e=b.attr(e,a);if(null==e)return"!="===c;if(!c)return!0;e+="";return"="===c?e===d:"!="===c?e!==d:"^="===c?d&&0===e.indexOf(d):"*="===c?d&&-1<e.indexOf(d):"$="===c?d&&e.slice(-d.length)===d:"~="===c?-1<(" "+e.replace(ra," ")+" ").indexOf(d):"|="===c?e===d||e.slice(0,d.length+1)===d+"-":!1}},CHILD:function(a,b,c,d,e){var f="nth"!==a.slice(0,3),B="last"!==a.slice(-4),
g="of-type"===b;return 1===d&&0===e?function(a){return!!a.parentNode}:function(b,c,h){var M,J,k,W,l;c=f!==B?"nextSibling":"previousSibling";var da=b.parentNode,ia=g&&b.nodeName.toLowerCase();h=!h&&!g;if(da){if(f){for(;c;){for(J=b;J=J[c];)if(g?J.nodeName.toLowerCase()===ia:1===J.nodeType)return!1;l=c="only"===a&&!l&&"nextSibling"}return!0}l=[B?da.firstChild:da.lastChild];if(B&&h)for(h=da[T]||(da[T]={}),M=h[a]||[],W=M[0]===P&&M[1],k=M[0]===P&&M[2],J=W&&da.childNodes[W];J=++W&&J&&J[c]||(k=W=0)||l.pop();){if(1===
J.nodeType&&++k&&J===b){h[a]=[P,W,k];break}}else if(h&&(M=(b[T]||(b[T]={}))[a])&&M[0]===P)k=M[1];else for(;(J=++W&&J&&J[c]||(k=W=0)||l.pop())&&((g?J.nodeName.toLowerCase()!==ia:1!==J.nodeType)||!++k||(h&&((J[T]||(J[T]={}))[a]=[P,k]),J!==b)););k-=e;return k===d||0===k%d&&0<=k/d}}},PSEUDO:function(a,c){var e,f=r.pseudos[a]||r.setFilters[a.toLowerCase()]||b.error("unsupported pseudo: "+a);return f[T]?f(c):1<f.length?(e=[a,a,"",c],r.setFilters.hasOwnProperty(a.toLowerCase())?d(function(a,b){for(var d,
e=f(a,c),B=e.length;B--;)d=Z(a,e[B]),a[d]=!(b[d]=e[B])}):function(a){return f(a,0,e)}):f}},pseudos:{not:d(function(a){var b=[],c=[],e=E(a.replace(na,"$1"));return e[T]?d(function(a,b,c,d){d=e(a,null,d,[]);for(var f=a.length;f--;)if(c=d[f])a[f]=!(b[f]=c)}):function(a,d,f){b[0]=a;e(b,null,f,c);b[0]=null;return!c.pop()}}),has:d(function(a){return function(c){return 0<b(a,c).length}}),contains:d(function(a){a=a.replace(xa,ya);return function(b){return-1<(b.textContent||b.innerText||A(b)).indexOf(a)}}),
lang:d(function(a){Aa.test(a||"")||b.error("unsupported lang: "+a);a=a.replace(xa,ya).toLowerCase();return function(b){var c;do if(c=sa?b.lang:b.getAttribute("xml:lang")||b.getAttribute("lang"))return c=c.toLowerCase(),c===a||0===c.indexOf(a+"-");while((b=b.parentNode)&&1===b.nodeType);return!1}}),target:function(b){var c=a.location&&a.location.hash;return c&&c.slice(1)===b.id},root:function(a){return a===N},focus:function(a){return a===L.activeElement&&(!L.hasFocus||L.hasFocus())&&!!(a.type||a.href||
~a.tabIndex)},enabled:function(a){return!1===a.disabled},disabled:function(a){return!0===a.disabled},checked:function(a){var b=a.nodeName.toLowerCase();return"input"===b&&!!a.checked||"option"===b&&!!a.selected},selected:function(a){a.parentNode&&a.parentNode.selectedIndex;return!0===a.selected},empty:function(a){for(a=a.firstChild;a;a=a.nextSibling)if(6>a.nodeType)return!1;return!0},parent:function(a){return!r.pseudos.empty(a)},header:function(a){return Ca.test(a.nodeName)},input:function(a){return Ba.test(a.nodeName)},
button:function(a){var b=a.nodeName.toLowerCase();return"input"===b&&"button"===a.type||"button"===b},text:function(a){var b;return"input"===a.nodeName.toLowerCase()&&"text"===a.type&&(null==(b=a.getAttribute("type"))||"text"===b.toLowerCase())},first:l(function(){return[0]}),last:l(function(a,b){return[b-1]}),eq:l(function(a,b,c){return[0>c?c+b:c]}),even:l(function(a,b){for(var c=0;c<b;c+=2)a.push(c);return a}),odd:l(function(a,b){for(var c=1;c<b;c+=2)a.push(c);return a}),lt:l(function(a,b,c){for(b=
0>c?c+b:c;0<=--b;)a.push(b);return a}),gt:l(function(a,b,c){for(c=0>c?c+b:c;++c<b;)a.push(c);return a})}};r.pseudos.nth=r.pseudos.eq;for(y in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})r.pseudos[y]=h(y);for(y in{submit:!0,reset:!0})r.pseudos[y]=k(y);p.prototype=r.filters=r.pseudos;r.setFilters=new p;C=b.tokenize=function(a,c){var d,e,f,B,g,h,J;if(g=aa[a+" "])return c?0:g.slice(0);g=a;h=[];for(J=r.preFilter;g;){if(!d||(e=ta.exec(g)))e&&(g=g.slice(e[0].length)||g),h.push(f=[]);d=!1;if(e=va.exec(g))d=
e.shift(),f.push({value:d,type:e[0].replace(na," ")}),g=g.slice(d.length);for(B in r.filter)!(e=pa[B].exec(g))||J[B]&&!(e=J[B](e))||(d=e.shift(),f.push({value:d,type:B,matches:e}),g=g.slice(d.length));if(!d)break}return c?g.length:g?b.error(a):aa(a,h).slice(0)};E=b.compile=function(a,b){var c,d=[],e=[],f=ca[a+" "];if(!f){b||(b=C(a));for(c=b.length;c--;)f=v(b[c]),f[T]?d.push(f):e.push(f);f=ca(a,z(e,d));f.selector=a}return f};F=b.select=function(a,b,c,d){var e,f,B,g,h="function"===typeof a&&a,M=!d&&
C(a=h.selector||a);c=c||[];if(1===M.length){f=M[0]=M[0].slice(0);if(2<f.length&&"ID"===(B=f[0]).type&&t.getById&&9===b.nodeType&&sa&&r.relative[f[1].type]){b=(r.find.ID(B.matches[0].replace(xa,ya),b)||[])[0];if(!b)return c;h&&(b=b.parentNode);a=a.slice(f.shift().value.length)}for(e=pa.needsContext.test(a)?0:f.length;e--;){B=f[e];if(r.relative[g=B.type])break;if(g=r.find[g])if(d=g(B.matches[0].replace(xa,ya),ua.test(f[0].type)&&m(b.parentNode)||b)){f.splice(e,1);a=d.length&&n(f);if(!a)return U.apply(c,
d),c;break}}}(h||E(a,M))(d,b,!sa,c,ua.test(a)&&m(b.parentNode)||b);return c};t.sortStable=T.split("").sort(ba).join("")===T;t.detectDuplicates=!!I;K();t.sortDetached=e(function(a){return a.compareDocumentPosition(L.createElement("div"))&1});e(function(a){a.innerHTML="<a href='#'></a>";return"#"===a.firstChild.getAttribute("href")})||f("type|href|height|width",function(a,b,c){if(!c)return a.getAttribute(b,"type"===b.toLowerCase()?1:2)});t.attributes&&e(function(a){a.innerHTML="<input/>";a.firstChild.setAttribute("value",
"");return""===a.firstChild.getAttribute("value")})||f("value",function(a,b,c){if(!c&&"input"===a.nodeName.toLowerCase())return a.defaultValue});e(function(a){return null==a.getAttribute("disabled")})||f("checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|require2d|scoped",function(a,b,c){var d;if(!c)return!0===a[b]?b.toLowerCase():(d=a.getAttributeNode(b))&&d.specified?d.value:null});return b}(e);h.find=ga;h.expr=ga.selectors;h.expr[":"]=h.expr.pseudos;
h.unique=ga.uniqueSort;h.text=ga.getText;h.isXMLDoc=ga.isXML;h.contains=ga.contains;var ra=h.expr.match.needsContext,Aa=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,Wa=/^.[^:#\[\.,]*$/;h.filter=function(a,b,c){var d=b[0];c&&(a=":not("+a+")");return 1===b.length&&1===d.nodeType?h.find.matchesSelector(d,a)?[d]:[]:h.find.matches(a,h.grep(b,function(a){return 1===a.nodeType}))};h.fn.extend({find:function(a){var b,c=this.length,d=[],e=this;if("string"!==typeof a)return this.pushStack(h(a).filter(function(){for(b=0;b<
c;b++)if(h.contains(e[b],this))return!0}));for(b=0;b<c;b++)h.find(a,e[b],d);d=this.pushStack(1<c?h.unique(d):d);d.selector=this.selector?this.selector+" "+a:a;return d},filter:function(b){return this.pushStack(a(this,b||[],!1))},not:function(b){return this.pushStack(a(this,b||[],!0))},is:function(b){return!!a(this,"string"===typeof b&&ra.test(b)?h(b):b||[],!1).length}});var pa,Ja=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/;(h.fn.init=function(a,b){var c;if(!a)return this;if("string"===typeof a){c="<"===
a[0]&&">"===a[a.length-1]&&3<=a.length?[null,a,null]:Ja.exec(a);if(!c||!c[1]&&b)return!b||b.jquery?(b||pa).find(a):this.constructor(b).find(a);if(c[1]){if(b=b instanceof h?b[0]:b,h.merge(this,h.parseHTML(c[1],b&&b.nodeType?b.ownerDocument||b:K,!0)),Aa.test(c[1])&&h.isPlainObject(b))for(c in b)if(h.isFunction(this[c]))this[c](b[c]);else this.attr(c,b[c])}else(c=K.getElementById(c[2]))&&c.parentNode&&(this.length=1,this[0]=c),this.context=K,this.selector=a;return this}if(a.nodeType)return this.context=
this[0]=a,this.length=1,this;if(h.isFunction(a))return"undefined"!==typeof pa.ready?pa.ready(a):a(h);void 0!==a.selector&&(this.selector=a.selector,this.context=a.context);return h.makeArray(a,this)}).prototype=h.fn;pa=h(K);var Ua=/^(?:parents|prev(?:Until|All))/,Va={children:!0,contents:!0,next:!0,prev:!0};h.extend({dir:function(a,b,c){for(var d=[],e=void 0!==c;(a=a[b])&&9!==a.nodeType;)if(1===a.nodeType){if(e&&h(a).is(c))break;d.push(a)}return d},sibling:function(a,b){for(var c=[];a;a=a.nextSibling)1===
a.nodeType&&a!==b&&c.push(a);return c}});h.fn.extend({has:function(a){var b=h(a,this),c=b.length;return this.filter(function(){for(var a=0;a<c;a++)if(h.contains(this,b[a]))return!0})},closest:function(a,b){for(var c,d=0,e=this.length,f=[],g=ra.test(a)||"string"!==typeof a?h(a,b||this.context):0;d<e;d++)for(c=this[d];c&&c!==b;c=c.parentNode)if(11>c.nodeType&&(g?-1<g.index(c):1===c.nodeType&&h.find.matchesSelector(c,a))){f.push(c);break}return this.pushStack(1<f.length?h.unique(f):f)},index:function(a){return a?
"string"===typeof a?aa.call(h(a),this[0]):aa.call(this,a.jquery?a[0]:a):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(a,b){return this.pushStack(h.unique(h.merge(this.get(),h(a,b))))},addBack:function(a){return this.add(null==a?this.prevObject:this.prevObject.filter(a))}});h.each({parent:function(a){return(a=a.parentNode)&&11!==a.nodeType?a:null},parents:function(a){return h.dir(a,"parentNode")},parentsUntil:function(a,b,c){return h.dir(a,"parentNode",c)},next:function(a){return c(a,
"nextSibling")},prev:function(a){return c(a,"previousSibling")},nextAll:function(a){return h.dir(a,"nextSibling")},prevAll:function(a){return h.dir(a,"previousSibling")},nextUntil:function(a,b,c){return h.dir(a,"nextSibling",c)},prevUntil:function(a,b,c){return h.dir(a,"previousSibling",c)},siblings:function(a){return h.sibling((a.parentNode||{}).firstChild,a)},children:function(a){return h.sibling(a.firstChild)},contents:function(a){return a.contentDocument||h.merge([],a.childNodes)}},function(a,
b){h.fn[a]=function(c,d){var e=h.map(this,b,c);"Until"!==a.slice(-5)&&(d=c);d&&"string"===typeof d&&(e=h.filter(d,e));1<this.length&&(Va[a]||h.unique(e),Ua.test(a)&&e.reverse());return this.pushStack(e)}});var ha=/\S+/g,na={};h.Callbacks=function(a){a="string"===typeof a?na[a]||g(a):h.extend({},a);var b,c,d,e,f,k,l=[],m=!a.once&&[],p=function(g){b=a.memory&&g;c=!0;k=e||0;e=0;f=l.length;for(d=!0;l&&k<f;k++)if(!1===l[k].apply(g[0],g[1])&&a.stopOnFalse){b=!1;break}d=!1;l&&(m?m.length&&p(m.shift()):b?
l=[]:n.disable())},n={add:function(){if(l){var c=l.length;(function Fb(b){h.each(b,function(b,c){var d=h.type(c);"function"===d?a.unique&&n.has(c)||l.push(c):c&&c.length&&"string"!==d&&Fb(c)})})(arguments);d?f=l.length:b&&(e=c,p(b))}return this},remove:function(){l&&h.each(arguments,function(a,b){for(var c;-1<(c=h.inArray(b,l,c));)l.splice(c,1),d&&(c<=f&&f--,c<=k&&k--)});return this},has:function(a){return a?-1<h.inArray(a,l):!(!l||!l.length)},empty:function(){l=[];f=0;return this},disable:function(){l=
m=b=void 0;return this},disabled:function(){return!l},lock:function(){m=void 0;b||n.disable();return this},locked:function(){return!m},fireWith:function(a,b){!l||c&&!m||(b=b||[],b=[a,b.slice?b.slice():b],d?m.push(b):p(b));return this},fire:function(){n.fireWith(this,arguments);return this},fired:function(){return!!c}};return n};h.extend({Deferred:function(a){var b=[["resolve","done",h.Callbacks("once memory"),"resolved"],["reject","fail",h.Callbacks("once memory"),"rejected"],["notify","progress",
h.Callbacks("memory")]],c="pending",d={state:function(){return c},always:function(){e.done(arguments).fail(arguments);return this},then:function(){var a=arguments;return h.Deferred(function(c){h.each(b,function(b,f){var B=h.isFunction(a[b])&&a[b];e[f[1]](function(){var a=B&&B.apply(this,arguments);if(a&&h.isFunction(a.promise))a.promise().done(c.resolve).fail(c.reject).progress(c.notify);else c[f[0]+"With"](this===d?c.promise():this,B?[a]:arguments)})});a=null}).promise()},promise:function(a){return null!=
a?h.extend(a,d):d}},e={};d.pipe=d.then;h.each(b,function(a,f){var B=f[2],g=f[3];d[f[1]]=B.add;g&&B.add(function(){c=g},b[a^1][2].disable,b[2][2].lock);e[f[0]]=function(){e[f[0]+"With"](this===e?d:this,arguments);return this};e[f[0]+"With"]=B.fireWith});d.promise(e);a&&a.call(e,e);return e},when:function(a){var b=0,c=Y.call(arguments),d=c.length,e=1!==d||a&&h.isFunction(a.promise)?d:0,f=1===e?a:h.Deferred(),g=function(a,b,c){return function(d){b[a]=this;c[a]=1<arguments.length?Y.call(arguments):d;
c===k?f.notifyWith(b,c):--e||f.resolveWith(b,c)}},k,l,m;if(1<d)for(k=Array(d),l=Array(d),m=Array(d);b<d;b++)c[b]&&h.isFunction(c[b].promise)?c[b].promise().done(g(b,m,c)).fail(f.reject).progress(g(b,l,k)):--e;e||f.resolveWith(m,c);return f.promise()}});var Ba;h.fn.ready=function(a){h.ready.promise().done(a);return this};h.extend({isReady:!1,readyWait:1,holdReady:function(a){a?h.readyWait++:h.ready(!0)},ready:function(a){(!0===a?--h.readyWait:h.isReady)||(h.isReady=!0,!0!==a&&0<--h.readyWait||(Ba.resolveWith(K,
[h]),h.fn.triggerHandler&&(h(K).triggerHandler("ready"),h(K).off("ready"))))}});h.ready.promise=function(a){Ba||(Ba=h.Deferred(),"complete"===K.readyState?setTimeout(h.ready):(K.addEventListener("DOMContentLoaded",f,!1),e.addEventListener("load",f,!1)));return Ba.promise(a)};h.ready.promise();var la=h.access=function(a,b,c,d,e,f,g){var k=0,l=a.length,m=null==c;if("object"===h.type(c))for(k in e=!0,c)h.access(a,b,k,c[k],!0,f,g);else if(void 0!==d&&(e=!0,h.isFunction(d)||(g=!0),m&&(g?(b.call(a,d),b=
null):(m=b,b=function(a,b,c){return m.call(h(a),c)})),b))for(;k<l;k++)b(a[k],c,g?d:d.call(a[k],k,b(a[k],c)));return e?a:m?b.call(a):l?b(a[0],c):f};h.acceptData=function(a){return 1===a.nodeType||9===a.nodeType||!+a.nodeType};k.uid=1;k.accepts=h.acceptData;k.prototype={key:function(a){if(!k.accepts(a))return 0;var b={},c=a[this.expando];if(!c){c=k.uid++;try{b[this.expando]={value:c},Object.defineProperties(a,b)}catch(d){b[this.expando]=c,h.extend(a,b)}}this.cache[c]||(this.cache[c]={});return c},set:function(a,
b,c){var d;a=this.key(a);var e=this.cache[a];if("string"===typeof b)e[b]=c;else if(h.isEmptyObject(e))h.extend(this.cache[a],b);else for(d in b)e[d]=b[d];return e},get:function(a,b){var c=this.cache[this.key(a)];return void 0===b?c:c[b]},access:function(a,b,c){if(void 0===b||b&&"string"===typeof b&&void 0===c)return c=this.get(a,b),void 0!==c?c:this.get(a,h.camelCase(b));this.set(a,b,c);return void 0!==c?c:b},remove:function(a,b){var c,d;c=this.key(a);var e=this.cache[c];if(void 0===b)this.cache[c]=
{};else for(h.isArray(b)?d=b.concat(b.map(h.camelCase)):(c=h.camelCase(b),b in e?d=[b,c]:(d=c,d=d in e?[d]:d.match(ha)||[])),c=d.length;c--;)delete e[d[c]]},hasData:function(a){return!h.isEmptyObject(this.cache[a[this.expando]]||{})},discard:function(a){a[this.expando]&&delete this.cache[a[this.expando]]}};var G=new k,R=new k,Za=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,Ka=/([A-Z])/g;h.extend({hasData:function(a){return R.hasData(a)||G.hasData(a)},data:function(a,b,c){return R.access(a,b,c)},removeData:function(a,
b){R.remove(a,b)},_data:function(a,b,c){return G.access(a,b,c)},_removeData:function(a,b){G.remove(a,b)}});h.fn.extend({data:function(a,b){var c,d,e,f=this[0],g=f&&f.attributes;if(void 0===a){if(this.length&&(e=R.get(f),1===f.nodeType&&!G.get(f,"hasDataAttrs"))){for(c=g.length;c--;)g[c]&&(d=g[c].name,0===d.indexOf("data-")&&(d=h.camelCase(d.slice(5)),l(f,d,e[d])));G.set(f,"hasDataAttrs",!0)}return e}return"object"===typeof a?this.each(function(){R.set(this,a)}):la(this,function(b){var c,d=h.camelCase(a);
if(f&&void 0===b){c=R.get(f,a);if(void 0!==c)return c;c=R.get(f,d);if(void 0!==c)return c;c=l(f,d,void 0);if(void 0!==c)return c}else this.each(function(){var c=R.get(this,d);R.set(this,d,b);-1!==a.indexOf("-")&&void 0!==c&&R.set(this,a,b)})},null,b,1<arguments.length,null,!0)},removeData:function(a){return this.each(function(){R.remove(this,a)})}});h.extend({queue:function(a,b,c){var d;if(a)return b=(b||"fx")+"queue",d=G.get(a,b),c&&(!d||h.isArray(c)?d=G.access(a,b,h.makeArray(c)):d.push(c)),d||
[]},dequeue:function(a,b){b=b||"fx";var c=h.queue(a,b),d=c.length,e=c.shift(),f=h._queueHooks(a,b),g=function(){h.dequeue(a,b)};"inprogress"===e&&(e=c.shift(),d--);e&&("fx"===b&&c.unshift("inprogress"),delete f.stop,e.call(a,g,f));!d&&f&&f.empty.fire()},_queueHooks:function(a,b){var c=b+"queueHooks";return G.get(a,c)||G.access(a,c,{empty:h.Callbacks("once memory").add(function(){G.remove(a,[b+"queue",c])})})}});h.fn.extend({queue:function(a,b){var c=2;"string"!==typeof a&&(b=a,a="fx",c--);return arguments.length<
c?h.queue(this[0],a):void 0===b?this:this.each(function(){var c=h.queue(this,a,b);h._queueHooks(this,a);"fx"===a&&"inprogress"!==c[0]&&h.dequeue(this,a)})},dequeue:function(a){return this.each(function(){h.dequeue(this,a)})},clearQueue:function(a){return this.queue(a||"fx",[])},promise:function(a,b){var c,d=1,e=h.Deferred(),f=this,g=this.length,k=function(){--d||e.resolveWith(f,[f])};"string"!==typeof a&&(b=a,a=void 0);for(a=a||"fx";g--;)(c=G.get(f[g],a+"queueHooks"))&&c.empty&&(d++,c.empty.add(k));
k();return e.promise(b)}});var ta=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,ma=["Top","Right","Bottom","Left"],wa=function(a,b){a=b||a;return"none"===h.css(a,"display")||!h.contains(a.ownerDocument,a)},La=/^(?:checkbox|radio)$/i;(function(){var a=K.createDocumentFragment().appendChild(K.createElement("div")),b=K.createElement("input");b.setAttribute("type","radio");b.setAttribute("checked","checked");b.setAttribute("name","t");a.appendChild(b);L.checkClone=a.cloneNode(!0).cloneNode(!0).lastChild.checked;
a.innerHTML="<textarea>x</textarea>";L.noCloneChecked=!!a.cloneNode(!0).lastChild.defaultValue})();L.focusinBubbles="onfocusin"in e;var Na=/^key/,Oa=/^(?:mouse|pointer|contextmenu)|click/,gb=/^(?:focusinfocus|focusoutblur)$/,hb=/^([^.]*)(?:\.(.+)|)$/;h.event={global:{},add:function(a,b,c,d,e){var f,g,k,l,m,p,n,q,r;if(m=G.get(a))for(c.handler&&(f=c,c=f.handler,e=f.selector),c.guid||(c.guid=h.guid++),(l=m.events)||(l=m.events={}),(g=m.handle)||(g=m.handle=function(b){return"undefined"!==typeof h&&h.event.triggered!==
b.type?h.event.dispatch.apply(a,arguments):void 0}),b=(b||"").match(ha)||[""],m=b.length;m--;)k=hb.exec(b[m])||[],q=p=k[1],r=(k[2]||"").split(".").sort(),q&&(k=h.event.special[q]||{},q=(e?k.delegateType:k.bindType)||q,k=h.event.special[q]||{},p=h.extend({type:q,origType:p,data:d,handler:c,guid:c.guid,selector:e,needsContext:e&&h.expr.match.needsContext.test(e),namespace:r.join(".")},f),(n=l[q])||(n=l[q]=[],n.delegateCount=0,k.setup&&!1!==k.setup.call(a,d,r,g)||a.addEventListener&&a.addEventListener(q,
g,!1)),k.add&&(k.add.call(a,p),p.handler.guid||(p.handler.guid=c.guid)),e?n.splice(n.delegateCount++,0,p):n.push(p),h.event.global[q]=!0)},remove:function(a,b,c,d,e){var f,g,k,l,m,p,n,q,r,t,w,x=G.hasData(a)&&G.get(a);if(x&&(l=x.events)){b=(b||"").match(ha)||[""];for(m=b.length;m--;)if(k=hb.exec(b[m])||[],r=w=k[1],t=(k[2]||"").split(".").sort(),r){n=h.event.special[r]||{};r=(d?n.delegateType:n.bindType)||r;q=l[r]||[];k=k[2]&&new RegExp("(^|\\.)"+t.join("\\.(?:.*\\.|)")+"(\\.|$)");for(g=f=q.length;f--;)p=
q[f],!e&&w!==p.origType||c&&c.guid!==p.guid||k&&!k.test(p.namespace)||d&&d!==p.selector&&("**"!==d||!p.selector)||(q.splice(f,1),p.selector&&q.delegateCount--,n.remove&&n.remove.call(a,p));g&&!q.length&&(n.teardown&&!1!==n.teardown.call(a,t,x.handle)||h.removeEvent(a,r,x.handle),delete l[r])}else for(r in l)h.event.remove(a,r+b[m],c,d,!0);h.isEmptyObject(l)&&(delete x.handle,G.remove(a,"events"))}},trigger:function(a,b,c,d){var f,g,k,l,m,p,n=[c||K],q=va.call(a,"type")?a.type:a;p=va.call(a,"namespace")?
a.namespace.split("."):[];g=f=c=c||K;if(3!==c.nodeType&&8!==c.nodeType&&!gb.test(q+h.event.triggered)&&(0<=q.indexOf(".")&&(p=q.split("."),q=p.shift(),p.sort()),l=0>q.indexOf(":")&&"on"+q,a=a[h.expando]?a:new h.Event(q,"object"===typeof a&&a),a.isTrigger=d?2:3,a.namespace=p.join("."),a.namespace_re=a.namespace?new RegExp("(^|\\.)"+p.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,a.result=void 0,a.target||(a.target=c),b=null==b?[a]:h.makeArray(b,[a]),p=h.event.special[q]||{},d||!p.trigger||!1!==p.trigger.apply(c,
b))){if(!d&&!p.noBubble&&!h.isWindow(c)){k=p.delegateType||q;gb.test(k+q)||(g=g.parentNode);for(;g;g=g.parentNode)n.push(g),f=g;f===(c.ownerDocument||K)&&n.push(f.defaultView||f.parentWindow||e)}for(f=0;(g=n[f++])&&!a.isPropagationStopped();)a.type=1<f?k:p.bindType||q,(m=(G.get(g,"events")||{})[a.type]&&G.get(g,"handle"))&&m.apply(g,b),(m=l&&g[l])&&m.apply&&h.acceptData(g)&&(a.result=m.apply(g,b),!1===a.result&&a.preventDefault());a.type=q;d||a.isDefaultPrevented()||p._default&&!1!==p._default.apply(n.pop(),
b)||!h.acceptData(c)||!l||!h.isFunction(c[q])||h.isWindow(c)||((f=c[l])&&(c[l]=null),h.event.triggered=q,c[q](),h.event.triggered=void 0,f&&(c[l]=f));return a.result}},dispatch:function(a){a=h.event.fix(a);var b,c,d,e,f=[],g=Y.call(arguments);b=(G.get(this,"events")||{})[a.type]||[];var k=h.event.special[a.type]||{};g[0]=a;a.delegateTarget=this;if(!k.preDispatch||!1!==k.preDispatch.call(this,a)){f=h.event.handlers.call(this,a,b);for(b=0;(e=f[b++])&&!a.isPropagationStopped();)for(a.currentTarget=e.elem,
c=0;(d=e.handlers[c++])&&!a.isImmediatePropagationStopped();)if(!a.namespace_re||a.namespace_re.test(d.namespace))a.handleObj=d,a.data=d.data,d=((h.event.special[d.origType]||{}).handle||d.handler).apply(e.elem,g),void 0!==d&&!1===(a.result=d)&&(a.preventDefault(),a.stopPropagation());k.postDispatch&&k.postDispatch.call(this,a);return a.result}},handlers:function(a,b){var c,d,e,f,g=[],k=b.delegateCount,l=a.target;if(k&&l.nodeType&&(!a.button||"click"!==a.type))for(;l!==this;l=l.parentNode||this)if(!0!==
l.disabled||"click"!==a.type){d=[];for(c=0;c<k;c++)f=b[c],e=f.selector+" ",void 0===d[e]&&(d[e]=f.needsContext?0<=h(e,this).index(l):h.find(e,this,null,[l]).length),d[e]&&d.push(f);d.length&&g.push({elem:l,handlers:d})}k<b.length&&g.push({elem:this,handlers:b.slice(k)});return g},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:["char","charCode","key","keyCode"],filter:function(a,b){null==
a.which&&(a.which=null!=b.charCode?b.charCode:b.keyCode);return a}},mouseHooks:{props:"button buttons clientX clientY offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(a,b){var c,d,e=b.button;null==a.pageX&&null!=b.clientX&&(c=a.target.ownerDocument||K,d=c.documentElement,c=c.body,a.pageX=b.clientX+(d&&d.scrollLeft||c&&c.scrollLeft||0)-(d&&d.clientLeft||c&&c.clientLeft||0),a.pageY=b.clientY+(d&&d.scrollTop||c&&c.scrollTop||0)-(d&&d.clientTop||c&&c.clientTop||0));a.which||
void 0===e||(a.which=e&1?1:e&2?3:e&4?2:0);return a}},fix:function(a){if(a[h.expando])return a;var b,c,d;b=a.type;var e=a,f=this.fixHooks[b];f||(this.fixHooks[b]=f=Oa.test(b)?this.mouseHooks:Na.test(b)?this.keyHooks:{});d=f.props?this.props.concat(f.props):this.props;a=new h.Event(e);for(b=d.length;b--;)c=d[b],a[c]=e[c];a.target||(a.target=K);3===a.target.nodeType&&(a.target=a.target.parentNode);return f.filter?f.filter(a,e):a},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==n()&&this.focus)return this.focus(),
!1},delegateType:"focusin"},blur:{trigger:function(){if(this===n()&&this.blur)return this.blur(),!1},delegateType:"focusout"},click:{trigger:function(){if("checkbox"===this.type&&this.click&&h.nodeName(this,"input"))return this.click(),!1},_default:function(a){return h.nodeName(a.target,"a")}},beforeunload:{postDispatch:function(a){void 0!==a.result&&a.originalEvent&&(a.originalEvent.returnValue=a.result)}}},simulate:function(a,b,c,d){a=h.extend(new h.Event,c,{type:a,isSimulated:!0,originalEvent:{}});
d?h.event.trigger(a,null,b):h.event.dispatch.call(b,a);a.isDefaultPrevented()&&c.preventDefault()}};h.removeEvent=function(a,b,c){a.removeEventListener&&a.removeEventListener(b,c,!1)};h.Event=function(a,b){if(!(this instanceof h.Event))return new h.Event(a,b);a&&a.type?(this.originalEvent=a,this.type=a.type,this.isDefaultPrevented=a.defaultPrevented||void 0===a.defaultPrevented&&!1===a.returnValue?m:p):this.type=a;b&&h.extend(this,b);this.timeStamp=a&&a.timeStamp||h.now();this[h.expando]=!0};h.Event.prototype=
{isDefaultPrevented:p,isPropagationStopped:p,isImmediatePropagationStopped:p,preventDefault:function(){var a=this.originalEvent;this.isDefaultPrevented=m;a&&a.preventDefault&&a.preventDefault()},stopPropagation:function(){var a=this.originalEvent;this.isPropagationStopped=m;a&&a.stopPropagation&&a.stopPropagation()},stopImmediatePropagation:function(){var a=this.originalEvent;this.isImmediatePropagationStopped=m;a&&a.stopImmediatePropagation&&a.stopImmediatePropagation();this.stopPropagation()}};
h.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(a,b){h.event.special[a]={delegateType:b,bindType:b,handle:function(a){var c,d=a.relatedTarget,e=a.handleObj;if(!d||d!==this&&!h.contains(this,d))a.type=e.origType,c=e.handler.apply(this,arguments),a.type=b;return c}}});L.focusinBubbles||h.each({focus:"focusin",blur:"focusout"},function(a,b){var c=function(a){h.event.simulate(b,a.target,h.event.fix(a),!0)};h.event.special[b]={setup:function(){var d=
this.ownerDocument||this,e=G.access(d,b);e||d.addEventListener(a,c,!0);G.access(d,b,(e||0)+1)},teardown:function(){var d=this.ownerDocument||this,e=G.access(d,b)-1;e?G.access(d,b,e):(d.removeEventListener(a,c,!0),G.remove(d,b))}}});h.fn.extend({on:function(a,b,c,d,e){var f,g;if("object"===typeof a){"string"!==typeof b&&(c=c||b,b=void 0);for(g in a)this.on(g,b,c,a[g],e);return this}null==c&&null==d?(d=b,c=b=void 0):null==d&&("string"===typeof b?(d=c,c=void 0):(d=c,c=b,b=void 0));if(!1===d)d=p;else if(!d)return this;
1===e&&(f=d,d=function(a){h().off(a);return f.apply(this,arguments)},d.guid=f.guid||(f.guid=h.guid++));return this.each(function(){h.event.add(this,a,d,c,b)})},one:function(a,b,c,d){return this.on(a,b,c,d,1)},off:function(a,b,c){var d;if(a&&a.preventDefault&&a.handleObj)return d=a.handleObj,h(a.delegateTarget).off(d.namespace?d.origType+"."+d.namespace:d.origType,d.selector,d.handler),this;if("object"===typeof a){for(d in a)this.off(d,b,a[d]);return this}if(!1===b||"function"===typeof b)c=b,b=void 0;
!1===c&&(c=p);return this.each(function(){h.event.remove(this,a,c,b)})},trigger:function(a,b){return this.each(function(){h.event.trigger(a,b,this)})},triggerHandler:function(a,b){var c=this[0];if(c)return h.event.trigger(a,b,c,!0)}});var ib=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,jb=/<([\w:]+)/,zb=/<|&#?\w+;/,Ab=/<(?:script|style|link)/i,Bb=/checked\s*(?:[^=]|=\s*.checked.)/i,kb=/^$|\/(?:java|ecma)script/i,Cb=/^true\/(.*)/,Gb=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,
ja={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};ja.optgroup=ja.option;ja.tbody=ja.tfoot=ja.colgroup=ja.caption=ja.thead;ja.th=ja.td;h.extend({clone:function(a,b,c){var d,e,f,g,k=a.cloneNode(!0),l=h.contains(a.ownerDocument,a);if(!(L.noCloneChecked||1!==a.nodeType&&11!==a.nodeType||h.isXMLDoc(a)))for(g=
q(k),f=q(a),d=0,e=f.length;d<e;d++){var m=f[d],p=g[d],n=p.nodeName.toLowerCase();if("input"===n&&La.test(m.type))p.checked=m.checked;else if("input"===n||"textarea"===n)p.defaultValue=m.defaultValue}if(b)if(c)for(f=f||q(a),g=g||q(k),d=0,e=f.length;d<e;d++)z(f[d],g[d]);else z(a,k);g=q(k,"script");0<g.length&&u(g,!l&&q(a,"script"));return k},buildFragment:function(a,b,c,d){for(var e,f,g,k=b.createDocumentFragment(),l=[],m=0,p=a.length;m<p;m++)if((e=a[m])||0===e)if("object"===h.type(e))h.merge(l,e.nodeType?
[e]:e);else if(zb.test(e)){f=f||k.appendChild(b.createElement("div"));g=(jb.exec(e)||["",""])[1].toLowerCase();g=ja[g]||ja._default;f.innerHTML=g[1]+e.replace(ib,"<$1></$2>")+g[2];for(g=g[0];g--;)f=f.lastChild;h.merge(l,f.childNodes);f=k.firstChild;f.textContent=""}else l.push(b.createTextNode(e));k.textContent="";for(m=0;e=l[m++];)if(!d||-1===h.inArray(e,d))if(a=h.contains(e.ownerDocument,e),f=q(k.appendChild(e),"script"),a&&u(f),c)for(g=0;e=f[g++];)kb.test(e.type||"")&&c.push(e);return k},cleanData:function(a){for(var b,
c,d,e,f=h.event.special,g=0;void 0!==(c=a[g]);g++){if(h.acceptData(c)&&(e=c[G.expando])&&(b=G.cache[e])){if(b.events)for(d in b.events)f[d]?h.event.remove(c,d):h.removeEvent(c,d,b.handle);G.cache[e]&&delete G.cache[e]}delete R.cache[c[R.expando]]}}});h.fn.extend({text:function(a){return la(this,function(a){return void 0===a?h.text(this):this.empty().each(function(){if(1===this.nodeType||11===this.nodeType||9===this.nodeType)this.textContent=a})},null,a,arguments.length)},append:function(){return this.domManip(arguments,
function(a){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||x(this,a).appendChild(a)})},prepend:function(){return this.domManip(arguments,function(a){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var b=x(this,a);b.insertBefore(a,b.firstChild)}})},before:function(){return this.domManip(arguments,function(a){this.parentNode&&this.parentNode.insertBefore(a,this)})},after:function(){return this.domManip(arguments,function(a){this.parentNode&&this.parentNode.insertBefore(a,this.nextSibling)})},
remove:function(a,b){for(var c,d=a?h.filter(a,this):this,e=0;null!=(c=d[e]);e++)b||1!==c.nodeType||h.cleanData(q(c)),c.parentNode&&(b&&h.contains(c.ownerDocument,c)&&u(q(c,"script")),c.parentNode.removeChild(c));return this},empty:function(){for(var a,b=0;null!=(a=this[b]);b++)1===a.nodeType&&(h.cleanData(q(a,!1)),a.textContent="");return this},clone:function(a,b){a=null==a?!1:a;b=null==b?a:b;return this.map(function(){return h.clone(this,a,b)})},html:function(a){return la(this,function(a){var b=
this[0]||{},c=0,d=this.length;if(void 0===a&&1===b.nodeType)return b.innerHTML;if("string"===typeof a&&!Ab.test(a)&&!ja[(jb.exec(a)||["",""])[1].toLowerCase()]){a=a.replace(ib,"<$1></$2>");try{for(;c<d;c++)b=this[c]||{},1===b.nodeType&&(h.cleanData(q(b,!1)),b.innerHTML=a);b=0}catch(e){}}b&&this.empty().append(a)},null,a,arguments.length)},replaceWith:function(){var a=arguments[0];this.domManip(arguments,function(b){a=this.parentNode;h.cleanData(q(this));a&&a.replaceChild(b,this)});return a&&(a.length||
a.nodeType)?this:this.remove()},detach:function(a){return this.remove(a,!0)},domManip:function(a,b){a=S.apply([],a);var c,d,e,f,g=0,k=this.length,l=this,m=k-1,p=a[0],n=h.isFunction(p);if(n||1<k&&"string"===typeof p&&!L.checkClone&&Bb.test(p))return this.each(function(c){var d=l.eq(c);n&&(a[0]=p.call(this,c,d.html()));d.domManip(a,b)});if(k&&(c=h.buildFragment(a,this[0].ownerDocument,!1,this),d=c.firstChild,1===c.childNodes.length&&(c=d),d)){d=h.map(q(c,"script"),y);for(e=d.length;g<k;g++)f=c,g!==
m&&(f=h.clone(f,!0,!0),e&&h.merge(d,q(f,"script"))),b.call(this[g],f,g);if(e)for(c=d[d.length-1].ownerDocument,h.map(d,E),g=0;g<e;g++)f=d[g],kb.test(f.type||"")&&!G.access(f,"globalEval")&&h.contains(c,f)&&(f.src?h._evalUrl&&h._evalUrl(f.src):h.globalEval(f.textContent.replace(Gb,"")))}return this}});h.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(a,b){h.fn[a]=function(a){for(var c=[],d=h(a),e=d.length-1,f=0;f<=e;f++)a=f===
e?this:this.clone(!0),h(d[f])[b](a),V.apply(c,a.get());return this.pushStack(c)}});var Pa,lb={},mb=/^margin/,$a=new RegExp("^("+ta+")(?!px)[a-z%]+$","i"),Qa=function(a){return a.ownerDocument.defaultView.opener?a.ownerDocument.defaultView.getComputedStyle(a,null):e.getComputedStyle(a,null)};(function(){function a(){g.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;display:block;margin-top:1%;top:1%;border:1px;padding:1px;width:4px;position:absolute";g.innerHTML=
"";d.appendChild(f);var h=e.getComputedStyle(g,null);b="1%"!==h.top;c="4px"===h.width;d.removeChild(f)}var b,c,d=K.documentElement,f=K.createElement("div"),g=K.createElement("div");g.style&&(g.style.backgroundClip="content-box",g.cloneNode(!0).style.backgroundClip="",L.clearCloneStyle="content-box"===g.style.backgroundClip,f.style.cssText="border:0;width:0;height:0;top:0;left:-9999px;margin-top:1px;position:absolute",f.appendChild(g),e.getComputedStyle&&h.extend(L,{pixelPosition:function(){a();return b},
boxSizingReliable:function(){null==c&&a();return c},reliableMarginRight:function(){var a,b=g.appendChild(K.createElement("div"));b.style.cssText=g.style.cssText="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:0";b.style.marginRight=b.style.width="0";g.style.width="1px";d.appendChild(f);a=!parseFloat(e.getComputedStyle(b,null).marginRight);d.removeChild(f);g.removeChild(b);return a}}))})();h.swap=function(a,b,c,d){var e,f={};
for(e in b)f[e]=a.style[e],a.style[e]=b[e];c=c.apply(a,d||[]);for(e in b)a.style[e]=f[e];return c};var Hb=/^(none|table(?!-c[ea]).+)/,Db=new RegExp("^("+ta+")(.*)$","i"),Ib=new RegExp("^([+-])=("+ta+")","i"),Jb={position:"absolute",visibility:"hidden",display:"block"},ob={letterSpacing:"0",fontWeight:"400"},nb=["Webkit","O","Moz","ms"];h.extend({cssHooks:{opacity:{get:function(a,b){if(b){var c=v(a,"opacity");return""===c?"1":c}}}},cssNumber:{columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,
fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":"cssFloat"},style:function(a,b,c,d){if(a&&3!==a.nodeType&&8!==a.nodeType&&a.style){var e,f,g,k=h.camelCase(b),l=a.style;b=h.cssProps[k]||(h.cssProps[k]=D(l,k));g=h.cssHooks[b]||h.cssHooks[k];if(void 0!==c)f=typeof c,"string"===f&&(e=Ib.exec(c))&&(c=(e[1]+1)*e[2]+parseFloat(h.css(a,b)),f="number"),null!=c&&c===c&&("number"!==f||h.cssNumber[k]||(c+="px"),L.clearCloneStyle||""!==c||0!==b.indexOf("background")||
(l[b]="inherit"),g&&"set"in g&&void 0===(c=g.set(a,c,d))||(l[b]=c));else return g&&"get"in g&&void 0!==(e=g.get(a,!1,d))?e:l[b]}},css:function(a,b,c,d){var e,f;f=h.camelCase(b);b=h.cssProps[f]||(h.cssProps[f]=D(a.style,f));(f=h.cssHooks[b]||h.cssHooks[f])&&"get"in f&&(e=f.get(a,!0,c));void 0===e&&(e=v(a,b,d));"normal"===e&&b in ob&&(e=ob[b]);return""===c||c?(a=parseFloat(e),!0===c||h.isNumeric(a)?a||0:e):e}});h.each(["height","width"],function(a,b){h.cssHooks[b]={get:function(a,c,d){if(c)return Hb.test(h.css(a,
"display"))&&0===a.offsetWidth?h.swap(a,Jb,function(){return H(a,b,d)}):H(a,b,d)},set:function(a,c,d){var e=d&&Qa(a);return A(a,c,d?C(a,b,d,"border-box"===h.css(a,"boxSizing",!1,e),e):0)}}});h.cssHooks.marginRight=w(L.reliableMarginRight,function(a,b){if(b)return h.swap(a,{display:"inline-block"},v,[a,"marginRight"])});h.each({margin:"",padding:"",border:"Width"},function(a,b){h.cssHooks[a+b]={expand:function(c){var d=0,e={};for(c="string"===typeof c?c.split(" "):[c];4>d;d++)e[a+ma[d]+b]=c[d]||c[d-
2]||c[0];return e}};mb.test(a)||(h.cssHooks[a+b].set=A)});h.fn.extend({css:function(a,b){return la(this,function(a,b,c){var d,e={},f=0;if(h.isArray(b)){c=Qa(a);for(d=b.length;f<d;f++)e[b[f]]=h.css(a,b[f],!1,c);return e}return void 0!==c?h.style(a,b,c):h.css(a,b)},a,b,1<arguments.length)},show:function(){return F(this,!0)},hide:function(){return F(this)},toggle:function(a){return"boolean"===typeof a?a?this.show():this.hide():this.each(function(){wa(this)?h(this).show():h(this).hide()})}});h.Tween=
I;I.prototype={constructor:I,init:function(a,b,c,d,e,f){this.elem=a;this.prop=c;this.easing=e||"swing";this.options=b;this.start=this.now=this.cur();this.end=d;this.unit=f||(h.cssNumber[c]?"":"px")},cur:function(){var a=I.propHooks[this.prop];return a&&a.get?a.get(this):I.propHooks._default.get(this)},run:function(a){var b,c=I.propHooks[this.prop];this.pos=this.options.duration?b=h.easing[this.easing](a,this.options.duration*a,0,1,this.options.duration):b=a;this.now=(this.end-this.start)*b+this.start;
this.options.step&&this.options.step.call(this.elem,this.now,this);c&&c.set?c.set(this):I.propHooks._default.set(this);return this}};I.prototype.init.prototype=I.prototype;I.propHooks={_default:{get:function(a){return null==a.elem[a.prop]||a.elem.style&&null!=a.elem.style[a.prop]?(a=h.css(a.elem,a.prop,""))&&"auto"!==a?a:0:a.elem[a.prop]},set:function(a){if(h.fx.step[a.prop])h.fx.step[a.prop](a);else a.elem.style&&(null!=a.elem.style[h.cssProps[a.prop]]||h.cssHooks[a.prop])?h.style(a.elem,a.prop,
a.now+a.unit):a.elem[a.prop]=a.now}}};I.propHooks.scrollTop=I.propHooks.scrollLeft={set:function(a){a.elem.nodeType&&a.elem.parentNode&&(a.elem[a.prop]=a.now)}};h.easing={linear:function(a){return a},swing:function(a){return.5-Math.cos(a*Math.PI)/2}};h.fx=I.prototype.init;h.fx.step={};var Ca,Sa,Kb=/^(?:toggle|show|hide)$/,pb=new RegExp("^(?:([+-])=|)("+ta+")([a-z%]*)$","i"),Lb=/queueHooks$/,Ra=[function(a,b,c){var d,e,f,g,k,l,m=this,p={},n=a.style,q=a.nodeType&&wa(a),t=G.get(a,"fxshow");c.queue||
(g=h._queueHooks(a,"fx"),null==g.unqueued&&(g.unqueued=0,k=g.empty.fire,g.empty.fire=function(){g.unqueued||k()}),g.unqueued++,m.always(function(){m.always(function(){g.unqueued--;h.queue(a,"fx").length||g.empty.fire()})}));1===a.nodeType&&("height"in b||"width"in b)&&(c.overflow=[n.overflow,n.overflowX,n.overflowY],l=h.css(a,"display"),e="none"===l?G.get(a,"olddisplay")||r(a.nodeName):l,"inline"===e&&"none"===h.css(a,"float")&&(n.display="inline-block"));c.overflow&&(n.overflow="hidden",m.always(function(){n.overflow=
c.overflow[0];n.overflowX=c.overflow[1];n.overflowY=c.overflow[2]}));for(d in b)if(e=b[d],Kb.exec(e)){delete b[d];f=f||"toggle"===e;if(e===(q?"hide":"show"))if("show"===e&&t&&void 0!==t[d])q=!0;else continue;p[d]=t&&t[d]||h.style(a,d)}else l=void 0;if(h.isEmptyObject(p))"inline"===("none"===l?r(a.nodeName):l)&&(n.display=l);else for(d in t?"hidden"in t&&(q=t.hidden):t=G.access(a,"fxshow",{}),f&&(t.hidden=!q),q?h(a).show():m.done(function(){h(a).hide()}),m.done(function(){var b;G.remove(a,"fxshow");
for(b in p)h.style(a,b,p[b])}),p)b=Z(q?t[d]:0,d,m),d in t||(t[d]=b.start,q&&(b.end=b.start,b.start="width"===d||"height"===d?1:0))}],Fa={"*":[function(a,b){var c=this.createTween(a,b),d=c.cur(),e=pb.exec(b),f=e&&e[3]||(h.cssNumber[a]?"":"px"),g=(h.cssNumber[a]||"px"!==f&&+d)&&pb.exec(h.css(c.elem,a)),k=1,l=20;if(g&&g[3]!==f){f=f||g[3];e=e||[];g=+d||1;do k=k||".5",g/=k,h.style(c.elem,a,g+f);while(k!==(k=c.cur()/d)&&1!==k&&--l)}e&&(g=c.start=+g||+d||0,c.unit=f,c.end=e[1]?g+(e[1]+1)*e[2]:+e[2]);return c}]};
h.Animation=h.extend(U,{tweener:function(a,b){h.isFunction(a)?(b=a,a=["*"]):a=a.split(" ");for(var c,d=0,e=a.length;d<e;d++)c=a[d],Fa[c]=Fa[c]||[],Fa[c].unshift(b)},prefilter:function(a,b){b?Ra.unshift(a):Ra.push(a)}});h.speed=function(a,b,c){var d=a&&"object"===typeof a?h.extend({},a):{complete:c||!c&&b||h.isFunction(a)&&a,duration:a,easing:c&&b||b&&!h.isFunction(b)&&b};d.duration=h.fx.off?0:"number"===typeof d.duration?d.duration:d.duration in h.fx.speeds?h.fx.speeds[d.duration]:h.fx.speeds._default;
if(null==d.queue||!0===d.queue)d.queue="fx";d.old=d.complete;d.complete=function(){h.isFunction(d.old)&&d.old.call(this);d.queue&&h.dequeue(this,d.queue)};return d};h.fn.extend({fadeTo:function(a,b,c,d){return this.filter(wa).css("opacity",0).show().end().animate({opacity:b},a,c,d)},animate:function(a,b,c,d){var e=h.isEmptyObject(a),f=h.speed(b,c,d);b=function(){var b=U(this,h.extend({},a),f);(e||G.get(this,"finish"))&&b.stop(!0)};b.finish=b;return e||!1===f.queue?this.each(b):this.queue(f.queue,
b)},stop:function(a,b,c){var d=function(a){var b=a.stop;delete a.stop;b(c)};"string"!==typeof a&&(c=b,b=a,a=void 0);b&&!1!==a&&this.queue(a||"fx",[]);return this.each(function(){var b=!0,e=null!=a&&a+"queueHooks",f=h.timers,g=G.get(this);if(e)g[e]&&g[e].stop&&d(g[e]);else for(e in g)g[e]&&g[e].stop&&Lb.test(e)&&d(g[e]);for(e=f.length;e--;)f[e].elem!==this||null!=a&&f[e].queue!==a||(f[e].anim.stop(c),b=!1,f.splice(e,1));!b&&c||h.dequeue(this,a)})},finish:function(a){!1!==a&&(a=a||"fx");return this.each(function(){var b,
c=G.get(this),d=c[a+"queue"];b=c[a+"queueHooks"];var e=h.timers,f=d?d.length:0;c.finish=!0;h.queue(this,a,[]);b&&b.stop&&b.stop.call(this,!0);for(b=e.length;b--;)e[b].elem===this&&e[b].queue===a&&(e[b].anim.stop(!0),e.splice(b,1));for(b=0;b<f;b++)d[b]&&d[b].finish&&d[b].finish.call(this);delete c.finish})}});h.each(["toggle","show","hide"],function(a,b){var c=h.fn[b];h.fn[b]=function(a,d,e){return null==a||"boolean"===typeof a?c.apply(this,arguments):this.animate(P(b,!0),a,d,e)}});h.each({slideDown:P("show"),
slideUp:P("hide"),slideToggle:P("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(a,b){h.fn[a]=function(a,c,d){return this.animate(b,a,c,d)}});h.timers=[];h.fx.tick=function(){var a,b=0,c=h.timers;for(Ca=h.now();b<c.length;b++)a=c[b],a()||c[b]!==a||c.splice(b--,1);c.length||h.fx.stop();Ca=void 0};h.fx.timer=function(a){h.timers.push(a);a()?h.fx.start():h.timers.pop()};h.fx.interval=13;h.fx.start=function(){Sa||(Sa=setInterval(h.fx.tick,h.fx.interval))};
h.fx.stop=function(){clearInterval(Sa);Sa=null};h.fx.speeds={slow:600,fast:200,_default:400};h.fn.delay=function(a,b){a=h.fx?h.fx.speeds[a]||a:a;return this.queue(b||"fx",function(b,c){var d=setTimeout(b,a);c.stop=function(){clearTimeout(d)}})};(function(){var a=K.createElement("input"),b=K.createElement("select"),c=b.appendChild(K.createElement("option"));a.type="checkbox";L.checkOn=""!==a.value;L.optSelected=c.selected;b.disabled=!0;L.optDisabled=!c.disabled;a=K.createElement("input");a.value="t";
a.type="radio";L.radioValue="t"===a.value})();var qb,Da=h.expr.attrHandle;h.fn.extend({attr:function(a,b){return la(this,h.attr,a,b,1<arguments.length)},removeAttr:function(a){return this.each(function(){h.removeAttr(this,a)})}});h.extend({attr:function(a,b,c){var d,e,f=a.nodeType;if(a&&3!==f&&8!==f&&2!==f){if("undefined"===typeof a.getAttribute)return h.prop(a,b,c);1===f&&h.isXMLDoc(a)||(b=b.toLowerCase(),d=h.attrHooks[b]||(h.expr.match.bool.test(b)?qb:void 0));if(void 0!==c)if(null===c)h.removeAttr(a,
b);else{if(d&&"set"in d&&void 0!==(e=d.set(a,c,b)))return e;a.setAttribute(b,c+"");return c}else{if(d&&"get"in d&&null!==(e=d.get(a,b)))return e;e=h.find.attr(a,b);return null==e?void 0:e}}},removeAttr:function(a,b){var c,d,e=0,f=b&&b.match(ha);if(f&&1===a.nodeType)for(;c=f[e++];)d=h.propFix[c]||c,h.expr.match.bool.test(c)&&(a[d]=!1),a.removeAttribute(c)},attrHooks:{type:{set:function(a,b){if(!L.radioValue&&"radio"===b&&h.nodeName(a,"input")){var c=a.value;a.setAttribute("type",b);c&&(a.value=c);
return b}}}}});qb={set:function(a,b,c){!1===b?h.removeAttr(a,c):a.setAttribute(c,c);return c}};h.each(h.expr.match.bool.source.match(/\w+/g),function(a,b){var c=Da[b]||h.find.attr;Da[b]=function(a,b,d){var e,f;d||(f=Da[b],Da[b]=e,e=null!=c(a,b,d)?b.toLowerCase():null,Da[b]=f);return e}});var Mb=/^(?:input|select|textarea|button)$/i;h.fn.extend({prop:function(a,b){return la(this,h.prop,a,b,1<arguments.length)},removeProp:function(a){return this.each(function(){delete this[h.propFix[a]||a]})}});h.extend({propFix:{"for":"htmlFor",
"class":"className"},prop:function(a,b,c){var d,e,f;f=a.nodeType;if(a&&3!==f&&8!==f&&2!==f){if(f=1!==f||!h.isXMLDoc(a))b=h.propFix[b]||b,e=h.propHooks[b];return void 0!==c?e&&"set"in e&&void 0!==(d=e.set(a,c,b))?d:a[b]=c:e&&"get"in e&&null!==(d=e.get(a,b))?d:a[b]}},propHooks:{tabIndex:{get:function(a){return a.hasAttribute("tabindex")||Mb.test(a.nodeName)||a.href?a.tabIndex:-1}}}});L.optSelected||(h.propHooks.selected={get:function(a){(a=a.parentNode)&&a.parentNode&&a.parentNode.selectedIndex;return null}});
h.each("tabIndex readOnly maxLength cellSpacing cellPadding rowSpan colSpan useMap frameBorder contentEditable".split(" "),function(){h.propFix[this.toLowerCase()]=this});var bb=/[\t\r\n\f]/g;h.fn.extend({addClass:function(a){var b,c,d,e,f;b="string"===typeof a&&a;var g=0,k=this.length;if(h.isFunction(a))return this.each(function(b){h(this).addClass(a.call(this,b,this.className))});if(b)for(b=(a||"").match(ha)||[];g<k;g++)if(c=this[g],d=1===c.nodeType&&(c.className?(" "+c.className+" ").replace(bb,
" "):" ")){for(f=0;e=b[f++];)0>d.indexOf(" "+e+" ")&&(d+=e+" ");d=h.trim(d);c.className!==d&&(c.className=d)}return this},removeClass:function(a){var b,c,d,e,f;b=0===arguments.length||"string"===typeof a&&a;var g=0,k=this.length;if(h.isFunction(a))return this.each(function(b){h(this).removeClass(a.call(this,b,this.className))});if(b)for(b=(a||"").match(ha)||[];g<k;g++)if(c=this[g],d=1===c.nodeType&&(c.className?(" "+c.className+" ").replace(bb," "):"")){for(f=0;e=b[f++];)for(;0<=d.indexOf(" "+e+" ");)d=
d.replace(" "+e+" "," ");d=a?h.trim(d):"";c.className!==d&&(c.className=d)}return this},toggleClass:function(a,b){var c=typeof a;return"boolean"===typeof b&&"string"===c?b?this.addClass(a):this.removeClass(a):h.isFunction(a)?this.each(function(c){h(this).toggleClass(a.call(this,c,this.className,b),b)}):this.each(function(){if("string"===c)for(var b,d=0,e=h(this),f=a.match(ha)||[];b=f[d++];)e.hasClass(b)?e.removeClass(b):e.addClass(b);else if("undefined"===c||"boolean"===c)this.className&&G.set(this,
"__className__",this.className),this.className=this.className||!1===a?"":G.get(this,"__className__")||""})},hasClass:function(a){a=" "+a+" ";for(var b=0,c=this.length;b<c;b++)if(1===this[b].nodeType&&0<=(" "+this[b].className+" ").replace(bb," ").indexOf(a))return!0;return!1}});var Nb=/\r/g;h.fn.extend({val:function(a){var b,c,d,e=this[0];if(arguments.length)return d=h.isFunction(a),this.each(function(c){1===this.nodeType&&(c=d?a.call(this,c,h(this).val()):a,null==c?c="":"number"===typeof c?c+="":
h.isArray(c)&&(c=h.map(c,function(a){return null==a?"":a+""})),b=h.valHooks[this.type]||h.valHooks[this.nodeName.toLowerCase()],b&&"set"in b&&void 0!==b.set(this,c,"value")||(this.value=c))});if(e){if((b=h.valHooks[e.type]||h.valHooks[e.nodeName.toLowerCase()])&&"get"in b&&void 0!==(c=b.get(e,"value")))return c;c=e.value;return"string"===typeof c?c.replace(Nb,""):null==c?"":c}}});h.extend({valHooks:{option:{get:function(a){var b=h.find.attr(a,"value");return null!=b?b:h.trim(h.text(a))}},select:{get:function(a){for(var b,
c=a.options,d=a.selectedIndex,e=(a="select-one"===a.type||0>d)?null:[],f=a?d+1:c.length,g=0>d?f:a?d:0;g<f;g++)if(b=c[g],!(!b.selected&&g!==d||(L.optDisabled?b.disabled:null!==b.getAttribute("disabled"))||b.parentNode.disabled&&h.nodeName(b.parentNode,"optgroup"))){b=h(b).val();if(a)return b;e.push(b)}return e},set:function(a,b){for(var c,d,e=a.options,f=h.makeArray(b),g=e.length;g--;)if(d=e[g],d.selected=0<=h.inArray(d.value,f))c=!0;c||(a.selectedIndex=-1);return f}}}});h.each(["radio","checkbox"],
function(){h.valHooks[this]={set:function(a,b){if(h.isArray(b))return a.checked=0<=h.inArray(h(a).val(),b)}};L.checkOn||(h.valHooks[this].get=function(a){return null===a.getAttribute("value")?"on":a.value})});h.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(a,b){h.fn[b]=function(a,c){return 0<arguments.length?this.on(b,
null,a,c):this.trigger(b)}});h.fn.extend({hover:function(a,b){return this.mouseenter(a).mouseleave(b||a)},bind:function(a,b,c){return this.on(a,null,b,c)},unbind:function(a,b){return this.off(a,null,b)},delegate:function(a,b,c,d){return this.on(b,a,c,d)},undelegate:function(a,b,c){return 1===arguments.length?this.off(a,"**"):this.off(b,a||"**",c)}});var cb=h.now(),db=/\?/;h.parseJSON=function(a){return JSON.parse(a+"")};h.parseXML=function(a){var b,c;if(!a||"string"!==typeof a)return null;try{c=new DOMParser,
b=c.parseFromString(a,"text/xml")}catch(d){b=void 0}b&&!b.getElementsByTagName("parsererror").length||h.error("Invalid XML: "+a);return b};var Ob=/#.*$/,rb=/([?&])_=[^&]*/,Pb=/^(.*?):[ \t]*([^\r\n]*)$/mg,Qb=/^(?:GET|HEAD)$/,Rb=/^\/\//,sb=/^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/,tb={},ab={},ub="*/".concat("*"),eb=e.location.href,oa=sb.exec(eb.toLowerCase())||[];h.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:eb,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(oa[1]),
global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":ub,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":h.parseJSON,"text xml":h.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(a,b){return b?X(X(a,
h.ajaxSettings),b):X(h.ajaxSettings,a)},ajaxPrefilter:za(tb),ajaxTransport:za(ab),ajax:function(a,b){function c(a,b,g,l){var B,p,u,v;v=b;if(2!==y){y=2;k&&clearTimeout(k);d=void 0;f=l||"";A.readyState=0<a?4:0;l=200<=a&&300>a||304===a;if(g){u=n;for(var M=A,J,z,D,C,E=u.contents,F=u.dataTypes;"*"===F[0];)F.shift(),void 0===J&&(J=u.mimeType||M.getResponseHeader("Content-Type"));if(J)for(z in E)if(E[z]&&E[z].test(J)){F.unshift(z);break}if(F[0]in g)D=F[0];else{for(z in g){if(!F[0]||u.converters[z+" "+F[0]]){D=
z;break}C||(C=z)}D=D||C}D?(D!==F[0]&&F.unshift(D),u=g[D]):u=void 0}a:{g=n;J=u;z=A;D=l;var O,G,H,M={},E=g.dataTypes.slice();if(E[1])for(G in g.converters)M[G.toLowerCase()]=g.converters[G];for(C=E.shift();C;)if(g.responseFields[C]&&(z[g.responseFields[C]]=J),!H&&D&&g.dataFilter&&(J=g.dataFilter(J,g.dataType)),H=C,C=E.shift())if("*"===C)C=H;else if("*"!==H&&H!==C){G=M[H+" "+C]||M["* "+C];if(!G)for(O in M)if(u=O.split(" "),u[1]===C&&(G=M[H+" "+u[0]]||M["* "+u[0]])){!0===G?G=M[O]:!0!==M[O]&&(C=u[0],E.unshift(u[1]));
break}if(!0!==G)if(G&&g["throws"])J=G(J);else try{J=G(J)}catch(I){u={state:"parsererror",error:G?I:"No conversion from "+H+" to "+C};break a}}u={state:"success",data:J}}if(l)n.ifModified&&((v=A.getResponseHeader("Last-Modified"))&&(h.lastModified[e]=v),(v=A.getResponseHeader("etag"))&&(h.etag[e]=v)),204===a||"HEAD"===n.type?v="nocontent":304===a?v="notmodified":(v=u.state,B=u.data,p=u.error,l=!p);else if(p=v,a||!v)v="error",0>a&&(a=0);A.status=a;A.statusText=(b||v)+"";l?t.resolveWith(q,[B,v,A]):t.rejectWith(q,
[A,v,p]);A.statusCode(w);w=void 0;m&&r.trigger(l?"ajaxSuccess":"ajaxError",[A,n,l?B:p]);x.fireWith(q,[A,v]);m&&(r.trigger("ajaxComplete",[A,n]),--h.active||h.event.trigger("ajaxStop"))}}"object"===typeof a&&(b=a,a=void 0);b=b||{};var d,e,f,g,k,l,m,p,n=h.ajaxSetup({},b),q=n.context||n,r=n.context&&(q.nodeType||q.jquery)?h(q):h.event,t=h.Deferred(),x=h.Callbacks("once memory"),w=n.statusCode||{},u={},v={},y=0,z="canceled",A={readyState:0,getResponseHeader:function(a){var b;if(2===y){if(!g)for(g={};b=
Pb.exec(f);)g[b[1].toLowerCase()]=b[2];b=g[a.toLowerCase()]}return null==b?null:b},getAllResponseHeaders:function(){return 2===y?f:null},setRequestHeader:function(a,b){var c=a.toLowerCase();y||(a=v[c]=v[c]||a,u[a]=b);return this},overrideMimeType:function(a){y||(n.mimeType=a);return this},statusCode:function(a){var b;if(a)if(2>y)for(b in a)w[b]=[w[b],a[b]];else A.always(a[A.status]);return this},abort:function(a){a=a||z;d&&d.abort(a);c(0,a);return this}};t.promise(A).complete=x.add;A.success=A.done;
A.error=A.fail;n.url=((a||n.url||eb)+"").replace(Ob,"").replace(Rb,oa[1]+"//");n.type=b.method||b.type||n.method||n.type;n.dataTypes=h.trim(n.dataType||"*").toLowerCase().match(ha)||[""];null==n.crossDomain&&(l=sb.exec(n.url.toLowerCase()),n.crossDomain=!(!l||l[1]===oa[1]&&l[2]===oa[2]&&(l[3]||("http:"===l[1]?"80":"443"))===(oa[3]||("http:"===oa[1]?"80":"443"))));n.data&&n.processData&&"string"!==typeof n.data&&(n.data=h.param(n.data,n.traditional));ka(tb,n,b,A);if(2===y)return A;(m=h.event&&n.global)&&
0===h.active++&&h.event.trigger("ajaxStart");n.type=n.type.toUpperCase();n.hasContent=!Qb.test(n.type);e=n.url;n.hasContent||(n.data&&(e=n.url+=(db.test(e)?"&":"?")+n.data,delete n.data),!1===n.cache&&(n.url=rb.test(e)?e.replace(rb,"$1_="+cb++):e+(db.test(e)?"&":"?")+"_="+cb++));n.ifModified&&(h.lastModified[e]&&A.setRequestHeader("If-Modified-Since",h.lastModified[e]),h.etag[e]&&A.setRequestHeader("If-None-Match",h.etag[e]));(n.data&&n.hasContent&&!1!==n.contentType||b.contentType)&&A.setRequestHeader("Content-Type",
n.contentType);A.setRequestHeader("Accept",n.dataTypes[0]&&n.accepts[n.dataTypes[0]]?n.accepts[n.dataTypes[0]]+("*"!==n.dataTypes[0]?", "+ub+"; q=0.01":""):n.accepts["*"]);for(p in n.headers)A.setRequestHeader(p,n.headers[p]);if(n.beforeSend&&(!1===n.beforeSend.call(q,A,n)||2===y))return A.abort();z="abort";for(p in{success:1,error:1,complete:1})A[p](n[p]);if(d=ka(ab,n,b,A)){A.readyState=1;m&&r.trigger("ajaxSend",[A,n]);n.async&&0<n.timeout&&(k=setTimeout(function(){A.abort("timeout")},n.timeout));
try{y=1,d.send(u,c)}catch(D){if(2>y)c(-1,D);else throw D;}}else c(-1,"No Transport");return A},getJSON:function(a,b,c){return h.get(a,b,c,"json")},getScript:function(a,b){return h.get(a,void 0,b,"script")}});h.each(["get","post"],function(a,b){h[b]=function(a,c,d,e){h.isFunction(c)&&(e=e||d,d=c,c=void 0);return h.ajax({url:a,type:b,dataType:e,data:c,success:d})}});h._evalUrl=function(a){return h.ajax({url:a,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0})};h.fn.extend({wrapAll:function(a){var b;
if(h.isFunction(a))return this.each(function(b){h(this).wrapAll(a.call(this,b))});this[0]&&(b=h(a,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&b.insertBefore(this[0]),b.map(function(){for(var a=this;a.firstElementChild;)a=a.firstElementChild;return a}).append(this));return this},wrapInner:function(a){return h.isFunction(a)?this.each(function(b){h(this).wrapInner(a.call(this,b))}):this.each(function(){var b=h(this),c=b.contents();c.length?c.wrapAll(a):b.append(a)})},wrap:function(a){var b=
h.isFunction(a);return this.each(function(c){h(this).wrapAll(b?a.call(this,c):a)})},unwrap:function(){return this.parent().each(function(){h.nodeName(this,"body")||h(this).replaceWith(this.childNodes)}).end()}});h.expr.filters.hidden=function(a){return 0>=a.offsetWidth&&0>=a.offsetHeight};h.expr.filters.visible=function(a){return!h.expr.filters.hidden(a)};var Sb=/%20/g,Eb=/\[\]$/,vb=/\r?\n/g,Tb=/^(?:submit|button|image|reset|file)$/i,Ub=/^(?:input|select|textarea|keygen)/i;h.param=function(a,b){var c,
d=[],e=function(a,b){b=h.isFunction(b)?b():null==b?"":b;d[d.length]=encodeURIComponent(a)+"="+encodeURIComponent(b)};void 0===b&&(b=h.ajaxSettings&&h.ajaxSettings.traditional);if(h.isArray(a)||a.jquery&&!h.isPlainObject(a))h.each(a,function(){e(this.name,this.value)});else for(c in a)Ea(c,a[c],b,e);return d.join("&").replace(Sb,"+")};h.fn.extend({serialize:function(){return h.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var a=h.prop(this,"elements");return a?
h.makeArray(a):this}).filter(function(){var a=this.type;return this.name&&!h(this).is(":disabled")&&Ub.test(this.nodeName)&&!Tb.test(a)&&(this.checked||!La.test(a))}).map(function(a,b){var c=h(this).val();return null==c?null:h.isArray(c)?h.map(c,function(a){return{name:b.name,value:a.replace(vb,"\r\n")}}):{name:b.name,value:c.replace(vb,"\r\n")}}).get()}});h.ajaxSettings.xhr=function(){try{return new XMLHttpRequest}catch(a){}};var Vb=0,Ta={},Wb={0:200,1223:204},Ha=h.ajaxSettings.xhr();e.attachEvent&&
e.attachEvent("onunload",function(){for(var a in Ta)Ta[a]()});L.cors=!!Ha&&"withCredentials"in Ha;L.ajax=Ha=!!Ha;h.ajaxTransport(function(a){var b;if(L.cors||Ha&&!a.crossDomain)return{send:function(c,d){var e,f=a.xhr(),g=++Vb;f.open(a.type,a.url,a.async,a.username,a.password);if(a.xhrFields)for(e in a.xhrFields)f[e]=a.xhrFields[e];a.mimeType&&f.overrideMimeType&&f.overrideMimeType(a.mimeType);a.crossDomain||c["X-Requested-With"]||(c["X-Requested-With"]="XMLHttpRequest");for(e in c)f.setRequestHeader(e,
c[e]);b=function(a){return function(){b&&(delete Ta[g],b=f.onload=f.onerror=null,"abort"===a?f.abort():"error"===a?d(f.status,f.statusText):d(Wb[f.status]||f.status,f.statusText,"string"===typeof f.responseText?{text:f.responseText}:void 0,f.getAllResponseHeaders()))}};f.onload=b();f.onerror=b("error");b=Ta[g]=b("abort");try{f.send(a.hasContent&&a.data||null)}catch(h){if(b)throw h;}},abort:function(){b&&b()}}});h.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},
contents:{script:/(?:java|ecma)script/},converters:{"text script":function(a){h.globalEval(a);return a}}});h.ajaxPrefilter("script",function(a){void 0===a.cache&&(a.cache=!1);a.crossDomain&&(a.type="GET")});h.ajaxTransport("script",function(a){if(a.crossDomain){var b,c;return{send:function(d,e){b=h("<script>").prop({async:!0,charset:a.scriptCharset,src:a.url}).on("load error",c=function(a){b.remove();c=null;a&&e("error"===a.type?404:200,a.type)});K.head.appendChild(b[0])},abort:function(){c&&c()}}}});
var wb=[],fb=/(=)\?(?=&|$)|\?\?/;h.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var a=wb.pop()||h.expando+"_"+cb++;this[a]=!0;return a}});h.ajaxPrefilter("json jsonp",function(a,b,c){var d,f,g,k=!1!==a.jsonp&&(fb.test(a.url)?"url":"string"===typeof a.data&&!(a.contentType||"").indexOf("application/x-www-form-urlencoded")&&fb.test(a.data)&&"data");if(k||"jsonp"===a.dataTypes[0])return d=a.jsonpCallback=h.isFunction(a.jsonpCallback)?a.jsonpCallback():a.jsonpCallback,k?a[k]=a[k].replace(fb,"$1"+
d):!1!==a.jsonp&&(a.url+=(db.test(a.url)?"&":"?")+a.jsonp+"="+d),a.converters["script json"]=function(){g||h.error(d+" was not called");return g[0]},a.dataTypes[0]="json",f=e[d],e[d]=function(){g=arguments},c.always(function(){e[d]=f;a[d]&&(a.jsonpCallback=b.jsonpCallback,wb.push(d));g&&h.isFunction(f)&&f(g[0]);g=f=void 0}),"script"});h.parseHTML=function(a,b,c){if(!a||"string"!==typeof a)return null;"boolean"===typeof b&&(c=b,b=!1);b=b||K;var d=Aa.exec(a);c=!c&&[];if(d)return[b.createElement(d[1])];
d=h.buildFragment([a],b,c);c&&c.length&&h(c).remove();return h.merge([],d.childNodes)};var xb=h.fn.load;h.fn.load=function(a,b,c){if("string"!==typeof a&&xb)return xb.apply(this,arguments);var d,e,f,g=this,k=a.indexOf(" ");0<=k&&(d=h.trim(a.slice(k)),a=a.slice(0,k));h.isFunction(b)?(c=b,b=void 0):b&&"object"===typeof b&&(e="POST");0<g.length&&h.ajax({url:a,type:e,dataType:"html",data:b}).done(function(a){f=arguments;g.html(d?h("<div>").append(h.parseHTML(a)).find(d):a)}).complete(c&&function(a,b){g.each(c,
f||[a.responseText,b,a])});return this};h.each("ajaxStart ajaxStop ajaxComplete ajaxError ajaxSuccess ajaxSend".split(" "),function(a,b){h.fn[b]=function(a){return this.on(b,a)}});h.expr.filters.animated=function(a){return h.grep(h.timers,function(b){return a===b.elem}).length};var yb=e.document.documentElement;h.offset={setOffset:function(a,b,c){var d,e,f,g=h.css(a,"position"),k=h(a),l={};"static"===g&&(a.style.position="relative");f=k.offset();e=h.css(a,"top");d=h.css(a,"left");("absolute"===g||
"fixed"===g)&&-1<(e+d).indexOf("auto")?(d=k.position(),e=d.top,d=d.left):(e=parseFloat(e)||0,d=parseFloat(d)||0);h.isFunction(b)&&(b=b.call(a,c,f));null!=b.top&&(l.top=b.top-f.top+e);null!=b.left&&(l.left=b.left-f.left+d);"using"in b?b.using.call(a,l):k.css(l)}};h.fn.extend({offset:function(a){if(arguments.length)return void 0===a?this:this.each(function(b){h.offset.setOffset(this,a,b)});var b,c;c=this[0];var d={top:0,left:0},e=c&&c.ownerDocument;if(e){b=e.documentElement;if(!h.contains(b,c))return d;
"undefined"!==typeof c.getBoundingClientRect&&(d=c.getBoundingClientRect());c=Q(e);return{top:d.top+c.pageYOffset-b.clientTop,left:d.left+c.pageXOffset-b.clientLeft}}},position:function(){if(this[0]){var a,b,c=this[0],d={top:0,left:0};"fixed"===h.css(c,"position")?b=c.getBoundingClientRect():(a=this.offsetParent(),b=this.offset(),h.nodeName(a[0],"html")||(d=a.offset()),d.top+=h.css(a[0],"borderTopWidth",!0),d.left+=h.css(a[0],"borderLeftWidth",!0));return{top:b.top-d.top-h.css(c,"marginTop",!0),left:b.left-
d.left-h.css(c,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var a=this.offsetParent||yb;a&&!h.nodeName(a,"html")&&"static"===h.css(a,"position");)a=a.offsetParent;return a||yb})}});h.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(a,b){var c="pageYOffset"===b;h.fn[a]=function(d){return la(this,function(a,d,f){var g=Q(a);if(void 0===f)return g?g[b]:a[d];g?g.scrollTo(c?e.pageXOffset:f,c?f:e.pageYOffset):a[d]=f},a,d,arguments.length,null)}});h.each(["top",
"left"],function(a,b){h.cssHooks[b]=w(L.pixelPosition,function(a,c){if(c)return c=v(a,b),$a.test(c)?h(a).position()[b]+"px":c})});h.each({Height:"height",Width:"width"},function(a,b){h.each({padding:"inner"+a,content:b,"":"outer"+a},function(c,d){h.fn[d]=function(d,e){var f=arguments.length&&(c||"boolean"!==typeof d),g=c||(!0===d||!0===e?"margin":"border");return la(this,function(b,c,d){return h.isWindow(b)?b.document.documentElement["client"+a]:9===b.nodeType?(c=b.documentElement,Math.max(b.body["scroll"+
a],c["scroll"+a],b.body["offset"+a],c["offset"+a],c["client"+a])):void 0===d?h.css(b,c,g):h.style(b,c,d,g)},b,f?d:void 0,f,null)}})});h.fn.size=function(){return this.length};h.fn.andSelf=h.fn.addBack;"function"===typeof define&&define.amd&&define("jquery",[],function(){return h});var Xb=e.jQuery,Yb=e.$;h.noConflict=function(a){e.$===h&&(e.$=Yb);a&&e.jQuery===h&&(e.jQuery=Xb);return h};"undefined"===typeof b&&(e.jQuery=e.$=h);return h});
(function(){var e=window.WebSocket||window.MozWebSocket,b=window.brunch=window.brunch||{},b=b["auto-reload"]=b["auto-reload"]||{};e&&!b.disabled&&(e=navigator.userAgent.toLowerCase(),b.forceRepaint||e.indexOf("chrome"))})();
